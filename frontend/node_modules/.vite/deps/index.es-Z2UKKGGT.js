import {
  $u,
  Br,
  C2 as C,
  E,
  Er,
  Gt,
  Io,
  JsonRpcProvider,
  Li,
  No,
  Pe,
  Qr,
  Qu,
  So,
  V,
  Vt,
  Vu,
  Wu,
  Xo,
  Xu,
  Yr,
  Zi,
  Zu,
  a0,
  b,
  bu,
  cu,
  d0,
  dn,
  du,
  eh,
  esm_exports,
  fh,
  formatJsonRpcError,
  formatJsonRpcRequest,
  formatJsonRpcResult,
  fu,
  g0,
  ge,
  getBigIntRpcId,
  ih,
  import_pino,
  isHttpUrl,
  isJsonRpcError,
  isJsonRpcRequest,
  isJsonRpcResponse,
  isJsonRpcResult,
  ju,
  k,
  k2,
  l0,
  lh,
  lr,
  lt,
  lu,
  m0,
  nh,
  oh,
  ou,
  p0,
  parseConnectionError,
  payloadId,
  pr,
  pu,
  require_cjs,
  rh,
  safeJsonParse,
  safeJsonStringify,
  th,
  tr,
  uh,
  v,
  v0,
  vo,
  w,
  xe,
  y,
  yu,
  zf,
  zo
} from "./chunk-NY2HE5IQ.js";
import "./chunk-PVOWFSIG.js";
import {
  require_events
} from "./chunk-XAZ6AATU.js";
import "./chunk-44IMT2VJ.js";
import {
  __commonJS,
  __toESM
} from "./chunk-MVEJMUOB.js";

// node_modules/cross-fetch/dist/browser-ponyfill.js
var require_browser_ponyfill = __commonJS({
  "node_modules/cross-fetch/dist/browser-ponyfill.js"(exports, module) {
    var __global__ = typeof globalThis !== "undefined" && globalThis || typeof self !== "undefined" && self || typeof global !== "undefined" && global;
    var __globalThis__ = function() {
      function F2() {
        this.fetch = false;
        this.DOMException = __global__.DOMException;
      }
      F2.prototype = __global__;
      return new F2();
    }();
    (function(globalThis2) {
      var irrelevant = function(exports2) {
        var g3 = typeof globalThis2 !== "undefined" && globalThis2 || typeof self !== "undefined" && self || // eslint-disable-next-line no-undef
        typeof global !== "undefined" && global || {};
        var support = {
          searchParams: "URLSearchParams" in g3,
          iterable: "Symbol" in g3 && "iterator" in Symbol,
          blob: "FileReader" in g3 && "Blob" in g3 && function() {
            try {
              new Blob();
              return true;
            } catch (e) {
              return false;
            }
          }(),
          formData: "FormData" in g3,
          arrayBuffer: "ArrayBuffer" in g3
        };
        function isDataView(obj) {
          return obj && DataView.prototype.isPrototypeOf(obj);
        }
        if (support.arrayBuffer) {
          var viewClasses = [
            "[object Int8Array]",
            "[object Uint8Array]",
            "[object Uint8ClampedArray]",
            "[object Int16Array]",
            "[object Uint16Array]",
            "[object Int32Array]",
            "[object Uint32Array]",
            "[object Float32Array]",
            "[object Float64Array]"
          ];
          var isArrayBufferView = ArrayBuffer.isView || function(obj) {
            return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1;
          };
        }
        function normalizeName(name) {
          if (typeof name !== "string") {
            name = String(name);
          }
          if (/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(name) || name === "") {
            throw new TypeError('Invalid character in header field name: "' + name + '"');
          }
          return name.toLowerCase();
        }
        function normalizeValue(value) {
          if (typeof value !== "string") {
            value = String(value);
          }
          return value;
        }
        function iteratorFor(items) {
          var iterator = {
            next: function() {
              var value = items.shift();
              return { done: value === void 0, value };
            }
          };
          if (support.iterable) {
            iterator[Symbol.iterator] = function() {
              return iterator;
            };
          }
          return iterator;
        }
        function Headers(headers) {
          this.map = {};
          if (headers instanceof Headers) {
            headers.forEach(function(value, name) {
              this.append(name, value);
            }, this);
          } else if (Array.isArray(headers)) {
            headers.forEach(function(header) {
              if (header.length != 2) {
                throw new TypeError("Headers constructor: expected name/value pair to be length 2, found" + header.length);
              }
              this.append(header[0], header[1]);
            }, this);
          } else if (headers) {
            Object.getOwnPropertyNames(headers).forEach(function(name) {
              this.append(name, headers[name]);
            }, this);
          }
        }
        Headers.prototype.append = function(name, value) {
          name = normalizeName(name);
          value = normalizeValue(value);
          var oldValue = this.map[name];
          this.map[name] = oldValue ? oldValue + ", " + value : value;
        };
        Headers.prototype["delete"] = function(name) {
          delete this.map[normalizeName(name)];
        };
        Headers.prototype.get = function(name) {
          name = normalizeName(name);
          return this.has(name) ? this.map[name] : null;
        };
        Headers.prototype.has = function(name) {
          return this.map.hasOwnProperty(normalizeName(name));
        };
        Headers.prototype.set = function(name, value) {
          this.map[normalizeName(name)] = normalizeValue(value);
        };
        Headers.prototype.forEach = function(callback, thisArg) {
          for (var name in this.map) {
            if (this.map.hasOwnProperty(name)) {
              callback.call(thisArg, this.map[name], name, this);
            }
          }
        };
        Headers.prototype.keys = function() {
          var items = [];
          this.forEach(function(value, name) {
            items.push(name);
          });
          return iteratorFor(items);
        };
        Headers.prototype.values = function() {
          var items = [];
          this.forEach(function(value) {
            items.push(value);
          });
          return iteratorFor(items);
        };
        Headers.prototype.entries = function() {
          var items = [];
          this.forEach(function(value, name) {
            items.push([name, value]);
          });
          return iteratorFor(items);
        };
        if (support.iterable) {
          Headers.prototype[Symbol.iterator] = Headers.prototype.entries;
        }
        function consumed(body) {
          if (body._noBody) return;
          if (body.bodyUsed) {
            return Promise.reject(new TypeError("Already read"));
          }
          body.bodyUsed = true;
        }
        function fileReaderReady(reader) {
          return new Promise(function(resolve, reject) {
            reader.onload = function() {
              resolve(reader.result);
            };
            reader.onerror = function() {
              reject(reader.error);
            };
          });
        }
        function readBlobAsArrayBuffer(blob) {
          var reader = new FileReader();
          var promise = fileReaderReady(reader);
          reader.readAsArrayBuffer(blob);
          return promise;
        }
        function readBlobAsText(blob) {
          var reader = new FileReader();
          var promise = fileReaderReady(reader);
          var match = /charset=([A-Za-z0-9_-]+)/.exec(blob.type);
          var encoding = match ? match[1] : "utf-8";
          reader.readAsText(blob, encoding);
          return promise;
        }
        function readArrayBufferAsText(buf) {
          var view = new Uint8Array(buf);
          var chars = new Array(view.length);
          for (var i = 0; i < view.length; i++) {
            chars[i] = String.fromCharCode(view[i]);
          }
          return chars.join("");
        }
        function bufferClone(buf) {
          if (buf.slice) {
            return buf.slice(0);
          } else {
            var view = new Uint8Array(buf.byteLength);
            view.set(new Uint8Array(buf));
            return view.buffer;
          }
        }
        function Body() {
          this.bodyUsed = false;
          this._initBody = function(body) {
            this.bodyUsed = this.bodyUsed;
            this._bodyInit = body;
            if (!body) {
              this._noBody = true;
              this._bodyText = "";
            } else if (typeof body === "string") {
              this._bodyText = body;
            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
              this._bodyBlob = body;
            } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
              this._bodyFormData = body;
            } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
              this._bodyText = body.toString();
            } else if (support.arrayBuffer && support.blob && isDataView(body)) {
              this._bodyArrayBuffer = bufferClone(body.buffer);
              this._bodyInit = new Blob([this._bodyArrayBuffer]);
            } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {
              this._bodyArrayBuffer = bufferClone(body);
            } else {
              this._bodyText = body = Object.prototype.toString.call(body);
            }
            if (!this.headers.get("content-type")) {
              if (typeof body === "string") {
                this.headers.set("content-type", "text/plain;charset=UTF-8");
              } else if (this._bodyBlob && this._bodyBlob.type) {
                this.headers.set("content-type", this._bodyBlob.type);
              } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {
                this.headers.set("content-type", "application/x-www-form-urlencoded;charset=UTF-8");
              }
            }
          };
          if (support.blob) {
            this.blob = function() {
              var rejected = consumed(this);
              if (rejected) {
                return rejected;
              }
              if (this._bodyBlob) {
                return Promise.resolve(this._bodyBlob);
              } else if (this._bodyArrayBuffer) {
                return Promise.resolve(new Blob([this._bodyArrayBuffer]));
              } else if (this._bodyFormData) {
                throw new Error("could not read FormData body as blob");
              } else {
                return Promise.resolve(new Blob([this._bodyText]));
              }
            };
          }
          this.arrayBuffer = function() {
            if (this._bodyArrayBuffer) {
              var isConsumed = consumed(this);
              if (isConsumed) {
                return isConsumed;
              } else if (ArrayBuffer.isView(this._bodyArrayBuffer)) {
                return Promise.resolve(
                  this._bodyArrayBuffer.buffer.slice(
                    this._bodyArrayBuffer.byteOffset,
                    this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength
                  )
                );
              } else {
                return Promise.resolve(this._bodyArrayBuffer);
              }
            } else if (support.blob) {
              return this.blob().then(readBlobAsArrayBuffer);
            } else {
              throw new Error("could not read as ArrayBuffer");
            }
          };
          this.text = function() {
            var rejected = consumed(this);
            if (rejected) {
              return rejected;
            }
            if (this._bodyBlob) {
              return readBlobAsText(this._bodyBlob);
            } else if (this._bodyArrayBuffer) {
              return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));
            } else if (this._bodyFormData) {
              throw new Error("could not read FormData body as text");
            } else {
              return Promise.resolve(this._bodyText);
            }
          };
          if (support.formData) {
            this.formData = function() {
              return this.text().then(decode);
            };
          }
          this.json = function() {
            return this.text().then(JSON.parse);
          };
          return this;
        }
        var methods = ["CONNECT", "DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT", "TRACE"];
        function normalizeMethod(method) {
          var upcased = method.toUpperCase();
          return methods.indexOf(upcased) > -1 ? upcased : method;
        }
        function Request(input, options) {
          if (!(this instanceof Request)) {
            throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
          }
          options = options || {};
          var body = options.body;
          if (input instanceof Request) {
            if (input.bodyUsed) {
              throw new TypeError("Already read");
            }
            this.url = input.url;
            this.credentials = input.credentials;
            if (!options.headers) {
              this.headers = new Headers(input.headers);
            }
            this.method = input.method;
            this.mode = input.mode;
            this.signal = input.signal;
            if (!body && input._bodyInit != null) {
              body = input._bodyInit;
              input.bodyUsed = true;
            }
          } else {
            this.url = String(input);
          }
          this.credentials = options.credentials || this.credentials || "same-origin";
          if (options.headers || !this.headers) {
            this.headers = new Headers(options.headers);
          }
          this.method = normalizeMethod(options.method || this.method || "GET");
          this.mode = options.mode || this.mode || null;
          this.signal = options.signal || this.signal || function() {
            if ("AbortController" in g3) {
              var ctrl = new AbortController();
              return ctrl.signal;
            }
          }();
          this.referrer = null;
          if ((this.method === "GET" || this.method === "HEAD") && body) {
            throw new TypeError("Body not allowed for GET or HEAD requests");
          }
          this._initBody(body);
          if (this.method === "GET" || this.method === "HEAD") {
            if (options.cache === "no-store" || options.cache === "no-cache") {
              var reParamSearch = /([?&])_=[^&]*/;
              if (reParamSearch.test(this.url)) {
                this.url = this.url.replace(reParamSearch, "$1_=" + (/* @__PURE__ */ new Date()).getTime());
              } else {
                var reQueryString = /\?/;
                this.url += (reQueryString.test(this.url) ? "&" : "?") + "_=" + (/* @__PURE__ */ new Date()).getTime();
              }
            }
          }
        }
        Request.prototype.clone = function() {
          return new Request(this, { body: this._bodyInit });
        };
        function decode(body) {
          var form = new FormData();
          body.trim().split("&").forEach(function(bytes) {
            if (bytes) {
              var split = bytes.split("=");
              var name = split.shift().replace(/\+/g, " ");
              var value = split.join("=").replace(/\+/g, " ");
              form.append(decodeURIComponent(name), decodeURIComponent(value));
            }
          });
          return form;
        }
        function parseHeaders(rawHeaders) {
          var headers = new Headers();
          var preProcessedHeaders = rawHeaders.replace(/\r?\n[\t ]+/g, " ");
          preProcessedHeaders.split("\r").map(function(header) {
            return header.indexOf("\n") === 0 ? header.substr(1, header.length) : header;
          }).forEach(function(line) {
            var parts = line.split(":");
            var key = parts.shift().trim();
            if (key) {
              var value = parts.join(":").trim();
              try {
                headers.append(key, value);
              } catch (error) {
                console.warn("Response " + error.message);
              }
            }
          });
          return headers;
        }
        Body.call(Request.prototype);
        function Response(bodyInit, options) {
          if (!(this instanceof Response)) {
            throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');
          }
          if (!options) {
            options = {};
          }
          this.type = "default";
          this.status = options.status === void 0 ? 200 : options.status;
          if (this.status < 200 || this.status > 599) {
            throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");
          }
          this.ok = this.status >= 200 && this.status < 300;
          this.statusText = options.statusText === void 0 ? "" : "" + options.statusText;
          this.headers = new Headers(options.headers);
          this.url = options.url || "";
          this._initBody(bodyInit);
        }
        Body.call(Response.prototype);
        Response.prototype.clone = function() {
          return new Response(this._bodyInit, {
            status: this.status,
            statusText: this.statusText,
            headers: new Headers(this.headers),
            url: this.url
          });
        };
        Response.error = function() {
          var response = new Response(null, { status: 200, statusText: "" });
          response.ok = false;
          response.status = 0;
          response.type = "error";
          return response;
        };
        var redirectStatuses = [301, 302, 303, 307, 308];
        Response.redirect = function(url, status) {
          if (redirectStatuses.indexOf(status) === -1) {
            throw new RangeError("Invalid status code");
          }
          return new Response(null, { status, headers: { location: url } });
        };
        exports2.DOMException = g3.DOMException;
        try {
          new exports2.DOMException();
        } catch (err) {
          exports2.DOMException = function(message, name) {
            this.message = message;
            this.name = name;
            var error = Error(message);
            this.stack = error.stack;
          };
          exports2.DOMException.prototype = Object.create(Error.prototype);
          exports2.DOMException.prototype.constructor = exports2.DOMException;
        }
        function fetch(input, init) {
          return new Promise(function(resolve, reject) {
            var request = new Request(input, init);
            if (request.signal && request.signal.aborted) {
              return reject(new exports2.DOMException("Aborted", "AbortError"));
            }
            var xhr = new XMLHttpRequest();
            function abortXhr() {
              xhr.abort();
            }
            xhr.onload = function() {
              var options = {
                statusText: xhr.statusText,
                headers: parseHeaders(xhr.getAllResponseHeaders() || "")
              };
              if (request.url.indexOf("file://") === 0 && (xhr.status < 200 || xhr.status > 599)) {
                options.status = 200;
              } else {
                options.status = xhr.status;
              }
              options.url = "responseURL" in xhr ? xhr.responseURL : options.headers.get("X-Request-URL");
              var body = "response" in xhr ? xhr.response : xhr.responseText;
              setTimeout(function() {
                resolve(new Response(body, options));
              }, 0);
            };
            xhr.onerror = function() {
              setTimeout(function() {
                reject(new TypeError("Network request failed"));
              }, 0);
            };
            xhr.ontimeout = function() {
              setTimeout(function() {
                reject(new TypeError("Network request timed out"));
              }, 0);
            };
            xhr.onabort = function() {
              setTimeout(function() {
                reject(new exports2.DOMException("Aborted", "AbortError"));
              }, 0);
            };
            function fixUrl(url) {
              try {
                return url === "" && g3.location.href ? g3.location.href : url;
              } catch (e) {
                return url;
              }
            }
            xhr.open(request.method, fixUrl(request.url), true);
            if (request.credentials === "include") {
              xhr.withCredentials = true;
            } else if (request.credentials === "omit") {
              xhr.withCredentials = false;
            }
            if ("responseType" in xhr) {
              if (support.blob) {
                xhr.responseType = "blob";
              } else if (support.arrayBuffer) {
                xhr.responseType = "arraybuffer";
              }
            }
            if (init && typeof init.headers === "object" && !(init.headers instanceof Headers || g3.Headers && init.headers instanceof g3.Headers)) {
              var names = [];
              Object.getOwnPropertyNames(init.headers).forEach(function(name) {
                names.push(normalizeName(name));
                xhr.setRequestHeader(name, normalizeValue(init.headers[name]));
              });
              request.headers.forEach(function(value, name) {
                if (names.indexOf(name) === -1) {
                  xhr.setRequestHeader(name, value);
                }
              });
            } else {
              request.headers.forEach(function(value, name) {
                xhr.setRequestHeader(name, value);
              });
            }
            if (request.signal) {
              request.signal.addEventListener("abort", abortXhr);
              xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                  request.signal.removeEventListener("abort", abortXhr);
                }
              };
            }
            xhr.send(typeof request._bodyInit === "undefined" ? null : request._bodyInit);
          });
        }
        fetch.polyfill = true;
        if (!g3.fetch) {
          g3.fetch = fetch;
          g3.Headers = Headers;
          g3.Request = Request;
          g3.Response = Response;
        }
        exports2.Headers = Headers;
        exports2.Request = Request;
        exports2.Response = Response;
        exports2.fetch = fetch;
        Object.defineProperty(exports2, "__esModule", { value: true });
        return exports2;
      }({});
    })(__globalThis__);
    __globalThis__.fetch.ponyfill = true;
    delete __globalThis__.fetch.polyfill;
    var ctx = __global__.fetch ? __global__ : __globalThis__;
    exports = ctx.fetch;
    exports.default = ctx.fetch;
    exports.fetch = ctx.fetch;
    exports.Headers = ctx.Headers;
    exports.Request = ctx.Request;
    exports.Response = ctx.Response;
    module.exports = exports;
  }
});

// node_modules/@thirdweb-dev/wallets/node_modules/@walletconnect/ethereum-provider/dist/index.es.js
var import_events4 = __toESM(require_events());

// node_modules/@thirdweb-dev/wallets/node_modules/@walletconnect/sign-client/dist/index.es.js
var import_events = __toESM(require_events());
var import_time = __toESM(require_cjs());
var Se = "wc";
var Ee = 2;
var _e = "client";
var se = `${Se}@${Ee}:${_e}:`;
var ie = { name: _e, logger: "error", controller: false, relayUrl: "wss://relay.walletconnect.com" };
var Re = "WALLETCONNECT_DEEPLINK_CHOICE";
var Ke = "proposal";
var Ue = "Proposal expired";
var Ge = "session";
var L = import_time.SEVEN_DAYS;
var ke = "engine";
var q = { wc_sessionPropose: { req: { ttl: import_time.FIVE_MINUTES, prompt: true, tag: 1100 }, res: { ttl: import_time.FIVE_MINUTES, prompt: false, tag: 1101 } }, wc_sessionSettle: { req: { ttl: import_time.FIVE_MINUTES, prompt: false, tag: 1102 }, res: { ttl: import_time.FIVE_MINUTES, prompt: false, tag: 1103 } }, wc_sessionUpdate: { req: { ttl: import_time.ONE_DAY, prompt: false, tag: 1104 }, res: { ttl: import_time.ONE_DAY, prompt: false, tag: 1105 } }, wc_sessionExtend: { req: { ttl: import_time.ONE_DAY, prompt: false, tag: 1106 }, res: { ttl: import_time.ONE_DAY, prompt: false, tag: 1107 } }, wc_sessionRequest: { req: { ttl: import_time.FIVE_MINUTES, prompt: true, tag: 1108 }, res: { ttl: import_time.FIVE_MINUTES, prompt: false, tag: 1109 } }, wc_sessionEvent: { req: { ttl: import_time.FIVE_MINUTES, prompt: true, tag: 1110 }, res: { ttl: import_time.FIVE_MINUTES, prompt: false, tag: 1111 } }, wc_sessionDelete: { req: { ttl: import_time.ONE_DAY, prompt: false, tag: 1112 }, res: { ttl: import_time.ONE_DAY, prompt: false, tag: 1113 } }, wc_sessionPing: { req: { ttl: import_time.ONE_DAY, prompt: false, tag: 1114 }, res: { ttl: import_time.ONE_DAY, prompt: false, tag: 1115 } }, wc_sessionAuthenticate: { req: { ttl: import_time.ONE_HOUR, prompt: true, tag: 1116 }, res: { ttl: import_time.ONE_HOUR, prompt: false, tag: 1117 } } };
var re = { min: import_time.FIVE_MINUTES, max: import_time.SEVEN_DAYS };
var A = { idle: "IDLE", active: "ACTIVE" };
var Fe = "request";
var je = ["wc_sessionPropose", "wc_sessionRequest", "wc_authRequest"];
var Qe = "wc";
var ze = "auth";
var He = "authKeys";
var Ye = "pairingTopics";
var Xe = "requests";
var X = `${Qe}@${1.5}:${ze}:`;
var J = `${X}:PUB_KEY`;
var Ht = Object.defineProperty;
var Yt = Object.defineProperties;
var Xt = Object.getOwnPropertyDescriptors;
var Je = Object.getOwnPropertySymbols;
var Jt = Object.prototype.hasOwnProperty;
var Bt = Object.prototype.propertyIsEnumerable;
var Be = (S2, n, t) => n in S2 ? Ht(S2, n, { enumerable: true, configurable: true, writable: true, value: t }) : S2[n] = t;
var m = (S2, n) => {
  for (var t in n || (n = {})) Jt.call(n, t) && Be(S2, t, n[t]);
  if (Je) for (var t of Je(n)) Bt.call(n, t) && Be(S2, t, n[t]);
  return S2;
};
var F = (S2, n) => Yt(S2, Xt(n));
var Wt = class extends w {
  constructor(n) {
    super(n), this.name = ke, this.events = new import_events.default(), this.initialized = false, this.requestQueue = { state: A.idle, queue: [] }, this.sessionRequestQueue = { state: A.idle, queue: [] }, this.requestQueueDelay = import_time.ONE_SECOND, this.expectedPairingMethodMap = /* @__PURE__ */ new Map(), this.recentlyDeletedMap = /* @__PURE__ */ new Map(), this.recentlyDeletedLimit = 200, this.init = async () => {
      this.initialized || (await this.cleanup(), this.registerRelayerEvents(), this.registerExpirerEvents(), this.registerPairingEvents(), this.client.core.pairing.register({ methods: Object.keys(q) }), this.initialized = true, setTimeout(() => {
        this.sessionRequestQueue.queue = this.getPendingSessionRequests(), this.processSessionRequestQueue();
      }, (0, import_time.toMiliseconds)(this.requestQueueDelay)));
    }, this.connect = async (t) => {
      await this.isInitialized();
      const e = F(m({}, t), { requiredNamespaces: t.requiredNamespaces || {}, optionalNamespaces: t.optionalNamespaces || {} });
      await this.isValidConnect(e);
      const { pairingTopic: s, requiredNamespaces: i, optionalNamespaces: r, sessionProperties: o2, relays: a } = e;
      let c2 = s, d2, p3 = false;
      try {
        c2 && (p3 = this.client.core.pairing.pairings.get(c2).active);
      } catch (f2) {
        throw this.client.logger.error(`connect() -> pairing.get(${c2}) failed`), f2;
      }
      if (!c2 || !p3) {
        const { topic: f2, uri: v4 } = await this.client.core.pairing.create();
        c2 = f2, d2 = v4;
      }
      if (!c2) {
        const { message: f2 } = xe("NO_MATCHING_KEY", `connect() pairing topic: ${c2}`);
        throw new Error(f2);
      }
      const g3 = await this.client.core.crypto.generateKeyPair(), h = q.wc_sessionPropose.req.ttl || import_time.FIVE_MINUTES, y2 = d0(h), w3 = m({ requiredNamespaces: i, optionalNamespaces: r, relays: a ?? [{ protocol: lt }], proposer: { publicKey: g3, metadata: this.client.metadata }, expiryTimestamp: y2 }, o2 && { sessionProperties: o2 }), { reject: I, resolve: D2, done: E4 } = a0(h, Ue);
      this.events.once(v0("session_connect"), async ({ error: f2, session: v4 }) => {
        if (f2) I(f2);
        else if (v4) {
          v4.self.publicKey = g3;
          const j3 = F(m({}, v4), { requiredNamespaces: w3.requiredNamespaces, optionalNamespaces: w3.optionalNamespaces });
          await this.client.session.set(v4.topic, j3), await this.setExpiry(v4.topic, v4.expiry), c2 && await this.client.core.pairing.updateMetadata({ topic: c2, metadata: v4.peer.metadata }), D2(j3);
        }
      });
      const P2 = await this.sendRequest({ topic: c2, method: "wc_sessionPropose", params: w3, throwOnFailedPublish: true });
      return await this.setProposal(P2, m({ id: P2 }, w3)), { uri: d2, approval: E4 };
    }, this.pair = async (t) => {
      await this.isInitialized();
      try {
        return await this.client.core.pairing.pair(t);
      } catch (e) {
        throw this.client.logger.error("pair() failed"), e;
      }
    }, this.approve = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidApprove(t);
      } catch (E4) {
        throw this.client.logger.error("approve() -> isValidApprove() failed"), E4;
      }
      const { id: e, relayProtocol: s, namespaces: i, sessionProperties: r, sessionConfig: o2 } = t;
      let a;
      try {
        a = this.client.proposal.get(e);
      } catch (E4) {
        throw this.client.logger.error(`approve() -> proposal.get(${e}) failed`), E4;
      }
      let { pairingTopic: c2, proposer: d2, requiredNamespaces: p3, optionalNamespaces: g3 } = a;
      c2 = c2 || "";
      const h = await this.client.core.crypto.generateKeyPair(), y2 = d2.publicKey, w3 = await this.client.core.crypto.generateSharedKey(h, y2), I = m(m({ relay: { protocol: s ?? "irn" }, namespaces: i, pairingTopic: c2, controller: { publicKey: h, metadata: this.client.metadata }, expiry: d0(L) }, r && { sessionProperties: r }), o2 && { sessionConfig: o2 });
      await this.client.core.relayer.subscribe(w3);
      const D2 = F(m({}, I), { topic: w3, requiredNamespaces: p3, optionalNamespaces: g3, pairingTopic: c2, acknowledged: false, self: I.controller, peer: { publicKey: d2.publicKey, metadata: d2.metadata }, controller: h });
      await this.client.session.set(w3, D2);
      try {
        await this.sendResult({ id: e, topic: c2, result: { relay: { protocol: s ?? "irn" }, responderPublicKey: h }, throwOnFailedPublish: true }), await this.sendRequest({ topic: w3, method: "wc_sessionSettle", params: I, throwOnFailedPublish: true });
      } catch (E4) {
        throw this.client.logger.error(E4), this.client.session.delete(w3, tr("USER_DISCONNECTED")), await this.client.core.relayer.unsubscribe(w3), E4;
      }
      return await this.client.core.pairing.updateMetadata({ topic: c2, metadata: d2.metadata }), await this.client.proposal.delete(e, tr("USER_DISCONNECTED")), await this.client.core.pairing.activate({ topic: c2 }), await this.setExpiry(w3, d0(L)), { topic: w3, acknowledged: () => new Promise((E4) => setTimeout(() => E4(this.client.session.get(w3)), 500)) };
    }, this.reject = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidReject(t);
      } catch (r) {
        throw this.client.logger.error("reject() -> isValidReject() failed"), r;
      }
      const { id: e, reason: s } = t;
      let i;
      try {
        i = this.client.proposal.get(e).pairingTopic;
      } catch (r) {
        throw this.client.logger.error(`reject() -> proposal.get(${e}) failed`), r;
      }
      i && (await this.sendError({ id: e, topic: i, error: s }), await this.client.proposal.delete(e, tr("USER_DISCONNECTED")));
    }, this.update = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidUpdate(t);
      } catch (p3) {
        throw this.client.logger.error("update() -> isValidUpdate() failed"), p3;
      }
      const { topic: e, namespaces: s } = t, { done: i, resolve: r, reject: o2 } = a0(), a = payloadId(), c2 = getBigIntRpcId().toString(), d2 = this.client.session.get(e).namespaces;
      return this.events.once(v0("session_update", a), ({ error: p3 }) => {
        p3 ? o2(p3) : r();
      }), await this.client.session.update(e, { namespaces: s }), this.sendRequest({ topic: e, method: "wc_sessionUpdate", params: { namespaces: s }, throwOnFailedPublish: true, clientRpcId: a, relayRpcId: c2 }).catch((p3) => {
        this.client.logger.error(p3), this.client.session.update(e, { namespaces: d2 }), o2(p3);
      }), { acknowledged: i };
    }, this.extend = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidExtend(t);
      } catch (a) {
        throw this.client.logger.error("extend() -> isValidExtend() failed"), a;
      }
      const { topic: e } = t, s = payloadId(), { done: i, resolve: r, reject: o2 } = a0();
      return this.events.once(v0("session_extend", s), ({ error: a }) => {
        a ? o2(a) : r();
      }), await this.setExpiry(e, d0(L)), this.sendRequest({ topic: e, method: "wc_sessionExtend", params: {}, clientRpcId: s, throwOnFailedPublish: true }).catch((a) => {
        o2(a);
      }), { acknowledged: i };
    }, this.request = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidRequest(t);
      } catch (h) {
        throw this.client.logger.error("request() -> isValidRequest() failed"), h;
      }
      const { chainId: e, request: s, topic: i, expiry: r = q.wc_sessionRequest.req.ttl } = t, o2 = this.client.session.get(i), a = payloadId(), c2 = getBigIntRpcId().toString(), { done: d2, resolve: p3, reject: g3 } = a0(r, "Request expired. Please try again.");
      return this.events.once(v0("session_request", a), ({ error: h, result: y2 }) => {
        h ? g3(h) : p3(y2);
      }), await Promise.all([new Promise(async (h) => {
        await this.sendRequest({ clientRpcId: a, relayRpcId: c2, topic: i, method: "wc_sessionRequest", params: { request: F(m({}, s), { expiryTimestamp: d0(r) }), chainId: e }, expiry: r, throwOnFailedPublish: true }).catch((y2) => g3(y2)), this.client.events.emit("session_request_sent", { topic: i, request: s, chainId: e, id: a }), h();
      }), new Promise(async (h) => {
        var y2;
        if (!((y2 = o2.sessionConfig) != null && y2.disableDeepLink)) {
          const w3 = await g0(this.client.core.storage, Re);
          m0({ id: a, topic: i, wcDeepLink: w3 });
        }
        h();
      }), d2()]).then((h) => h[2]);
    }, this.respond = async (t) => {
      await this.isInitialized(), await this.isValidRespond(t);
      const { topic: e, response: s } = t, { id: i } = s;
      isJsonRpcResult(s) ? await this.sendResult({ id: i, topic: e, result: s.result, throwOnFailedPublish: true }) : isJsonRpcError(s) && await this.sendError({ id: i, topic: e, error: s.error }), this.cleanupAfterResponse(t);
    }, this.ping = async (t) => {
      await this.isInitialized();
      try {
        await this.isValidPing(t);
      } catch (s) {
        throw this.client.logger.error("ping() -> isValidPing() failed"), s;
      }
      const { topic: e } = t;
      if (this.client.session.keys.includes(e)) {
        const s = payloadId(), i = getBigIntRpcId().toString(), { done: r, resolve: o2, reject: a } = a0();
        this.events.once(v0("session_ping", s), ({ error: c2 }) => {
          c2 ? a(c2) : o2();
        }), await Promise.all([this.sendRequest({ topic: e, method: "wc_sessionPing", params: {}, throwOnFailedPublish: true, clientRpcId: s, relayRpcId: i }), r()]);
      } else this.client.core.pairing.pairings.keys.includes(e) && await this.client.core.pairing.ping({ topic: e });
    }, this.emit = async (t) => {
      await this.isInitialized(), await this.isValidEmit(t);
      const { topic: e, event: s, chainId: i } = t, r = getBigIntRpcId().toString();
      await this.sendRequest({ topic: e, method: "wc_sessionEvent", params: { event: s, chainId: i }, throwOnFailedPublish: true, relayRpcId: r });
    }, this.disconnect = async (t) => {
      await this.isInitialized(), await this.isValidDisconnect(t);
      const { topic: e } = t;
      if (this.client.session.keys.includes(e)) await this.sendRequest({ topic: e, method: "wc_sessionDelete", params: tr("USER_DISCONNECTED"), throwOnFailedPublish: true }), await this.deleteSession({ topic: e, emitEvent: false });
      else if (this.client.core.pairing.pairings.keys.includes(e)) await this.client.core.pairing.disconnect({ topic: e });
      else {
        const { message: s } = xe("MISMATCHED_TOPIC", `Session or pairing topic not found: ${e}`);
        throw new Error(s);
      }
    }, this.find = (t) => (this.isInitialized(), this.client.session.getAll().filter((e) => Qu(e, t))), this.getPendingSessionRequests = () => this.client.pendingRequest.getAll(), this.authenticate = async (t) => {
      this.isInitialized(), this.isValidAuthenticate(t);
      const { chains: e, statement: s = "", uri: i, domain: r, nonce: o2, type: a, exp: c2, nbf: d2, methods: p3 = [] } = t, g3 = [...t.resources || []], { topic: h, uri: y2 } = await this.client.core.pairing.create({ methods: ["wc_sessionAuthenticate"] });
      this.client.logger.info({ message: "Generated new pairing", pairing: { topic: h, uri: y2 } });
      const w3 = await this.client.core.crypto.generateKeyPair(), I = bu(w3);
      if (await Promise.all([this.client.auth.authKeys.set(J, { responseTopic: I, publicKey: w3 }), this.client.auth.pairingTopics.set(I, { topic: I, pairingTopic: h })]), await this.client.core.relayer.subscribe(I), this.client.logger.info(`sending request to new pairing topic: ${h}`), p3.length > 0) {
        const { namespace: O3 } = dn(e[0]);
        let _2 = cu(O3, "request", p3);
        Qr(g3) && (_2 = lu(_2, g3.pop())), g3.push(_2);
      }
      const D2 = d0(q.wc_sessionPropose.req.ttl), E4 = { authPayload: { type: a ?? "caip122", chains: e, statement: s, aud: i, domain: r, version: "1", nonce: o2, iat: (/* @__PURE__ */ new Date()).toISOString(), exp: c2, nbf: d2, resources: g3 }, requester: { publicKey: w3, metadata: this.client.metadata }, expiryTimestamp: D2 }, P2 = { eip155: { chains: e, methods: [.../* @__PURE__ */ new Set(["personal_sign", ...p3])], events: ["chainChanged", "accountsChanged"] } }, f2 = { requiredNamespaces: {}, optionalNamespaces: P2, relays: [{ protocol: "irn" }], proposer: { publicKey: w3, metadata: this.client.metadata }, expiryTimestamp: D2 }, { done: v4, resolve: j3, reject: oe } = a0(q.wc_sessionAuthenticate.req.ttl, "Request expired"), B = async ({ error: O3, session: _2 }) => {
        if (this.events.off(v0("session_request", M2), ae), O3) oe(O3);
        else if (_2) {
          _2.self.publicKey = w3, await this.client.session.set(_2.topic, _2), await this.setExpiry(_2.topic, _2.expiry), h && await this.client.core.pairing.updateMetadata({ topic: h, metadata: _2.peer.metadata });
          const Q2 = this.client.session.get(_2.topic);
          j3({ session: Q2 });
        }
      }, ae = async (O3) => {
        if (O3.error) {
          const z3 = tr("WC_METHOD_UNSUPPORTED", "wc_sessionAuthenticate");
          return O3.error.code === z3.code ? void 0 : (this.events.off(v0("session_connect"), B), oe(O3.error.message));
        }
        this.events.off(v0("session_connect"), B);
        const { cacaos: _2, responder: Q2 } = O3.result, le = [], Ie = [];
        for (const z3 of _2) {
          await ou({ cacao: z3, projectId: this.client.core.projectId }) || (this.client.logger.error(z3, "Signature verification failed"), oe(tr("SESSION_SETTLEMENT_FAILED", "Signature verification failed")));
          const { p: he } = z3, pe = Qr(he.resources), fe = [fu(he.iss)], Ze = Li(he.iss);
          if (pe) {
            const de = du(pe), et = pu(pe);
            le.push(...de), fe.push(...et);
          }
          for (const de of fe) Ie.push(`${de}:${Ze}`);
        }
        const W = await this.client.core.crypto.generateSharedKey(w3, Q2.publicKey);
        let Z;
        le.length > 0 && (Z = { topic: W, acknowledged: true, self: { publicKey: w3, metadata: this.client.metadata }, peer: Q2, controller: Q2.publicKey, expiry: d0(L), requiredNamespaces: {}, optionalNamespaces: {}, relay: { protocol: "irn" }, pairingTopic: h, namespaces: ju([...new Set(le)], [...new Set(Ie)]) }, await this.client.core.relayer.subscribe(W), await this.client.session.set(W, Z), Z = this.client.session.get(W)), j3({ auths: _2, session: Z });
      }, M2 = payloadId(), ce = payloadId();
      this.events.once(v0("session_connect"), B), this.events.once(v0("session_request", M2), ae);
      try {
        await Promise.all([this.sendRequest({ topic: h, method: "wc_sessionAuthenticate", params: E4, expiry: t.expiry, throwOnFailedPublish: true, clientRpcId: M2 }), this.sendRequest({ topic: h, method: "wc_sessionPropose", params: f2, expiry: q.wc_sessionPropose.req.ttl, throwOnFailedPublish: true, clientRpcId: ce })]);
      } catch (O3) {
        throw this.events.off(v0("session_connect"), B), this.events.off(v0("session_request", M2), ae), O3;
      }
      return await this.setProposal(ce, m({ id: ce }, f2)), await this.client.auth.requests.set(M2, { authPayload: E4.authPayload, requester: E4.requester, expiryTimestamp: D2, id: M2, pairingTopic: h, verifyContext: {} }), { uri: y2, response: v4 };
    }, this.approveSessionAuthenticate = async (t) => {
      this.isInitialized();
      const { id: e, auths: s } = t, i = this.getPendingAuthRequest(e);
      if (!i) throw new Error(`Could not find pending auth request with id ${e}`);
      const r = i.requester.publicKey, o2 = await this.client.core.crypto.generateKeyPair(), a = bu(r), c2 = { type: lr, receiverPublicKey: r, senderPublicKey: o2 }, d2 = [], p3 = [];
      for (const y2 of s) {
        if (!await ou({ cacao: y2, projectId: this.client.core.projectId })) {
          const P2 = tr("SESSION_SETTLEMENT_FAILED", "Signature verification failed");
          throw await this.sendError({ id: e, topic: a, error: P2, encodeOpts: c2 }), new Error(P2.message);
        }
        const { p: w3 } = y2, I = Qr(w3.resources), D2 = [fu(w3.iss)], E4 = Li(w3.iss);
        if (I) {
          const P2 = du(I), f2 = pu(I);
          d2.push(...P2), D2.push(...f2);
        }
        for (const P2 of D2) p3.push(`${P2}:${E4}`);
      }
      const g3 = await this.client.core.crypto.generateSharedKey(o2, r);
      let h;
      return (d2 == null ? void 0 : d2.length) > 0 && (h = { topic: g3, acknowledged: true, self: { publicKey: o2, metadata: this.client.metadata }, peer: { publicKey: r, metadata: i.requester.metadata }, controller: r, expiry: d0(L), authentication: s, requiredNamespaces: {}, optionalNamespaces: {}, relay: { protocol: "irn" }, pairingTopic: "", namespaces: ju([...new Set(d2)], [...new Set(p3)]) }, await this.client.core.relayer.subscribe(g3), await this.client.session.set(g3, h)), await this.sendResult({ topic: a, id: e, result: { cacaos: s, responder: { publicKey: o2, metadata: this.client.metadata } }, encodeOpts: c2, throwOnFailedPublish: true }), await this.client.auth.requests.delete(e, { message: "fullfilled", code: 0 }), await this.client.core.pairing.activate({ topic: i.pairingTopic }), { session: h };
    }, this.rejectSessionAuthenticate = async (t) => {
      await this.isInitialized();
      const { id: e, reason: s } = t, i = this.getPendingAuthRequest(e);
      if (!i) throw new Error(`Could not find pending auth request with id ${e}`);
      const r = i.requester.publicKey, o2 = await this.client.core.crypto.generateKeyPair(), a = bu(r), c2 = { type: lr, receiverPublicKey: r, senderPublicKey: o2 };
      await this.sendError({ id: e, topic: a, error: s, encodeOpts: c2 }), await this.client.auth.requests.delete(e, { message: "rejected", code: 0 }), await this.client.proposal.delete(e, tr("USER_DISCONNECTED"));
    }, this.formatAuthMessage = (t) => {
      this.isInitialized();
      const { request: e, iss: s } = t;
      return zf(e, s);
    }, this.cleanupDuplicatePairings = async (t) => {
      if (t.pairingTopic) try {
        const e = this.client.core.pairing.pairings.get(t.pairingTopic), s = this.client.core.pairing.pairings.getAll().filter((i) => {
          var r, o2;
          return ((r = i.peerMetadata) == null ? void 0 : r.url) && ((o2 = i.peerMetadata) == null ? void 0 : o2.url) === t.peer.metadata.url && i.topic && i.topic !== e.topic;
        });
        if (s.length === 0) return;
        this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`), await Promise.all(s.map((i) => this.client.core.pairing.disconnect({ topic: i.topic }))), this.client.logger.info("Duplicate pairings clean up finished");
      } catch (e) {
        this.client.logger.error(e);
      }
    }, this.deleteSession = async (t) => {
      const { topic: e, expirerHasDeleted: s = false, emitEvent: i = true, id: r = 0 } = t, { self: o2 } = this.client.session.get(e);
      await this.client.core.relayer.unsubscribe(e), await this.client.session.delete(e, tr("USER_DISCONNECTED")), this.addToRecentlyDeleted(e, "session"), this.client.core.crypto.keychain.has(o2.publicKey) && await this.client.core.crypto.deleteKeyPair(o2.publicKey), this.client.core.crypto.keychain.has(e) && await this.client.core.crypto.deleteSymKey(e), s || this.client.core.expirer.del(e), this.client.core.storage.removeItem(Re).catch((a) => this.client.logger.warn(a)), this.getPendingSessionRequests().forEach((a) => {
        a.topic === e && this.deletePendingSessionRequest(a.id, tr("USER_DISCONNECTED"));
      }), i && this.client.events.emit("session_delete", { id: r, topic: e });
    }, this.deleteProposal = async (t, e) => {
      await Promise.all([this.client.proposal.delete(t, tr("USER_DISCONNECTED")), e ? Promise.resolve() : this.client.core.expirer.del(t)]), this.addToRecentlyDeleted(t, "proposal");
    }, this.deletePendingSessionRequest = async (t, e, s = false) => {
      await Promise.all([this.client.pendingRequest.delete(t, e), s ? Promise.resolve() : this.client.core.expirer.del(t)]), this.addToRecentlyDeleted(t, "request"), this.sessionRequestQueue.queue = this.sessionRequestQueue.queue.filter((i) => i.id !== t), s && (this.sessionRequestQueue.state = A.idle, this.client.events.emit("session_request_expire", { id: t }));
    }, this.setExpiry = async (t, e) => {
      this.client.session.keys.includes(t) && await this.client.session.update(t, { expiry: e }), this.client.core.expirer.set(t, e);
    }, this.setProposal = async (t, e) => {
      await this.client.proposal.set(t, e), this.client.core.expirer.set(t, d0(q.wc_sessionPropose.req.ttl));
    }, this.setPendingSessionRequest = async (t) => {
      const { id: e, topic: s, params: i, verifyContext: r } = t, o2 = i.request.expiryTimestamp || d0(q.wc_sessionRequest.req.ttl);
      await this.client.pendingRequest.set(e, { id: e, topic: s, params: i, verifyContext: r }), o2 && this.client.core.expirer.set(e, o2);
    }, this.sendRequest = async (t) => {
      const { topic: e, method: s, params: i, expiry: r, relayRpcId: o2, clientRpcId: a, throwOnFailedPublish: c2 } = t, d2 = formatJsonRpcRequest(s, i, a);
      if (pr() && je.includes(s)) {
        const h = yu(JSON.stringify(d2));
        this.client.core.verify.register({ attestationId: h });
      }
      let p3;
      try {
        p3 = await this.client.core.crypto.encode(e, d2);
      } catch (h) {
        throw await this.cleanup(), this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${e} failed`), h;
      }
      const g3 = q[s].req;
      return r && (g3.ttl = r), o2 && (g3.id = o2), this.client.core.history.set(e, d2), c2 ? (g3.internal = F(m({}, g3.internal), { throwOnFailedPublish: true }), await this.client.core.relayer.publish(e, p3, g3)) : this.client.core.relayer.publish(e, p3, g3).catch((h) => this.client.logger.error(h)), d2.id;
    }, this.sendResult = async (t) => {
      const { id: e, topic: s, result: i, throwOnFailedPublish: r, encodeOpts: o2 } = t, a = formatJsonRpcResult(e, i);
      let c2;
      try {
        c2 = await this.client.core.crypto.encode(s, a, o2);
      } catch (g3) {
        throw await this.cleanup(), this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`), g3;
      }
      let d2;
      try {
        d2 = await this.client.core.history.get(s, e);
      } catch (g3) {
        throw this.client.logger.error(`sendResult() -> history.get(${s}, ${e}) failed`), g3;
      }
      const p3 = q[d2.request.method].res;
      r ? (p3.internal = F(m({}, p3.internal), { throwOnFailedPublish: true }), await this.client.core.relayer.publish(s, c2, p3)) : this.client.core.relayer.publish(s, c2, p3).catch((g3) => this.client.logger.error(g3)), await this.client.core.history.resolve(a);
    }, this.sendError = async (t) => {
      const { id: e, topic: s, error: i, encodeOpts: r } = t, o2 = formatJsonRpcError(e, i);
      let a;
      try {
        a = await this.client.core.crypto.encode(s, o2, r);
      } catch (p3) {
        throw await this.cleanup(), this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`), p3;
      }
      let c2;
      try {
        c2 = await this.client.core.history.get(s, e);
      } catch (p3) {
        throw this.client.logger.error(`sendError() -> history.get(${s}, ${e}) failed`), p3;
      }
      const d2 = q[c2.request.method].res;
      this.client.core.relayer.publish(s, a, d2), await this.client.core.history.resolve(o2);
    }, this.cleanup = async () => {
      const t = [], e = [];
      this.client.session.getAll().forEach((s) => {
        let i = false;
        p0(s.expiry) && (i = true), this.client.core.crypto.keychain.has(s.topic) || (i = true), i && t.push(s.topic);
      }), this.client.proposal.getAll().forEach((s) => {
        p0(s.expiryTimestamp) && e.push(s.id);
      }), await Promise.all([...t.map((s) => this.deleteSession({ topic: s })), ...e.map((s) => this.deleteProposal(s))]);
    }, this.onRelayEventRequest = async (t) => {
      this.requestQueue.queue.push(t), await this.processRequestsQueue();
    }, this.processRequestsQueue = async () => {
      if (this.requestQueue.state === A.active) {
        this.client.logger.info("Request queue already active, skipping...");
        return;
      }
      for (this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`); this.requestQueue.queue.length > 0; ) {
        this.requestQueue.state = A.active;
        const t = this.requestQueue.queue.shift();
        if (t) try {
          this.processRequest(t), await new Promise((e) => setTimeout(e, 300));
        } catch (e) {
          this.client.logger.warn(e);
        }
      }
      this.requestQueue.state = A.idle;
    }, this.processRequest = (t) => {
      const { topic: e, payload: s } = t, i = s.method;
      if (!this.shouldIgnorePairingRequest({ topic: e, requestMethod: i })) switch (i) {
        case "wc_sessionPropose":
          return this.onSessionProposeRequest(e, s);
        case "wc_sessionSettle":
          return this.onSessionSettleRequest(e, s);
        case "wc_sessionUpdate":
          return this.onSessionUpdateRequest(e, s);
        case "wc_sessionExtend":
          return this.onSessionExtendRequest(e, s);
        case "wc_sessionPing":
          return this.onSessionPingRequest(e, s);
        case "wc_sessionDelete":
          return this.onSessionDeleteRequest(e, s);
        case "wc_sessionRequest":
          return this.onSessionRequest(e, s);
        case "wc_sessionEvent":
          return this.onSessionEventRequest(e, s);
        case "wc_sessionAuthenticate":
          return this.onSessionAuthenticateRequest(e, s);
        default:
          return this.client.logger.info(`Unsupported request method ${i}`);
      }
    }, this.onRelayEventResponse = async (t) => {
      const { topic: e, payload: s } = t, i = (await this.client.core.history.get(e, s.id)).request.method;
      switch (i) {
        case "wc_sessionPropose":
          return this.onSessionProposeResponse(e, s);
        case "wc_sessionSettle":
          return this.onSessionSettleResponse(e, s);
        case "wc_sessionUpdate":
          return this.onSessionUpdateResponse(e, s);
        case "wc_sessionExtend":
          return this.onSessionExtendResponse(e, s);
        case "wc_sessionPing":
          return this.onSessionPingResponse(e, s);
        case "wc_sessionRequest":
          return this.onSessionRequestResponse(e, s);
        case "wc_sessionAuthenticate":
          return this.onSessionAuthenticateResponse(e, s);
        default:
          return this.client.logger.info(`Unsupported response method ${i}`);
      }
    }, this.onRelayEventUnknownPayload = (t) => {
      const { topic: e } = t, { message: s } = xe("MISSING_OR_INVALID", `Decoded payload on topic ${e} is not identifiable as a JSON-RPC request or a response.`);
      throw new Error(s);
    }, this.shouldIgnorePairingRequest = (t) => {
      const { topic: e, requestMethod: s } = t, i = this.expectedPairingMethodMap.get(e);
      return !i || i.includes(s) ? false : !!(i.includes("wc_sessionAuthenticate") && this.client.events.listenerCount("session_authenticate") > 0);
    }, this.onSessionProposeRequest = async (t, e) => {
      const { params: s, id: i } = e;
      try {
        this.isValidConnect(m({}, e.params));
        const r = s.expiryTimestamp || d0(q.wc_sessionPropose.req.ttl), o2 = m({ id: i, pairingTopic: t, expiryTimestamp: r }, s);
        await this.setProposal(i, o2);
        const a = yu(JSON.stringify(e)), c2 = await this.getVerifyContext(a, o2.proposer.metadata);
        this.client.events.emit("session_proposal", { id: i, params: o2, verifyContext: c2 });
      } catch (r) {
        await this.sendError({ id: i, topic: t, error: r }), this.client.logger.error(r);
      }
    }, this.onSessionProposeResponse = async (t, e) => {
      const { id: s } = e;
      if (isJsonRpcResult(e)) {
        const { result: i } = e;
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", result: i });
        const r = this.client.proposal.get(s);
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", proposal: r });
        const o2 = r.proposer.publicKey;
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", selfPublicKey: o2 });
        const a = i.responderPublicKey;
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", peerPublicKey: a });
        const c2 = await this.client.core.crypto.generateSharedKey(o2, a);
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", sessionTopic: c2 });
        const d2 = await this.client.core.relayer.subscribe(c2);
        this.client.logger.trace({ type: "method", method: "onSessionProposeResponse", subscriptionId: d2 }), await this.client.core.pairing.activate({ topic: t });
      } else if (isJsonRpcError(e)) {
        await this.client.proposal.delete(s, tr("USER_DISCONNECTED"));
        const i = v0("session_connect");
        if (this.events.listenerCount(i) === 0) throw new Error(`emitting ${i} without any listeners, 954`);
        this.events.emit(v0("session_connect"), { error: e.error });
      }
    }, this.onSessionSettleRequest = async (t, e) => {
      const { id: s, params: i } = e;
      try {
        this.isValidSessionSettleRequest(i);
        const { relay: r, controller: o2, expiry: a, namespaces: c2, sessionProperties: d2, pairingTopic: p3, sessionConfig: g3 } = e.params, h = m(m({ topic: t, relay: r, expiry: a, namespaces: c2, acknowledged: true, pairingTopic: p3, requiredNamespaces: {}, optionalNamespaces: {}, controller: o2.publicKey, self: { publicKey: "", metadata: this.client.metadata }, peer: { publicKey: o2.publicKey, metadata: o2.metadata } }, d2 && { sessionProperties: d2 }), g3 && { sessionConfig: g3 });
        await this.sendResult({ id: e.id, topic: t, result: true, throwOnFailedPublish: true });
        const y2 = v0("session_connect");
        if (this.events.listenerCount(y2) === 0) throw new Error(`emitting ${y2} without any listeners 997`);
        this.events.emit(v0("session_connect"), { session: h }), this.cleanupDuplicatePairings(h);
      } catch (r) {
        await this.sendError({ id: s, topic: t, error: r }), this.client.logger.error(r);
      }
    }, this.onSessionSettleResponse = async (t, e) => {
      const { id: s } = e;
      isJsonRpcResult(e) ? (await this.client.session.update(t, { acknowledged: true }), this.events.emit(v0("session_approve", s), {})) : isJsonRpcError(e) && (await this.client.session.delete(t, tr("USER_DISCONNECTED")), this.events.emit(v0("session_approve", s), { error: e.error }));
    }, this.onSessionUpdateRequest = async (t, e) => {
      const { params: s, id: i } = e;
      try {
        const r = `${t}_session_update`, o2 = lh.get(r);
        if (o2 && this.isRequestOutOfSync(o2, i)) {
          this.client.logger.info(`Discarding out of sync request - ${i}`), this.sendError({ id: i, topic: t, error: tr("INVALID_UPDATE_REQUEST") });
          return;
        }
        this.isValidUpdate(m({ topic: t }, s));
        try {
          lh.set(r, i), await this.client.session.update(t, { namespaces: s.namespaces }), await this.sendResult({ id: i, topic: t, result: true, throwOnFailedPublish: true });
        } catch (a) {
          throw lh.delete(r), a;
        }
        this.client.events.emit("session_update", { id: i, topic: t, params: s });
      } catch (r) {
        await this.sendError({ id: i, topic: t, error: r }), this.client.logger.error(r);
      }
    }, this.isRequestOutOfSync = (t, e) => parseInt(e.toString().slice(0, -3)) <= parseInt(t.toString().slice(0, -3)), this.onSessionUpdateResponse = (t, e) => {
      const { id: s } = e, i = v0("session_update", s);
      if (this.events.listenerCount(i) === 0) throw new Error(`emitting ${i} without any listeners`);
      isJsonRpcResult(e) ? this.events.emit(v0("session_update", s), {}) : isJsonRpcError(e) && this.events.emit(v0("session_update", s), { error: e.error });
    }, this.onSessionExtendRequest = async (t, e) => {
      const { id: s } = e;
      try {
        this.isValidExtend({ topic: t }), await this.setExpiry(t, d0(L)), await this.sendResult({ id: s, topic: t, result: true, throwOnFailedPublish: true }), this.client.events.emit("session_extend", { id: s, topic: t });
      } catch (i) {
        await this.sendError({ id: s, topic: t, error: i }), this.client.logger.error(i);
      }
    }, this.onSessionExtendResponse = (t, e) => {
      const { id: s } = e, i = v0("session_extend", s);
      if (this.events.listenerCount(i) === 0) throw new Error(`emitting ${i} without any listeners`);
      isJsonRpcResult(e) ? this.events.emit(v0("session_extend", s), {}) : isJsonRpcError(e) && this.events.emit(v0("session_extend", s), { error: e.error });
    }, this.onSessionPingRequest = async (t, e) => {
      const { id: s } = e;
      try {
        this.isValidPing({ topic: t }), await this.sendResult({ id: s, topic: t, result: true, throwOnFailedPublish: true }), this.client.events.emit("session_ping", { id: s, topic: t });
      } catch (i) {
        await this.sendError({ id: s, topic: t, error: i }), this.client.logger.error(i);
      }
    }, this.onSessionPingResponse = (t, e) => {
      const { id: s } = e, i = v0("session_ping", s);
      if (this.events.listenerCount(i) === 0) throw new Error(`emitting ${i} without any listeners`);
      setTimeout(() => {
        isJsonRpcResult(e) ? this.events.emit(v0("session_ping", s), {}) : isJsonRpcError(e) && this.events.emit(v0("session_ping", s), { error: e.error });
      }, 500);
    }, this.onSessionDeleteRequest = async (t, e) => {
      const { id: s } = e;
      try {
        this.isValidDisconnect({ topic: t, reason: e.params }), await Promise.all([new Promise((i) => {
          this.client.core.relayer.once(v.publish, async () => {
            i(await this.deleteSession({ topic: t, id: s }));
          });
        }), this.sendResult({ id: s, topic: t, result: true, throwOnFailedPublish: true }), this.cleanupPendingSentRequestsForTopic({ topic: t, error: tr("USER_DISCONNECTED") })]);
      } catch (i) {
        this.client.logger.error(i);
      }
    }, this.onSessionRequest = async (t, e) => {
      const { id: s, params: i } = e;
      try {
        await this.isValidRequest(m({ topic: t }, i));
        const r = yu(JSON.stringify(formatJsonRpcRequest("wc_sessionRequest", i, s))), o2 = this.client.session.get(t), a = await this.getVerifyContext(r, o2.peer.metadata), c2 = { id: s, topic: t, params: i, verifyContext: a };
        await this.setPendingSessionRequest(c2), this.addSessionRequestToSessionRequestQueue(c2), this.processSessionRequestQueue();
      } catch (r) {
        await this.sendError({ id: s, topic: t, error: r }), this.client.logger.error(r);
      }
    }, this.onSessionRequestResponse = (t, e) => {
      const { id: s } = e, i = v0("session_request", s);
      if (this.events.listenerCount(i) === 0) throw new Error(`emitting ${i} without any listeners`);
      isJsonRpcResult(e) ? this.events.emit(v0("session_request", s), { result: e.result }) : isJsonRpcError(e) && this.events.emit(v0("session_request", s), { error: e.error });
    }, this.onSessionEventRequest = async (t, e) => {
      const { id: s, params: i } = e;
      try {
        const r = `${t}_session_event_${i.event.name}`, o2 = lh.get(r);
        if (o2 && this.isRequestOutOfSync(o2, s)) {
          this.client.logger.info(`Discarding out of sync request - ${s}`);
          return;
        }
        this.isValidEmit(m({ topic: t }, i)), this.client.events.emit("session_event", { id: s, topic: t, params: i }), lh.set(r, s);
      } catch (r) {
        await this.sendError({ id: s, topic: t, error: r }), this.client.logger.error(r);
      }
    }, this.onSessionAuthenticateResponse = (t, e) => {
      const { id: s } = e;
      this.client.logger.trace({ type: "method", method: "onSessionAuthenticateResponse", topic: t, payload: e }), isJsonRpcResult(e) ? this.events.emit(v0("session_request", s), { result: e.result }) : isJsonRpcError(e) && this.events.emit(v0("session_request", s), { error: e.error });
    }, this.onSessionAuthenticateRequest = async (t, e) => {
      const { requester: s, authPayload: i, expiryTimestamp: r } = e.params, o2 = yu(JSON.stringify(e)), a = await this.getVerifyContext(o2, this.client.metadata), c2 = { requester: s, pairingTopic: t, id: e.id, authPayload: i, verifyContext: a, expiryTimestamp: r };
      await this.client.auth.requests.set(e.id, c2), this.client.events.emit("session_authenticate", { topic: t, params: e.params, id: e.id });
    }, this.addSessionRequestToSessionRequestQueue = (t) => {
      this.sessionRequestQueue.queue.push(t);
    }, this.cleanupAfterResponse = (t) => {
      this.deletePendingSessionRequest(t.response.id, { message: "fulfilled", code: 0 }), setTimeout(() => {
        this.sessionRequestQueue.state = A.idle, this.processSessionRequestQueue();
      }, (0, import_time.toMiliseconds)(this.requestQueueDelay));
    }, this.cleanupPendingSentRequestsForTopic = ({ topic: t, error: e }) => {
      const s = this.client.core.history.pending;
      s.length > 0 && s.filter((i) => i.topic === t && i.request.method === "wc_sessionRequest").forEach((i) => {
        const r = i.request.id, o2 = v0("session_request", r);
        if (this.events.listenerCount(o2) === 0) throw new Error(`emitting ${o2} without any listeners`);
        this.events.emit(v0("session_request", i.request.id), { error: e });
      });
    }, this.processSessionRequestQueue = () => {
      if (this.sessionRequestQueue.state === A.active) {
        this.client.logger.info("session request queue is already active.");
        return;
      }
      const t = this.sessionRequestQueue.queue[0];
      if (!t) {
        this.client.logger.info("session request queue is empty.");
        return;
      }
      try {
        this.sessionRequestQueue.state = A.active, this.client.events.emit("session_request", t);
      } catch (e) {
        this.client.logger.error(e);
      }
    }, this.onPairingCreated = (t) => {
      if (t.methods && this.expectedPairingMethodMap.set(t.topic, t.methods), t.active) return;
      const e = this.client.proposal.getAll().find((s) => s.pairingTopic === t.topic);
      e && this.onSessionProposeRequest(t.topic, formatJsonRpcRequest("wc_sessionPropose", { requiredNamespaces: e.requiredNamespaces, optionalNamespaces: e.optionalNamespaces, relays: e.relays, proposer: e.proposer, sessionProperties: e.sessionProperties }, e.id));
    }, this.isValidConnect = async (t) => {
      if (!$u(t)) {
        const { message: a } = xe("MISSING_OR_INVALID", `connect() params: ${JSON.stringify(t)}`);
        throw new Error(a);
      }
      const { pairingTopic: e, requiredNamespaces: s, optionalNamespaces: i, sessionProperties: r, relays: o2 } = t;
      if (Pe(e) || await this.isValidPairingTopic(e), !Xu(o2, true)) {
        const { message: a } = xe("MISSING_OR_INVALID", `connect() relays: ${o2}`);
        throw new Error(a);
      }
      !Pe(s) && Yr(s) !== 0 && this.validateNamespaces(s, "requiredNamespaces"), !Pe(i) && Yr(i) !== 0 && this.validateNamespaces(i, "optionalNamespaces"), Pe(r) || this.validateSessionProps(r, "sessionProperties");
    }, this.validateNamespaces = (t, e) => {
      const s = Wu(t, "connect()", e);
      if (s) throw new Error(s.message);
    }, this.isValidApprove = async (t) => {
      if (!$u(t)) throw new Error(xe("MISSING_OR_INVALID", `approve() params: ${t}`).message);
      const { id: e, namespaces: s, relayProtocol: i, sessionProperties: r } = t;
      this.checkRecentlyDeleted(e), await this.isValidProposalId(e);
      const o2 = this.client.proposal.get(e), a = So(s, "approve()");
      if (a) throw new Error(a.message);
      const c2 = Io(o2.requiredNamespaces, s, "approve()");
      if (c2) throw new Error(c2.message);
      if (!Gt(i, true)) {
        const { message: d2 } = xe("MISSING_OR_INVALID", `approve() relayProtocol: ${i}`);
        throw new Error(d2);
      }
      Pe(r) || this.validateSessionProps(r, "sessionProperties");
    }, this.isValidReject = async (t) => {
      if (!$u(t)) {
        const { message: i } = xe("MISSING_OR_INVALID", `reject() params: ${t}`);
        throw new Error(i);
      }
      const { id: e, reason: s } = t;
      if (this.checkRecentlyDeleted(e), await this.isValidProposalId(e), !th(s)) {
        const { message: i } = xe("MISSING_OR_INVALID", `reject() reason: ${JSON.stringify(s)}`);
        throw new Error(i);
      }
    }, this.isValidSessionSettleRequest = (t) => {
      if (!$u(t)) {
        const { message: c2 } = xe("MISSING_OR_INVALID", `onSessionSettleRequest() params: ${t}`);
        throw new Error(c2);
      }
      const { relay: e, controller: s, namespaces: i, expiry: r } = t;
      if (!No(e)) {
        const { message: c2 } = xe("MISSING_OR_INVALID", "onSessionSettleRequest() relay protocol should be a string");
        throw new Error(c2);
      }
      const o2 = Vu(s, "onSessionSettleRequest()");
      if (o2) throw new Error(o2.message);
      const a = So(i, "onSessionSettleRequest()");
      if (a) throw new Error(a.message);
      if (p0(r)) {
        const { message: c2 } = xe("EXPIRED", "onSessionSettleRequest()");
        throw new Error(c2);
      }
    }, this.isValidUpdate = async (t) => {
      if (!$u(t)) {
        const { message: a } = xe("MISSING_OR_INVALID", `update() params: ${t}`);
        throw new Error(a);
      }
      const { topic: e, namespaces: s } = t;
      this.checkRecentlyDeleted(e), await this.isValidSessionTopic(e);
      const i = this.client.session.get(e), r = So(s, "update()");
      if (r) throw new Error(r.message);
      const o2 = Io(i.requiredNamespaces, s, "update()");
      if (o2) throw new Error(o2.message);
    }, this.isValidExtend = async (t) => {
      if (!$u(t)) {
        const { message: s } = xe("MISSING_OR_INVALID", `extend() params: ${t}`);
        throw new Error(s);
      }
      const { topic: e } = t;
      this.checkRecentlyDeleted(e), await this.isValidSessionTopic(e);
    }, this.isValidRequest = async (t) => {
      if (!$u(t)) {
        const { message: a } = xe("MISSING_OR_INVALID", `request() params: ${t}`);
        throw new Error(a);
      }
      const { topic: e, request: s, chainId: i, expiry: r } = t;
      this.checkRecentlyDeleted(e), await this.isValidSessionTopic(e);
      const { namespaces: o2 } = this.client.session.get(e);
      if (!nh(o2, i)) {
        const { message: a } = xe("MISSING_OR_INVALID", `request() chainId: ${i}`);
        throw new Error(a);
      }
      if (!eh(s)) {
        const { message: a } = xe("MISSING_OR_INVALID", `request() ${JSON.stringify(s)}`);
        throw new Error(a);
      }
      if (!fh(o2, i, s.method)) {
        const { message: a } = xe("MISSING_OR_INVALID", `request() method: ${s.method}`);
        throw new Error(a);
      }
      if (r && !uh(r, re)) {
        const { message: a } = xe("MISSING_OR_INVALID", `request() expiry: ${r}. Expiry must be a number (in seconds) between ${re.min} and ${re.max}`);
        throw new Error(a);
      }
    }, this.isValidRespond = async (t) => {
      var e;
      if (!$u(t)) {
        const { message: r } = xe("MISSING_OR_INVALID", `respond() params: ${t}`);
        throw new Error(r);
      }
      const { topic: s, response: i } = t;
      try {
        await this.isValidSessionTopic(s);
      } catch (r) {
        throw (e = t == null ? void 0 : t.response) != null && e.id && this.cleanupAfterResponse(t), r;
      }
      if (!rh(i)) {
        const { message: r } = xe("MISSING_OR_INVALID", `respond() response: ${JSON.stringify(i)}`);
        throw new Error(r);
      }
    }, this.isValidPing = async (t) => {
      if (!$u(t)) {
        const { message: s } = xe("MISSING_OR_INVALID", `ping() params: ${t}`);
        throw new Error(s);
      }
      const { topic: e } = t;
      await this.isValidSessionOrPairingTopic(e);
    }, this.isValidEmit = async (t) => {
      if (!$u(t)) {
        const { message: o2 } = xe("MISSING_OR_INVALID", `emit() params: ${t}`);
        throw new Error(o2);
      }
      const { topic: e, event: s, chainId: i } = t;
      await this.isValidSessionTopic(e);
      const { namespaces: r } = this.client.session.get(e);
      if (!nh(r, i)) {
        const { message: o2 } = xe("MISSING_OR_INVALID", `emit() chainId: ${i}`);
        throw new Error(o2);
      }
      if (!ih(s)) {
        const { message: o2 } = xe("MISSING_OR_INVALID", `emit() event: ${JSON.stringify(s)}`);
        throw new Error(o2);
      }
      if (!oh(r, i, s.name)) {
        const { message: o2 } = xe("MISSING_OR_INVALID", `emit() event: ${JSON.stringify(s)}`);
        throw new Error(o2);
      }
    }, this.isValidDisconnect = async (t) => {
      if (!$u(t)) {
        const { message: s } = xe("MISSING_OR_INVALID", `disconnect() params: ${t}`);
        throw new Error(s);
      }
      const { topic: e } = t;
      await this.isValidSessionOrPairingTopic(e);
    }, this.isValidAuthenticate = (t) => {
      const { chains: e, uri: s, domain: i, nonce: r } = t;
      if (!Array.isArray(e) || e.length === 0) throw new Error("chains is required and must be a non-empty array");
      if (!Gt(s, false)) throw new Error("uri is required parameter");
      if (!Gt(i, false)) throw new Error("domain is required parameter");
      if (!Gt(r, false)) throw new Error("nonce is required parameter");
      if ([...new Set(e.map((a) => dn(a).namespace))].length > 1) throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");
      const { namespace: o2 } = dn(e[0]);
      if (o2 !== "eip155") throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.");
    }, this.getVerifyContext = async (t, e) => {
      const s = { verified: { verifyUrl: e.verifyUrl || k2, validation: "UNKNOWN", origin: e.url || "" } };
      try {
        const i = await this.client.core.verify.resolve({ attestationId: t, verifyUrl: e.verifyUrl });
        i && (s.verified.origin = i.origin, s.verified.isScam = i.isScam, s.verified.validation = i.origin === new URL(e.url).origin ? "VALID" : "INVALID");
      } catch (i) {
        this.client.logger.info(i);
      }
      return this.client.logger.info(`Verify context: ${JSON.stringify(s)}`), s;
    }, this.validateSessionProps = (t, e) => {
      Object.values(t).forEach((s) => {
        if (!Gt(s, false)) {
          const { message: i } = xe("MISSING_OR_INVALID", `${e} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);
          throw new Error(i);
        }
      });
    }, this.getPendingAuthRequest = (t) => {
      const e = this.client.auth.requests.get(t);
      return typeof e == "object" ? e : void 0;
    }, this.addToRecentlyDeleted = (t, e) => {
      if (this.recentlyDeletedMap.set(t, e), this.recentlyDeletedMap.size >= this.recentlyDeletedLimit) {
        let s = 0;
        const i = this.recentlyDeletedLimit / 2;
        for (const r of this.recentlyDeletedMap.keys()) {
          if (s++ >= i) break;
          this.recentlyDeletedMap.delete(r);
        }
      }
    }, this.checkRecentlyDeleted = (t) => {
      const e = this.recentlyDeletedMap.get(t);
      if (e) {
        const { message: s } = xe("MISSING_OR_INVALID", `Record was recently deleted - ${e}: ${t}`);
        throw new Error(s);
      }
    };
  }
  async isInitialized() {
    if (!this.initialized) {
      const { message: n } = xe("NOT_INITIALIZED", this.name);
      throw new Error(n);
    }
    await this.client.core.relayer.confirmOnlineStateOrThrow();
  }
  registerRelayerEvents() {
    this.client.core.relayer.on(v.message, async (n) => {
      const { topic: t, message: e } = n, { publicKey: s } = this.client.auth.authKeys.keys.includes(J) ? this.client.auth.authKeys.get(J) : { responseTopic: void 0, publicKey: void 0 }, i = await this.client.core.crypto.decode(t, e, { receiverPublicKey: s });
      try {
        isJsonRpcRequest(i) ? (this.client.core.history.set(t, i), this.onRelayEventRequest({ topic: t, payload: i })) : isJsonRpcResponse(i) ? (await this.client.core.history.resolve(i), await this.onRelayEventResponse({ topic: t, payload: i }), this.client.core.history.delete(t, i.id)) : this.onRelayEventUnknownPayload({ topic: t, payload: i });
      } catch (r) {
        this.client.logger.error(r);
      }
    });
  }
  registerExpirerEvents() {
    this.client.core.expirer.on(C.expired, async (n) => {
      const { topic: t, id: e } = l0(n.target);
      if (e && this.client.pendingRequest.keys.includes(e)) return await this.deletePendingSessionRequest(e, xe("EXPIRED"), true);
      t ? this.client.session.keys.includes(t) && (await this.deleteSession({ topic: t, expirerHasDeleted: true }), this.client.events.emit("session_expire", { topic: t })) : e && (await this.deleteProposal(e, true), this.client.events.emit("proposal_expire", { id: e }));
    });
  }
  registerPairingEvents() {
    this.client.core.pairing.events.on(V.create, (n) => this.onPairingCreated(n)), this.client.core.pairing.events.on(V.delete, (n) => {
      this.addToRecentlyDeleted(n.topic, "pairing");
    });
  }
  isValidPairingTopic(n) {
    if (!Gt(n, false)) {
      const { message: t } = xe("MISSING_OR_INVALID", `pairing topic should be a string: ${n}`);
      throw new Error(t);
    }
    if (!this.client.core.pairing.pairings.keys.includes(n)) {
      const { message: t } = xe("NO_MATCHING_KEY", `pairing topic doesn't exist: ${n}`);
      throw new Error(t);
    }
    if (p0(this.client.core.pairing.pairings.get(n).expiry)) {
      const { message: t } = xe("EXPIRED", `pairing topic: ${n}`);
      throw new Error(t);
    }
  }
  async isValidSessionTopic(n) {
    if (!Gt(n, false)) {
      const { message: t } = xe("MISSING_OR_INVALID", `session topic should be a string: ${n}`);
      throw new Error(t);
    }
    if (this.checkRecentlyDeleted(n), !this.client.session.keys.includes(n)) {
      const { message: t } = xe("NO_MATCHING_KEY", `session topic doesn't exist: ${n}`);
      throw new Error(t);
    }
    if (p0(this.client.session.get(n).expiry)) {
      await this.deleteSession({ topic: n });
      const { message: t } = xe("EXPIRED", `session topic: ${n}`);
      throw new Error(t);
    }
    if (!this.client.core.crypto.keychain.has(n)) {
      const { message: t } = xe("MISSING_OR_INVALID", `session topic does not exist in keychain: ${n}`);
      throw await this.deleteSession({ topic: n }), new Error(t);
    }
  }
  async isValidSessionOrPairingTopic(n) {
    if (this.checkRecentlyDeleted(n), this.client.session.keys.includes(n)) await this.isValidSessionTopic(n);
    else if (this.client.core.pairing.pairings.keys.includes(n)) this.isValidPairingTopic(n);
    else if (Gt(n, false)) {
      const { message: t } = xe("NO_MATCHING_KEY", `session or pairing topic doesn't exist: ${n}`);
      throw new Error(t);
    } else {
      const { message: t } = xe("MISSING_OR_INVALID", `session or pairing topic should be a string: ${n}`);
      throw new Error(t);
    }
  }
  async isValidProposalId(n) {
    if (!Zu(n)) {
      const { message: t } = xe("MISSING_OR_INVALID", `proposal id should be a number: ${n}`);
      throw new Error(t);
    }
    if (!this.client.proposal.keys.includes(n)) {
      const { message: t } = xe("NO_MATCHING_KEY", `proposal id doesn't exist: ${n}`);
      throw new Error(t);
    }
    if (p0(this.client.proposal.get(n).expiryTimestamp)) {
      await this.deleteProposal(n);
      const { message: t } = xe("EXPIRED", `proposal id: ${n}`);
      throw new Error(t);
    }
  }
};
var Zt = class extends Vt {
  constructor(n, t) {
    super(n, t, Ke, se), this.core = n, this.logger = t;
  }
};
var We = class extends Vt {
  constructor(n, t) {
    super(n, t, Ge, se), this.core = n, this.logger = t;
  }
};
var es = class extends Vt {
  constructor(n, t) {
    super(n, t, Fe, se, (e) => e.id), this.core = n, this.logger = t;
  }
};
var ts = class extends Vt {
  constructor(n, t) {
    super(n, t, He, X, () => J), this.core = n, this.logger = t;
  }
};
var ss = class extends Vt {
  constructor(n, t) {
    super(n, t, Ye, X), this.core = n, this.logger = t;
  }
};
var is = class extends Vt {
  constructor(n, t) {
    super(n, t, Xe, X, (e) => e.id), this.core = n, this.logger = t;
  }
};
var rs = class {
  constructor(n, t) {
    this.core = n, this.logger = t, this.authKeys = new ts(this.core, this.logger), this.pairingTopics = new ss(this.core, this.logger), this.requests = new is(this.core, this.logger);
  }
  async init() {
    await this.authKeys.init(), await this.pairingTopics.init(), await this.requests.init();
  }
};
var ne = class _ne extends b {
  constructor(n) {
    super(n), this.protocol = Se, this.version = Ee, this.name = ie.name, this.events = new import_events.EventEmitter(), this.on = (e, s) => this.events.on(e, s), this.once = (e, s) => this.events.once(e, s), this.off = (e, s) => this.events.off(e, s), this.removeListener = (e, s) => this.events.removeListener(e, s), this.removeAllListeners = (e) => this.events.removeAllListeners(e), this.connect = async (e) => {
      try {
        return await this.engine.connect(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.pair = async (e) => {
      try {
        return await this.engine.pair(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.approve = async (e) => {
      try {
        return await this.engine.approve(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.reject = async (e) => {
      try {
        return await this.engine.reject(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.update = async (e) => {
      try {
        return await this.engine.update(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.extend = async (e) => {
      try {
        return await this.engine.extend(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.request = async (e) => {
      try {
        return await this.engine.request(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.respond = async (e) => {
      try {
        return await this.engine.respond(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.ping = async (e) => {
      try {
        return await this.engine.ping(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.emit = async (e) => {
      try {
        return await this.engine.emit(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.disconnect = async (e) => {
      try {
        return await this.engine.disconnect(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.find = (e) => {
      try {
        return this.engine.find(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.getPendingSessionRequests = () => {
      try {
        return this.engine.getPendingSessionRequests();
      } catch (e) {
        throw this.logger.error(e.message), e;
      }
    }, this.authenticate = async (e) => {
      try {
        return await this.engine.authenticate(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.formatAuthMessage = (e) => {
      try {
        return this.engine.formatAuthMessage(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.approveSessionAuthenticate = async (e) => {
      try {
        return await this.engine.approveSessionAuthenticate(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.rejectSessionAuthenticate = async (e) => {
      try {
        return await this.engine.rejectSessionAuthenticate(e);
      } catch (s) {
        throw this.logger.error(s.message), s;
      }
    }, this.name = (n == null ? void 0 : n.name) || ie.name, this.metadata = (n == null ? void 0 : n.metadata) || Xo();
    const t = typeof (n == null ? void 0 : n.logger) < "u" && typeof (n == null ? void 0 : n.logger) != "string" ? n.logger : (0, import_pino.default)(k({ level: (n == null ? void 0 : n.logger) || ie.logger }));
    this.core = (n == null ? void 0 : n.core) || new Br(n), this.logger = E(t, this.name), this.session = new We(this.core, this.logger), this.proposal = new Zt(this.core, this.logger), this.pendingRequest = new es(this.core, this.logger), this.engine = new Wt(this), this.auth = new rs(this.core, this.logger);
  }
  static async init(n) {
    const t = new _ne(n);
    return await t.initialize(), t;
  }
  get context() {
    return y(this.logger);
  }
  get pairing() {
    return this.core.pairing.pairings;
  }
  async initialize() {
    this.logger.trace("Initialized");
    try {
      await this.core.start(), await this.session.init(), await this.proposal.init(), await this.pendingRequest.init(), await this.engine.init(), await this.auth.init(), this.core.verify.init({ verifyUrl: this.metadata.verifyUrl }), this.logger.info("SignClient Initialization Success");
    } catch (n) {
      throw this.logger.info("SignClient Initialization Failure"), this.logger.error(n.message), n;
    }
  }
};

// node_modules/@walletconnect/jsonrpc-http-connection/dist/index.es.js
var import_events2 = __toESM(require_events());
var import_cross_fetch = __toESM(require_browser_ponyfill());
var P = Object.defineProperty;
var w2 = Object.defineProperties;
var E2 = Object.getOwnPropertyDescriptors;
var c = Object.getOwnPropertySymbols;
var L2 = Object.prototype.hasOwnProperty;
var O = Object.prototype.propertyIsEnumerable;
var l = (r, t, e) => t in r ? P(r, t, { enumerable: true, configurable: true, writable: true, value: e }) : r[t] = e;
var p = (r, t) => {
  for (var e in t || (t = {})) L2.call(t, e) && l(r, e, t[e]);
  if (c) for (var e of c(t)) O.call(t, e) && l(r, e, t[e]);
  return r;
};
var v2 = (r, t) => w2(r, E2(t));
var j = { Accept: "application/json", "Content-Type": "application/json" };
var T = "POST";
var d = { headers: j, method: T };
var g = 10;
var f = class {
  constructor(t, e = false) {
    if (this.url = t, this.disableProviderPing = e, this.events = new import_events2.EventEmitter(), this.isAvailable = false, this.registering = false, !isHttpUrl(t)) throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);
    this.url = t, this.disableProviderPing = e;
  }
  get connected() {
    return this.isAvailable;
  }
  get connecting() {
    return this.registering;
  }
  on(t, e) {
    this.events.on(t, e);
  }
  once(t, e) {
    this.events.once(t, e);
  }
  off(t, e) {
    this.events.off(t, e);
  }
  removeListener(t, e) {
    this.events.removeListener(t, e);
  }
  async open(t = this.url) {
    await this.register(t);
  }
  async close() {
    if (!this.isAvailable) throw new Error("Connection already closed");
    this.onClose();
  }
  async send(t) {
    this.isAvailable || await this.register();
    try {
      const e = safeJsonStringify(t), s = await (await (0, import_cross_fetch.default)(this.url, v2(p({}, d), { body: e }))).json();
      this.onPayload({ data: s });
    } catch (e) {
      this.onError(t.id, e);
    }
  }
  async register(t = this.url) {
    if (!isHttpUrl(t)) throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);
    if (this.registering) {
      const e = this.events.getMaxListeners();
      return (this.events.listenerCount("register_error") >= e || this.events.listenerCount("open") >= e) && this.events.setMaxListeners(e + 1), new Promise((s, i) => {
        this.events.once("register_error", (n) => {
          this.resetMaxListeners(), i(n);
        }), this.events.once("open", () => {
          if (this.resetMaxListeners(), typeof this.isAvailable > "u") return i(new Error("HTTP connection is missing or invalid"));
          s();
        });
      });
    }
    this.url = t, this.registering = true;
    try {
      if (!this.disableProviderPing) {
        const e = safeJsonStringify({ id: 1, jsonrpc: "2.0", method: "test", params: [] });
        await (0, import_cross_fetch.default)(t, v2(p({}, d), { body: e }));
      }
      this.onOpen();
    } catch (e) {
      const s = this.parseError(e);
      throw this.events.emit("register_error", s), this.onClose(), s;
    }
  }
  onOpen() {
    this.isAvailable = true, this.registering = false, this.events.emit("open");
  }
  onClose() {
    this.isAvailable = false, this.registering = false, this.events.emit("close");
  }
  onPayload(t) {
    if (typeof t.data > "u") return;
    const e = typeof t.data == "string" ? safeJsonParse(t.data) : t.data;
    this.events.emit("payload", e);
  }
  onError(t, e) {
    const s = this.parseError(e), i = s.message || s.toString(), n = formatJsonRpcError(t, i);
    this.events.emit("payload", n);
  }
  parseError(t, e = this.url) {
    return parseConnectionError(t, e, "HTTP");
  }
  resetMaxListeners() {
    this.events.getMaxListeners() > g && this.events.setMaxListeners(g);
  }
};

// node_modules/@thirdweb-dev/wallets/node_modules/@walletconnect/universal-provider/dist/index.es.js
var import_events3 = __toESM(require_events());
var xa = "error";
var Mg = "wss://relay.walletconnect.com";
var qg = "wc";
var Bg = "universal_provider";
var Ea = `${qg}@2:${Bg}:`;
var Gg = "https://rpc.walletconnect.com/v1/";
var Vn = { DEFAULT_CHAIN_CHANGED: "default_chain_changed" };
var ge2 = typeof globalThis < "u" ? globalThis : typeof window < "u" ? window : typeof global < "u" ? global : typeof self < "u" ? self : {};
var Ui = { exports: {} };
(function(A3, u2) {
  (function() {
    var i, p3 = "4.17.21", w3 = 200, b3 = "Unsupported core-js use. Try https://npms.io/search?q=ponyfill.", D2 = "Expected a function", En = "Invalid `variable` option passed into `_.template`", zt = "__lodash_hash_undefined__", pr2 = 500, It = "__lodash_placeholder__", Ln = 1, Fn = 2, xt = 4, Et = 1, ve = 2, vn = 1, ct = 2, Bi = 4, Dn = 8, yt = 16, Nn = 32, St = 64, Mn = 128, Kt = 256, dr = 512, Na = 30, Ha = "...", $a = 800, Ua = 16, Gi = 1, Wa = 2, Fa = 3, ht = 1 / 0, kn = 9007199254740991, Ma = 17976931348623157e292, _e2 = 0 / 0, Hn = 4294967295, qa = Hn - 1, Ba = Hn >>> 1, Ga = [["ary", Mn], ["bind", vn], ["bindKey", ct], ["curry", Dn], ["curryRight", yt], ["flip", dr], ["partial", Nn], ["partialRight", St], ["rearg", Kt]], Ot = "[object Arguments]", me = "[object Array]", za = "[object AsyncFunction]", Yt2 = "[object Boolean]", Zt2 = "[object Date]", Ka = "[object DOMException]", we = "[object Error]", Pe2 = "[object Function]", zi = "[object GeneratorFunction]", yn = "[object Map]", Jt2 = "[object Number]", Ya = "[object Null]", qn = "[object Object]", Ki = "[object Promise]", Za = "[object Proxy]", Xt2 = "[object RegExp]", Sn = "[object Set]", Qt = "[object String]", Ae = "[object Symbol]", Ja = "[object Undefined]", Vt3 = "[object WeakMap]", Xa = "[object WeakSet]", kt = "[object ArrayBuffer]", Rt = "[object DataView]", gr = "[object Float32Array]", vr = "[object Float64Array]", _r = "[object Int8Array]", mr = "[object Int16Array]", wr = "[object Int32Array]", Pr = "[object Uint8Array]", Ar = "[object Uint8ClampedArray]", Cr = "[object Uint16Array]", Ir = "[object Uint32Array]", Qa = /\b__p \+= '';/g, Va = /\b(__p \+=) '' \+/g, ka = /(__e\(.*?\)|\b__t\)) \+\n'';/g, Yi = /&(?:amp|lt|gt|quot|#39);/g, Zi2 = /[&<>"']/g, ja = RegExp(Yi.source), no = RegExp(Zi2.source), to = /<%-([\s\S]+?)%>/g, eo = /<%([\s\S]+?)%>/g, Ji = /<%=([\s\S]+?)%>/g, ro = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, io = /^\w*$/, so = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, xr = /[\\^$.*+?()[\]{}|]/g, uo = RegExp(xr.source), Er2 = /^\s+/, ao = /\s/, oo = /\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/, fo = /\{\n\/\* \[wrapped with (.+)\] \*/, co = /,? & /, ho = /[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g, lo = /[()=,{}\[\]\/\s]/, po = /\\(\\)?/g, go = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, Xi = /\w*$/, vo2 = /^[-+]0x[0-9a-f]+$/i, _o = /^0b[01]+$/i, mo = /^\[object .+?Constructor\]$/, wo = /^0o[0-7]+$/i, Po = /^(?:0|[1-9]\d*)$/, Ao = /[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g, Ce = /($^)/, Co = /['\n\r\u2028\u2029\\]/g, Ie = "\\ud800-\\udfff", Io2 = "\\u0300-\\u036f", xo = "\\ufe20-\\ufe2f", Eo = "\\u20d0-\\u20ff", Qi = Io2 + xo + Eo, Vi = "\\u2700-\\u27bf", ki = "a-z\\xdf-\\xf6\\xf8-\\xff", yo = "\\xac\\xb1\\xd7\\xf7", So2 = "\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf", Oo = "\\u2000-\\u206f", Ro = " \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000", ji = "A-Z\\xc0-\\xd6\\xd8-\\xde", ns = "\\ufe0e\\ufe0f", ts2 = yo + So2 + Oo + Ro, yr = "['’]", bo = "[" + Ie + "]", es2 = "[" + ts2 + "]", xe2 = "[" + Qi + "]", rs2 = "\\d+", To = "[" + Vi + "]", is2 = "[" + ki + "]", ss2 = "[^" + Ie + ts2 + rs2 + Vi + ki + ji + "]", Sr = "\\ud83c[\\udffb-\\udfff]", Lo = "(?:" + xe2 + "|" + Sr + ")", us = "[^" + Ie + "]", Or = "(?:\\ud83c[\\udde6-\\uddff]){2}", Rr = "[\\ud800-\\udbff][\\udc00-\\udfff]", bt2 = "[" + ji + "]", as = "\\u200d", os = "(?:" + is2 + "|" + ss2 + ")", Do = "(?:" + bt2 + "|" + ss2 + ")", fs = "(?:" + yr + "(?:d|ll|m|re|s|t|ve))?", cs = "(?:" + yr + "(?:D|LL|M|RE|S|T|VE))?", hs = Lo + "?", ls = "[" + ns + "]?", No2 = "(?:" + as + "(?:" + [us, Or, Rr].join("|") + ")" + ls + hs + ")*", Ho = "\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])", $o = "\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])", ps = ls + hs + No2, Uo = "(?:" + [To, Or, Rr].join("|") + ")" + ps, Wo = "(?:" + [us + xe2 + "?", xe2, Or, Rr, bo].join("|") + ")", Fo = RegExp(yr, "g"), Mo = RegExp(xe2, "g"), br = RegExp(Sr + "(?=" + Sr + ")|" + Wo + ps, "g"), qo = RegExp([bt2 + "?" + is2 + "+" + fs + "(?=" + [es2, bt2, "$"].join("|") + ")", Do + "+" + cs + "(?=" + [es2, bt2 + os, "$"].join("|") + ")", bt2 + "?" + os + "+" + fs, bt2 + "+" + cs, $o, Ho, rs2, Uo].join("|"), "g"), Bo = RegExp("[" + as + Ie + Qi + ns + "]"), Go = /[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/, zo2 = ["Array", "Buffer", "DataView", "Date", "Error", "Float32Array", "Float64Array", "Function", "Int8Array", "Int16Array", "Int32Array", "Map", "Math", "Object", "Promise", "RegExp", "Set", "String", "Symbol", "TypeError", "Uint8Array", "Uint8ClampedArray", "Uint16Array", "Uint32Array", "WeakMap", "_", "clearTimeout", "isFinite", "parseInt", "setTimeout"], Ko = -1, B = {};
    B[gr] = B[vr] = B[_r] = B[mr] = B[wr] = B[Pr] = B[Ar] = B[Cr] = B[Ir] = true, B[Ot] = B[me] = B[kt] = B[Yt2] = B[Rt] = B[Zt2] = B[we] = B[Pe2] = B[yn] = B[Jt2] = B[qn] = B[Xt2] = B[Sn] = B[Qt] = B[Vt3] = false;
    var q3 = {};
    q3[Ot] = q3[me] = q3[kt] = q3[Rt] = q3[Yt2] = q3[Zt2] = q3[gr] = q3[vr] = q3[_r] = q3[mr] = q3[wr] = q3[yn] = q3[Jt2] = q3[qn] = q3[Xt2] = q3[Sn] = q3[Qt] = q3[Ae] = q3[Pr] = q3[Ar] = q3[Cr] = q3[Ir] = true, q3[we] = q3[Pe2] = q3[Vt3] = false;
    var Yo = { À: "A", Á: "A", Â: "A", Ã: "A", Ä: "A", Å: "A", à: "a", á: "a", â: "a", ã: "a", ä: "a", å: "a", Ç: "C", ç: "c", Ð: "D", ð: "d", È: "E", É: "E", Ê: "E", Ë: "E", è: "e", é: "e", ê: "e", ë: "e", Ì: "I", Í: "I", Î: "I", Ï: "I", ì: "i", í: "i", î: "i", ï: "i", Ñ: "N", ñ: "n", Ò: "O", Ó: "O", Ô: "O", Õ: "O", Ö: "O", Ø: "O", ò: "o", ó: "o", ô: "o", õ: "o", ö: "o", ø: "o", Ù: "U", Ú: "U", Û: "U", Ü: "U", ù: "u", ú: "u", û: "u", ü: "u", Ý: "Y", ý: "y", ÿ: "y", Æ: "Ae", æ: "ae", Þ: "Th", þ: "th", ß: "ss", Ā: "A", Ă: "A", Ą: "A", ā: "a", ă: "a", ą: "a", Ć: "C", Ĉ: "C", Ċ: "C", Č: "C", ć: "c", ĉ: "c", ċ: "c", č: "c", Ď: "D", Đ: "D", ď: "d", đ: "d", Ē: "E", Ĕ: "E", Ė: "E", Ę: "E", Ě: "E", ē: "e", ĕ: "e", ė: "e", ę: "e", ě: "e", Ĝ: "G", Ğ: "G", Ġ: "G", Ģ: "G", ĝ: "g", ğ: "g", ġ: "g", ģ: "g", Ĥ: "H", Ħ: "H", ĥ: "h", ħ: "h", Ĩ: "I", Ī: "I", Ĭ: "I", Į: "I", İ: "I", ĩ: "i", ī: "i", ĭ: "i", į: "i", ı: "i", Ĵ: "J", ĵ: "j", Ķ: "K", ķ: "k", ĸ: "k", Ĺ: "L", Ļ: "L", Ľ: "L", Ŀ: "L", Ł: "L", ĺ: "l", ļ: "l", ľ: "l", ŀ: "l", ł: "l", Ń: "N", Ņ: "N", Ň: "N", Ŋ: "N", ń: "n", ņ: "n", ň: "n", ŋ: "n", Ō: "O", Ŏ: "O", Ő: "O", ō: "o", ŏ: "o", ő: "o", Ŕ: "R", Ŗ: "R", Ř: "R", ŕ: "r", ŗ: "r", ř: "r", Ś: "S", Ŝ: "S", Ş: "S", Š: "S", ś: "s", ŝ: "s", ş: "s", š: "s", Ţ: "T", Ť: "T", Ŧ: "T", ţ: "t", ť: "t", ŧ: "t", Ũ: "U", Ū: "U", Ŭ: "U", Ů: "U", Ű: "U", Ų: "U", ũ: "u", ū: "u", ŭ: "u", ů: "u", ű: "u", ų: "u", Ŵ: "W", ŵ: "w", Ŷ: "Y", ŷ: "y", Ÿ: "Y", Ź: "Z", Ż: "Z", Ž: "Z", ź: "z", ż: "z", ž: "z", Ĳ: "IJ", ĳ: "ij", Œ: "Oe", œ: "oe", ŉ: "'n", ſ: "s" }, Zo = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }, Jo = { "&amp;": "&", "&lt;": "<", "&gt;": ">", "&quot;": '"', "&#39;": "'" }, Xo2 = { "\\": "\\", "'": "'", "\n": "n", "\r": "r", "\u2028": "u2028", "\u2029": "u2029" }, Qo = parseFloat, Vo = parseInt, ds = typeof ge2 == "object" && ge2 && ge2.Object === Object && ge2, ko = typeof self == "object" && self && self.Object === Object && self, k3 = ds || ko || Function("return this")(), Tr = u2 && !u2.nodeType && u2, lt2 = Tr && true && A3 && !A3.nodeType && A3, gs = lt2 && lt2.exports === Tr, Lr = gs && ds.process, _n = function() {
      try {
        var h = lt2 && lt2.require && lt2.require("util").types;
        return h || Lr && Lr.binding && Lr.binding("util");
      } catch {
      }
    }(), vs = _n && _n.isArrayBuffer, _s = _n && _n.isDate, ms = _n && _n.isMap, ws = _n && _n.isRegExp, Ps = _n && _n.isSet, As = _n && _n.isTypedArray;
    function cn(h, g3, d2) {
      switch (d2.length) {
        case 0:
          return h.call(g3);
        case 1:
          return h.call(g3, d2[0]);
        case 2:
          return h.call(g3, d2[0], d2[1]);
        case 3:
          return h.call(g3, d2[0], d2[1], d2[2]);
      }
      return h.apply(g3, d2);
    }
    function jo(h, g3, d2, C4) {
      for (var S2 = -1, U3 = h == null ? 0 : h.length; ++S2 < U3; ) {
        var X2 = h[S2];
        g3(C4, X2, d2(X2), h);
      }
      return C4;
    }
    function mn(h, g3) {
      for (var d2 = -1, C4 = h == null ? 0 : h.length; ++d2 < C4 && g3(h[d2], d2, h) !== false; ) ;
      return h;
    }
    function nf(h, g3) {
      for (var d2 = h == null ? 0 : h.length; d2-- && g3(h[d2], d2, h) !== false; ) ;
      return h;
    }
    function Cs(h, g3) {
      for (var d2 = -1, C4 = h == null ? 0 : h.length; ++d2 < C4; ) if (!g3(h[d2], d2, h)) return false;
      return true;
    }
    function jn(h, g3) {
      for (var d2 = -1, C4 = h == null ? 0 : h.length, S2 = 0, U3 = []; ++d2 < C4; ) {
        var X2 = h[d2];
        g3(X2, d2, h) && (U3[S2++] = X2);
      }
      return U3;
    }
    function Ee2(h, g3) {
      var d2 = h == null ? 0 : h.length;
      return !!d2 && Tt(h, g3, 0) > -1;
    }
    function Dr(h, g3, d2) {
      for (var C4 = -1, S2 = h == null ? 0 : h.length; ++C4 < S2; ) if (d2(g3, h[C4])) return true;
      return false;
    }
    function G(h, g3) {
      for (var d2 = -1, C4 = h == null ? 0 : h.length, S2 = Array(C4); ++d2 < C4; ) S2[d2] = g3(h[d2], d2, h);
      return S2;
    }
    function nt(h, g3) {
      for (var d2 = -1, C4 = g3.length, S2 = h.length; ++d2 < C4; ) h[S2 + d2] = g3[d2];
      return h;
    }
    function Nr(h, g3, d2, C4) {
      var S2 = -1, U3 = h == null ? 0 : h.length;
      for (C4 && U3 && (d2 = h[++S2]); ++S2 < U3; ) d2 = g3(d2, h[S2], S2, h);
      return d2;
    }
    function tf(h, g3, d2, C4) {
      var S2 = h == null ? 0 : h.length;
      for (C4 && S2 && (d2 = h[--S2]); S2--; ) d2 = g3(d2, h[S2], S2, h);
      return d2;
    }
    function Hr(h, g3) {
      for (var d2 = -1, C4 = h == null ? 0 : h.length; ++d2 < C4; ) if (g3(h[d2], d2, h)) return true;
      return false;
    }
    var ef = $r("length");
    function rf(h) {
      return h.split("");
    }
    function sf(h) {
      return h.match(ho) || [];
    }
    function Is(h, g3, d2) {
      var C4;
      return d2(h, function(S2, U3, X2) {
        if (g3(S2, U3, X2)) return C4 = U3, false;
      }), C4;
    }
    function ye(h, g3, d2, C4) {
      for (var S2 = h.length, U3 = d2 + (C4 ? 1 : -1); C4 ? U3-- : ++U3 < S2; ) if (g3(h[U3], U3, h)) return U3;
      return -1;
    }
    function Tt(h, g3, d2) {
      return g3 === g3 ? _f(h, g3, d2) : ye(h, xs, d2);
    }
    function uf(h, g3, d2, C4) {
      for (var S2 = d2 - 1, U3 = h.length; ++S2 < U3; ) if (C4(h[S2], g3)) return S2;
      return -1;
    }
    function xs(h) {
      return h !== h;
    }
    function Es(h, g3) {
      var d2 = h == null ? 0 : h.length;
      return d2 ? Wr(h, g3) / d2 : _e2;
    }
    function $r(h) {
      return function(g3) {
        return g3 == null ? i : g3[h];
      };
    }
    function Ur(h) {
      return function(g3) {
        return h == null ? i : h[g3];
      };
    }
    function ys(h, g3, d2, C4, S2) {
      return S2(h, function(U3, X2, M2) {
        d2 = C4 ? (C4 = false, U3) : g3(d2, U3, X2, M2);
      }), d2;
    }
    function af(h, g3) {
      var d2 = h.length;
      for (h.sort(g3); d2--; ) h[d2] = h[d2].value;
      return h;
    }
    function Wr(h, g3) {
      for (var d2, C4 = -1, S2 = h.length; ++C4 < S2; ) {
        var U3 = g3(h[C4]);
        U3 !== i && (d2 = d2 === i ? U3 : d2 + U3);
      }
      return d2;
    }
    function Fr(h, g3) {
      for (var d2 = -1, C4 = Array(h); ++d2 < h; ) C4[d2] = g3(d2);
      return C4;
    }
    function of(h, g3) {
      return G(g3, function(d2) {
        return [d2, h[d2]];
      });
    }
    function Ss(h) {
      return h && h.slice(0, Ts(h) + 1).replace(Er2, "");
    }
    function hn(h) {
      return function(g3) {
        return h(g3);
      };
    }
    function Mr(h, g3) {
      return G(g3, function(d2) {
        return h[d2];
      });
    }
    function jt(h, g3) {
      return h.has(g3);
    }
    function Os(h, g3) {
      for (var d2 = -1, C4 = h.length; ++d2 < C4 && Tt(g3, h[d2], 0) > -1; ) ;
      return d2;
    }
    function Rs(h, g3) {
      for (var d2 = h.length; d2-- && Tt(g3, h[d2], 0) > -1; ) ;
      return d2;
    }
    function ff(h, g3) {
      for (var d2 = h.length, C4 = 0; d2--; ) h[d2] === g3 && ++C4;
      return C4;
    }
    var cf = Ur(Yo), hf = Ur(Zo);
    function lf(h) {
      return "\\" + Xo2[h];
    }
    function pf(h, g3) {
      return h == null ? i : h[g3];
    }
    function Lt(h) {
      return Bo.test(h);
    }
    function df(h) {
      return Go.test(h);
    }
    function gf(h) {
      for (var g3, d2 = []; !(g3 = h.next()).done; ) d2.push(g3.value);
      return d2;
    }
    function qr(h) {
      var g3 = -1, d2 = Array(h.size);
      return h.forEach(function(C4, S2) {
        d2[++g3] = [S2, C4];
      }), d2;
    }
    function bs(h, g3) {
      return function(d2) {
        return h(g3(d2));
      };
    }
    function tt(h, g3) {
      for (var d2 = -1, C4 = h.length, S2 = 0, U3 = []; ++d2 < C4; ) {
        var X2 = h[d2];
        (X2 === g3 || X2 === It) && (h[d2] = It, U3[S2++] = d2);
      }
      return U3;
    }
    function Se2(h) {
      var g3 = -1, d2 = Array(h.size);
      return h.forEach(function(C4) {
        d2[++g3] = C4;
      }), d2;
    }
    function vf(h) {
      var g3 = -1, d2 = Array(h.size);
      return h.forEach(function(C4) {
        d2[++g3] = [C4, C4];
      }), d2;
    }
    function _f(h, g3, d2) {
      for (var C4 = d2 - 1, S2 = h.length; ++C4 < S2; ) if (h[C4] === g3) return C4;
      return -1;
    }
    function mf(h, g3, d2) {
      for (var C4 = d2 + 1; C4--; ) if (h[C4] === g3) return C4;
      return C4;
    }
    function Dt(h) {
      return Lt(h) ? Pf(h) : ef(h);
    }
    function On(h) {
      return Lt(h) ? Af(h) : rf(h);
    }
    function Ts(h) {
      for (var g3 = h.length; g3-- && ao.test(h.charAt(g3)); ) ;
      return g3;
    }
    var wf = Ur(Jo);
    function Pf(h) {
      for (var g3 = br.lastIndex = 0; br.test(h); ) ++g3;
      return g3;
    }
    function Af(h) {
      return h.match(br) || [];
    }
    function Cf(h) {
      return h.match(qo) || [];
    }
    var If = function h(g3) {
      g3 = g3 == null ? k3 : Nt.defaults(k3.Object(), g3, Nt.pick(k3, zo2));
      var d2 = g3.Array, C4 = g3.Date, S2 = g3.Error, U3 = g3.Function, X2 = g3.Math, M2 = g3.Object, Br2 = g3.RegExp, xf = g3.String, wn = g3.TypeError, Oe = d2.prototype, Ef = U3.prototype, Ht2 = M2.prototype, Re2 = g3["__core-js_shared__"], be = Ef.toString, F2 = Ht2.hasOwnProperty, yf = 0, Ls = function() {
        var n = /[^.]+$/.exec(Re2 && Re2.keys && Re2.keys.IE_PROTO || "");
        return n ? "Symbol(src)_1." + n : "";
      }(), Te = Ht2.toString, Sf = be.call(M2), Of = k3._, Rf = Br2("^" + be.call(F2).replace(xr, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), Le2 = gs ? g3.Buffer : i, et = g3.Symbol, De = g3.Uint8Array, Ds = Le2 ? Le2.allocUnsafe : i, Ne = bs(M2.getPrototypeOf, M2), Ns = M2.create, Hs = Ht2.propertyIsEnumerable, He2 = Oe.splice, $s = et ? et.isConcatSpreadable : i, ne2 = et ? et.iterator : i, pt = et ? et.toStringTag : i, $e2 = function() {
        try {
          var n = mt(M2, "defineProperty");
          return n({}, "", {}), n;
        } catch {
        }
      }(), bf = g3.clearTimeout !== k3.clearTimeout && g3.clearTimeout, Tf = C4 && C4.now !== k3.Date.now && C4.now, Lf = g3.setTimeout !== k3.setTimeout && g3.setTimeout, Ue2 = X2.ceil, We2 = X2.floor, Gr = M2.getOwnPropertySymbols, Df = Le2 ? Le2.isBuffer : i, Us = g3.isFinite, Nf = Oe.join, Hf = bs(M2.keys, M2), Q2 = X2.max, nn = X2.min, $f = C4.now, Uf = g3.parseInt, Ws = X2.random, Wf = Oe.reverse, zr = mt(g3, "DataView"), te = mt(g3, "Map"), Kr = mt(g3, "Promise"), $t = mt(g3, "Set"), ee = mt(g3, "WeakMap"), re2 = mt(M2, "create"), Fe2 = ee && new ee(), Ut = {}, Ff = wt(zr), Mf = wt(te), qf = wt(Kr), Bf = wt($t), Gf = wt(ee), Me2 = et ? et.prototype : i, ie2 = Me2 ? Me2.valueOf : i, Fs = Me2 ? Me2.toString : i;
      function a(n) {
        if (Y(n) && !O3(n) && !(n instanceof H)) {
          if (n instanceof Pn) return n;
          if (F2.call(n, "__wrapped__")) return Mu(n);
        }
        return new Pn(n);
      }
      var Wt2 = /* @__PURE__ */ function() {
        function n() {
        }
        return function(t) {
          if (!K(t)) return {};
          if (Ns) return Ns(t);
          n.prototype = t;
          var e = new n();
          return n.prototype = i, e;
        };
      }();
      function qe() {
      }
      function Pn(n, t) {
        this.__wrapped__ = n, this.__actions__ = [], this.__chain__ = !!t, this.__index__ = 0, this.__values__ = i;
      }
      a.templateSettings = { escape: to, evaluate: eo, interpolate: Ji, variable: "", imports: { _: a } }, a.prototype = qe.prototype, a.prototype.constructor = a, Pn.prototype = Wt2(qe.prototype), Pn.prototype.constructor = Pn;
      function H(n) {
        this.__wrapped__ = n, this.__actions__ = [], this.__dir__ = 1, this.__filtered__ = false, this.__iteratees__ = [], this.__takeCount__ = Hn, this.__views__ = [];
      }
      function zf2() {
        var n = new H(this.__wrapped__);
        return n.__actions__ = un(this.__actions__), n.__dir__ = this.__dir__, n.__filtered__ = this.__filtered__, n.__iteratees__ = un(this.__iteratees__), n.__takeCount__ = this.__takeCount__, n.__views__ = un(this.__views__), n;
      }
      function Kf() {
        if (this.__filtered__) {
          var n = new H(this);
          n.__dir__ = -1, n.__filtered__ = true;
        } else n = this.clone(), n.__dir__ *= -1;
        return n;
      }
      function Yf() {
        var n = this.__wrapped__.value(), t = this.__dir__, e = O3(n), r = t < 0, s = e ? n.length : 0, o2 = ih2(0, s, this.__views__), f2 = o2.start, c2 = o2.end, l2 = c2 - f2, v4 = r ? c2 : f2 - 1, _2 = this.__iteratees__, m4 = _2.length, P2 = 0, I = nn(l2, this.__takeCount__);
        if (!e || !r && s == l2 && I == l2) return fu2(n, this.__actions__);
        var E4 = [];
        n: for (; l2-- && P2 < I; ) {
          v4 += t;
          for (var T3 = -1, y2 = n[v4]; ++T3 < m4; ) {
            var N2 = _2[T3], $2 = N2.iteratee, dn2 = N2.type, sn = $2(y2);
            if (dn2 == Wa) y2 = sn;
            else if (!sn) {
              if (dn2 == Gi) continue n;
              break n;
            }
          }
          E4[P2++] = y2;
        }
        return E4;
      }
      H.prototype = Wt2(qe.prototype), H.prototype.constructor = H;
      function dt(n) {
        var t = -1, e = n == null ? 0 : n.length;
        for (this.clear(); ++t < e; ) {
          var r = n[t];
          this.set(r[0], r[1]);
        }
      }
      function Zf() {
        this.__data__ = re2 ? re2(null) : {}, this.size = 0;
      }
      function Jf(n) {
        var t = this.has(n) && delete this.__data__[n];
        return this.size -= t ? 1 : 0, t;
      }
      function Xf(n) {
        var t = this.__data__;
        if (re2) {
          var e = t[n];
          return e === zt ? i : e;
        }
        return F2.call(t, n) ? t[n] : i;
      }
      function Qf(n) {
        var t = this.__data__;
        return re2 ? t[n] !== i : F2.call(t, n);
      }
      function Vf(n, t) {
        var e = this.__data__;
        return this.size += this.has(n) ? 0 : 1, e[n] = re2 && t === i ? zt : t, this;
      }
      dt.prototype.clear = Zf, dt.prototype.delete = Jf, dt.prototype.get = Xf, dt.prototype.has = Qf, dt.prototype.set = Vf;
      function Bn(n) {
        var t = -1, e = n == null ? 0 : n.length;
        for (this.clear(); ++t < e; ) {
          var r = n[t];
          this.set(r[0], r[1]);
        }
      }
      function kf() {
        this.__data__ = [], this.size = 0;
      }
      function jf(n) {
        var t = this.__data__, e = Be2(t, n);
        if (e < 0) return false;
        var r = t.length - 1;
        return e == r ? t.pop() : He2.call(t, e, 1), --this.size, true;
      }
      function nc(n) {
        var t = this.__data__, e = Be2(t, n);
        return e < 0 ? i : t[e][1];
      }
      function tc(n) {
        return Be2(this.__data__, n) > -1;
      }
      function ec(n, t) {
        var e = this.__data__, r = Be2(e, n);
        return r < 0 ? (++this.size, e.push([n, t])) : e[r][1] = t, this;
      }
      Bn.prototype.clear = kf, Bn.prototype.delete = jf, Bn.prototype.get = nc, Bn.prototype.has = tc, Bn.prototype.set = ec;
      function Gn(n) {
        var t = -1, e = n == null ? 0 : n.length;
        for (this.clear(); ++t < e; ) {
          var r = n[t];
          this.set(r[0], r[1]);
        }
      }
      function rc() {
        this.size = 0, this.__data__ = { hash: new dt(), map: new (te || Bn)(), string: new dt() };
      }
      function ic(n) {
        var t = nr(this, n).delete(n);
        return this.size -= t ? 1 : 0, t;
      }
      function sc(n) {
        return nr(this, n).get(n);
      }
      function uc(n) {
        return nr(this, n).has(n);
      }
      function ac(n, t) {
        var e = nr(this, n), r = e.size;
        return e.set(n, t), this.size += e.size == r ? 0 : 1, this;
      }
      Gn.prototype.clear = rc, Gn.prototype.delete = ic, Gn.prototype.get = sc, Gn.prototype.has = uc, Gn.prototype.set = ac;
      function gt(n) {
        var t = -1, e = n == null ? 0 : n.length;
        for (this.__data__ = new Gn(); ++t < e; ) this.add(n[t]);
      }
      function oc(n) {
        return this.__data__.set(n, zt), this;
      }
      function fc(n) {
        return this.__data__.has(n);
      }
      gt.prototype.add = gt.prototype.push = oc, gt.prototype.has = fc;
      function Rn(n) {
        var t = this.__data__ = new Bn(n);
        this.size = t.size;
      }
      function cc() {
        this.__data__ = new Bn(), this.size = 0;
      }
      function hc(n) {
        var t = this.__data__, e = t.delete(n);
        return this.size = t.size, e;
      }
      function lc(n) {
        return this.__data__.get(n);
      }
      function pc(n) {
        return this.__data__.has(n);
      }
      function dc(n, t) {
        var e = this.__data__;
        if (e instanceof Bn) {
          var r = e.__data__;
          if (!te || r.length < w3 - 1) return r.push([n, t]), this.size = ++e.size, this;
          e = this.__data__ = new Gn(r);
        }
        return e.set(n, t), this.size = e.size, this;
      }
      Rn.prototype.clear = cc, Rn.prototype.delete = hc, Rn.prototype.get = lc, Rn.prototype.has = pc, Rn.prototype.set = dc;
      function Ms(n, t) {
        var e = O3(n), r = !e && Pt(n), s = !e && !r && at(n), o2 = !e && !r && !s && Bt2(n), f2 = e || r || s || o2, c2 = f2 ? Fr(n.length, xf) : [], l2 = c2.length;
        for (var v4 in n) (t || F2.call(n, v4)) && !(f2 && (v4 == "length" || s && (v4 == "offset" || v4 == "parent") || o2 && (v4 == "buffer" || v4 == "byteLength" || v4 == "byteOffset") || Zn(v4, l2))) && c2.push(v4);
        return c2;
      }
      function qs(n) {
        var t = n.length;
        return t ? n[ei(0, t - 1)] : i;
      }
      function gc(n, t) {
        return tr2(un(n), vt(t, 0, n.length));
      }
      function vc(n) {
        return tr2(un(n));
      }
      function Yr2(n, t, e) {
        (e !== i && !bn(n[t], e) || e === i && !(t in n)) && zn(n, t, e);
      }
      function se2(n, t, e) {
        var r = n[t];
        (!(F2.call(n, t) && bn(r, e)) || e === i && !(t in n)) && zn(n, t, e);
      }
      function Be2(n, t) {
        for (var e = n.length; e--; ) if (bn(n[e][0], t)) return e;
        return -1;
      }
      function _c(n, t, e, r) {
        return rt(n, function(s, o2, f2) {
          t(r, s, e(s), f2);
        }), r;
      }
      function Bs(n, t) {
        return n && Un(t, V2(t), n);
      }
      function mc(n, t) {
        return n && Un(t, on(t), n);
      }
      function zn(n, t, e) {
        t == "__proto__" && $e2 ? $e2(n, t, { configurable: true, enumerable: true, value: e, writable: true }) : n[t] = e;
      }
      function Zr(n, t) {
        for (var e = -1, r = t.length, s = d2(r), o2 = n == null; ++e < r; ) s[e] = o2 ? i : Si(n, t[e]);
        return s;
      }
      function vt(n, t, e) {
        return n === n && (e !== i && (n = n <= e ? n : e), t !== i && (n = n >= t ? n : t)), n;
      }
      function An(n, t, e, r, s, o2) {
        var f2, c2 = t & Ln, l2 = t & Fn, v4 = t & xt;
        if (e && (f2 = s ? e(n, r, s, o2) : e(n)), f2 !== i) return f2;
        if (!K(n)) return n;
        var _2 = O3(n);
        if (_2) {
          if (f2 = uh2(n), !c2) return un(n, f2);
        } else {
          var m4 = tn(n), P2 = m4 == Pe2 || m4 == zi;
          if (at(n)) return lu2(n, c2);
          if (m4 == qn || m4 == Ot || P2 && !s) {
            if (f2 = l2 || P2 ? {} : Tu(n), !c2) return l2 ? Xc(n, mc(f2, n)) : Jc(n, Bs(f2, n));
          } else {
            if (!q3[m4]) return s ? n : {};
            f2 = ah(n, m4, c2);
          }
        }
        o2 || (o2 = new Rn());
        var I = o2.get(n);
        if (I) return I;
        o2.set(n, f2), ua(n) ? n.forEach(function(y2) {
          f2.add(An(y2, t, e, y2, n, o2));
        }) : ia(n) && n.forEach(function(y2, N2) {
          f2.set(N2, An(y2, t, e, N2, n, o2));
        });
        var E4 = v4 ? l2 ? pi : li : l2 ? on : V2, T3 = _2 ? i : E4(n);
        return mn(T3 || n, function(y2, N2) {
          T3 && (N2 = y2, y2 = n[N2]), se2(f2, N2, An(y2, t, e, N2, n, o2));
        }), f2;
      }
      function wc(n) {
        var t = V2(n);
        return function(e) {
          return Gs(e, n, t);
        };
      }
      function Gs(n, t, e) {
        var r = e.length;
        if (n == null) return !r;
        for (n = M2(n); r--; ) {
          var s = e[r], o2 = t[s], f2 = n[s];
          if (f2 === i && !(s in n) || !o2(f2)) return false;
        }
        return true;
      }
      function zs(n, t, e) {
        if (typeof n != "function") throw new wn(D2);
        return le(function() {
          n.apply(i, e);
        }, t);
      }
      function ue(n, t, e, r) {
        var s = -1, o2 = Ee2, f2 = true, c2 = n.length, l2 = [], v4 = t.length;
        if (!c2) return l2;
        e && (t = G(t, hn(e))), r ? (o2 = Dr, f2 = false) : t.length >= w3 && (o2 = jt, f2 = false, t = new gt(t));
        n: for (; ++s < c2; ) {
          var _2 = n[s], m4 = e == null ? _2 : e(_2);
          if (_2 = r || _2 !== 0 ? _2 : 0, f2 && m4 === m4) {
            for (var P2 = v4; P2--; ) if (t[P2] === m4) continue n;
            l2.push(_2);
          } else o2(t, m4, r) || l2.push(_2);
        }
        return l2;
      }
      var rt = _u($n), Ks = _u(Xr, true);
      function Pc(n, t) {
        var e = true;
        return rt(n, function(r, s, o2) {
          return e = !!t(r, s, o2), e;
        }), e;
      }
      function Ge2(n, t, e) {
        for (var r = -1, s = n.length; ++r < s; ) {
          var o2 = n[r], f2 = t(o2);
          if (f2 != null && (c2 === i ? f2 === f2 && !pn(f2) : e(f2, c2))) var c2 = f2, l2 = o2;
        }
        return l2;
      }
      function Ac(n, t, e, r) {
        var s = n.length;
        for (e = R(e), e < 0 && (e = -e > s ? 0 : s + e), r = r === i || r > s ? s : R(r), r < 0 && (r += s), r = e > r ? 0 : oa(r); e < r; ) n[e++] = t;
        return n;
      }
      function Ys(n, t) {
        var e = [];
        return rt(n, function(r, s, o2) {
          t(r, s, o2) && e.push(r);
        }), e;
      }
      function j3(n, t, e, r, s) {
        var o2 = -1, f2 = n.length;
        for (e || (e = fh2), s || (s = []); ++o2 < f2; ) {
          var c2 = n[o2];
          t > 0 && e(c2) ? t > 1 ? j3(c2, t - 1, e, r, s) : nt(s, c2) : r || (s[s.length] = c2);
        }
        return s;
      }
      var Jr = mu(), Zs = mu(true);
      function $n(n, t) {
        return n && Jr(n, t, V2);
      }
      function Xr(n, t) {
        return n && Zs(n, t, V2);
      }
      function ze2(n, t) {
        return jn(t, function(e) {
          return Jn(n[e]);
        });
      }
      function _t(n, t) {
        t = st(t, n);
        for (var e = 0, r = t.length; n != null && e < r; ) n = n[Wn(t[e++])];
        return e && e == r ? n : i;
      }
      function Js(n, t, e) {
        var r = t(n);
        return O3(n) ? r : nt(r, e(n));
      }
      function en(n) {
        return n == null ? n === i ? Ja : Ya : pt && pt in M2(n) ? rh2(n) : vh(n);
      }
      function Qr2(n, t) {
        return n > t;
      }
      function Cc(n, t) {
        return n != null && F2.call(n, t);
      }
      function Ic(n, t) {
        return n != null && t in M2(n);
      }
      function xc(n, t, e) {
        return n >= nn(t, e) && n < Q2(t, e);
      }
      function Vr(n, t, e) {
        for (var r = e ? Dr : Ee2, s = n[0].length, o2 = n.length, f2 = o2, c2 = d2(o2), l2 = 1 / 0, v4 = []; f2--; ) {
          var _2 = n[f2];
          f2 && t && (_2 = G(_2, hn(t))), l2 = nn(_2.length, l2), c2[f2] = !e && (t || s >= 120 && _2.length >= 120) ? new gt(f2 && _2) : i;
        }
        _2 = n[0];
        var m4 = -1, P2 = c2[0];
        n: for (; ++m4 < s && v4.length < l2; ) {
          var I = _2[m4], E4 = t ? t(I) : I;
          if (I = e || I !== 0 ? I : 0, !(P2 ? jt(P2, E4) : r(v4, E4, e))) {
            for (f2 = o2; --f2; ) {
              var T3 = c2[f2];
              if (!(T3 ? jt(T3, E4) : r(n[f2], E4, e))) continue n;
            }
            P2 && P2.push(E4), v4.push(I);
          }
        }
        return v4;
      }
      function Ec(n, t, e, r) {
        return $n(n, function(s, o2, f2) {
          t(r, e(s), o2, f2);
        }), r;
      }
      function ae(n, t, e) {
        t = st(t, n), n = Hu(n, t);
        var r = n == null ? n : n[Wn(In(t))];
        return r == null ? i : cn(r, n, e);
      }
      function Xs(n) {
        return Y(n) && en(n) == Ot;
      }
      function yc(n) {
        return Y(n) && en(n) == kt;
      }
      function Sc(n) {
        return Y(n) && en(n) == Zt2;
      }
      function oe(n, t, e, r, s) {
        return n === t ? true : n == null || t == null || !Y(n) && !Y(t) ? n !== n && t !== t : Oc(n, t, e, r, oe, s);
      }
      function Oc(n, t, e, r, s, o2) {
        var f2 = O3(n), c2 = O3(t), l2 = f2 ? me : tn(n), v4 = c2 ? me : tn(t);
        l2 = l2 == Ot ? qn : l2, v4 = v4 == Ot ? qn : v4;
        var _2 = l2 == qn, m4 = v4 == qn, P2 = l2 == v4;
        if (P2 && at(n)) {
          if (!at(t)) return false;
          f2 = true, _2 = false;
        }
        if (P2 && !_2) return o2 || (o2 = new Rn()), f2 || Bt2(n) ? Ou(n, t, e, r, s, o2) : th2(n, t, l2, e, r, s, o2);
        if (!(e & Et)) {
          var I = _2 && F2.call(n, "__wrapped__"), E4 = m4 && F2.call(t, "__wrapped__");
          if (I || E4) {
            var T3 = I ? n.value() : n, y2 = E4 ? t.value() : t;
            return o2 || (o2 = new Rn()), s(T3, y2, e, r, o2);
          }
        }
        return P2 ? (o2 || (o2 = new Rn()), eh2(n, t, e, r, s, o2)) : false;
      }
      function Rc(n) {
        return Y(n) && tn(n) == yn;
      }
      function kr(n, t, e, r) {
        var s = e.length, o2 = s, f2 = !r;
        if (n == null) return !o2;
        for (n = M2(n); s--; ) {
          var c2 = e[s];
          if (f2 && c2[2] ? c2[1] !== n[c2[0]] : !(c2[0] in n)) return false;
        }
        for (; ++s < o2; ) {
          c2 = e[s];
          var l2 = c2[0], v4 = n[l2], _2 = c2[1];
          if (f2 && c2[2]) {
            if (v4 === i && !(l2 in n)) return false;
          } else {
            var m4 = new Rn();
            if (r) var P2 = r(v4, _2, l2, n, t, m4);
            if (!(P2 === i ? oe(_2, v4, Et | ve, r, m4) : P2)) return false;
          }
        }
        return true;
      }
      function Qs(n) {
        if (!K(n) || hh(n)) return false;
        var t = Jn(n) ? Rf : mo;
        return t.test(wt(n));
      }
      function bc(n) {
        return Y(n) && en(n) == Xt2;
      }
      function Tc(n) {
        return Y(n) && tn(n) == Sn;
      }
      function Lc(n) {
        return Y(n) && ar(n.length) && !!B[en(n)];
      }
      function Vs(n) {
        return typeof n == "function" ? n : n == null ? fn : typeof n == "object" ? O3(n) ? nu(n[0], n[1]) : js(n) : wa(n);
      }
      function jr(n) {
        if (!he(n)) return Hf(n);
        var t = [];
        for (var e in M2(n)) F2.call(n, e) && e != "constructor" && t.push(e);
        return t;
      }
      function Dc(n) {
        if (!K(n)) return gh(n);
        var t = he(n), e = [];
        for (var r in n) r == "constructor" && (t || !F2.call(n, r)) || e.push(r);
        return e;
      }
      function ni(n, t) {
        return n < t;
      }
      function ks(n, t) {
        var e = -1, r = an(n) ? d2(n.length) : [];
        return rt(n, function(s, o2, f2) {
          r[++e] = t(s, o2, f2);
        }), r;
      }
      function js(n) {
        var t = gi(n);
        return t.length == 1 && t[0][2] ? Du(t[0][0], t[0][1]) : function(e) {
          return e === n || kr(e, n, t);
        };
      }
      function nu(n, t) {
        return _i(n) && Lu(t) ? Du(Wn(n), t) : function(e) {
          var r = Si(e, n);
          return r === i && r === t ? Oi(e, n) : oe(t, r, Et | ve);
        };
      }
      function Ke2(n, t, e, r, s) {
        n !== t && Jr(t, function(o2, f2) {
          if (s || (s = new Rn()), K(o2)) Nc(n, t, f2, e, Ke2, r, s);
          else {
            var c2 = r ? r(wi(n, f2), o2, f2 + "", n, t, s) : i;
            c2 === i && (c2 = o2), Yr2(n, f2, c2);
          }
        }, on);
      }
      function Nc(n, t, e, r, s, o2, f2) {
        var c2 = wi(n, e), l2 = wi(t, e), v4 = f2.get(l2);
        if (v4) {
          Yr2(n, e, v4);
          return;
        }
        var _2 = o2 ? o2(c2, l2, e + "", n, t, f2) : i, m4 = _2 === i;
        if (m4) {
          var P2 = O3(l2), I = !P2 && at(l2), E4 = !P2 && !I && Bt2(l2);
          _2 = l2, P2 || I || E4 ? O3(c2) ? _2 = c2 : Z(c2) ? _2 = un(c2) : I ? (m4 = false, _2 = lu2(l2, true)) : E4 ? (m4 = false, _2 = pu2(l2, true)) : _2 = [] : pe(l2) || Pt(l2) ? (_2 = c2, Pt(c2) ? _2 = fa(c2) : (!K(c2) || Jn(c2)) && (_2 = Tu(l2))) : m4 = false;
        }
        m4 && (f2.set(l2, _2), s(_2, l2, r, o2, f2), f2.delete(l2)), Yr2(n, e, _2);
      }
      function tu(n, t) {
        var e = n.length;
        if (e) return t += t < 0 ? e : 0, Zn(t, e) ? n[t] : i;
      }
      function eu(n, t, e) {
        t.length ? t = G(t, function(o2) {
          return O3(o2) ? function(f2) {
            return _t(f2, o2.length === 1 ? o2[0] : o2);
          } : o2;
        }) : t = [fn];
        var r = -1;
        t = G(t, hn(x2()));
        var s = ks(n, function(o2, f2, c2) {
          var l2 = G(t, function(v4) {
            return v4(o2);
          });
          return { criteria: l2, index: ++r, value: o2 };
        });
        return af(s, function(o2, f2) {
          return Zc(o2, f2, e);
        });
      }
      function Hc(n, t) {
        return ru(n, t, function(e, r) {
          return Oi(n, r);
        });
      }
      function ru(n, t, e) {
        for (var r = -1, s = t.length, o2 = {}; ++r < s; ) {
          var f2 = t[r], c2 = _t(n, f2);
          e(c2, f2) && fe(o2, st(f2, n), c2);
        }
        return o2;
      }
      function $c(n) {
        return function(t) {
          return _t(t, n);
        };
      }
      function ti(n, t, e, r) {
        var s = r ? uf : Tt, o2 = -1, f2 = t.length, c2 = n;
        for (n === t && (t = un(t)), e && (c2 = G(n, hn(e))); ++o2 < f2; ) for (var l2 = 0, v4 = t[o2], _2 = e ? e(v4) : v4; (l2 = s(c2, _2, l2, r)) > -1; ) c2 !== n && He2.call(c2, l2, 1), He2.call(n, l2, 1);
        return n;
      }
      function iu(n, t) {
        for (var e = n ? t.length : 0, r = e - 1; e--; ) {
          var s = t[e];
          if (e == r || s !== o2) {
            var o2 = s;
            Zn(s) ? He2.call(n, s, 1) : si(n, s);
          }
        }
        return n;
      }
      function ei(n, t) {
        return n + We2(Ws() * (t - n + 1));
      }
      function Uc(n, t, e, r) {
        for (var s = -1, o2 = Q2(Ue2((t - n) / (e || 1)), 0), f2 = d2(o2); o2--; ) f2[r ? o2 : ++s] = n, n += e;
        return f2;
      }
      function ri(n, t) {
        var e = "";
        if (!n || t < 1 || t > kn) return e;
        do
          t % 2 && (e += n), t = We2(t / 2), t && (n += n);
        while (t);
        return e;
      }
      function L4(n, t) {
        return Pi(Nu(n, t, fn), n + "");
      }
      function Wc(n) {
        return qs(Gt2(n));
      }
      function Fc(n, t) {
        var e = Gt2(n);
        return tr2(e, vt(t, 0, e.length));
      }
      function fe(n, t, e, r) {
        if (!K(n)) return n;
        t = st(t, n);
        for (var s = -1, o2 = t.length, f2 = o2 - 1, c2 = n; c2 != null && ++s < o2; ) {
          var l2 = Wn(t[s]), v4 = e;
          if (l2 === "__proto__" || l2 === "constructor" || l2 === "prototype") return n;
          if (s != f2) {
            var _2 = c2[l2];
            v4 = r ? r(_2, l2, c2) : i, v4 === i && (v4 = K(_2) ? _2 : Zn(t[s + 1]) ? [] : {});
          }
          se2(c2, l2, v4), c2 = c2[l2];
        }
        return n;
      }
      var su = Fe2 ? function(n, t) {
        return Fe2.set(n, t), n;
      } : fn, Mc = $e2 ? function(n, t) {
        return $e2(n, "toString", { configurable: true, enumerable: false, value: bi(t), writable: true });
      } : fn;
      function qc(n) {
        return tr2(Gt2(n));
      }
      function Cn(n, t, e) {
        var r = -1, s = n.length;
        t < 0 && (t = -t > s ? 0 : s + t), e = e > s ? s : e, e < 0 && (e += s), s = t > e ? 0 : e - t >>> 0, t >>>= 0;
        for (var o2 = d2(s); ++r < s; ) o2[r] = n[r + t];
        return o2;
      }
      function Bc(n, t) {
        var e;
        return rt(n, function(r, s, o2) {
          return e = t(r, s, o2), !e;
        }), !!e;
      }
      function Ye2(n, t, e) {
        var r = 0, s = n == null ? r : n.length;
        if (typeof t == "number" && t === t && s <= Ba) {
          for (; r < s; ) {
            var o2 = r + s >>> 1, f2 = n[o2];
            f2 !== null && !pn(f2) && (e ? f2 <= t : f2 < t) ? r = o2 + 1 : s = o2;
          }
          return s;
        }
        return ii(n, t, fn, e);
      }
      function ii(n, t, e, r) {
        var s = 0, o2 = n == null ? 0 : n.length;
        if (o2 === 0) return 0;
        t = e(t);
        for (var f2 = t !== t, c2 = t === null, l2 = pn(t), v4 = t === i; s < o2; ) {
          var _2 = We2((s + o2) / 2), m4 = e(n[_2]), P2 = m4 !== i, I = m4 === null, E4 = m4 === m4, T3 = pn(m4);
          if (f2) var y2 = r || E4;
          else v4 ? y2 = E4 && (r || P2) : c2 ? y2 = E4 && P2 && (r || !I) : l2 ? y2 = E4 && P2 && !I && (r || !T3) : I || T3 ? y2 = false : y2 = r ? m4 <= t : m4 < t;
          y2 ? s = _2 + 1 : o2 = _2;
        }
        return nn(o2, qa);
      }
      function uu(n, t) {
        for (var e = -1, r = n.length, s = 0, o2 = []; ++e < r; ) {
          var f2 = n[e], c2 = t ? t(f2) : f2;
          if (!e || !bn(c2, l2)) {
            var l2 = c2;
            o2[s++] = f2 === 0 ? 0 : f2;
          }
        }
        return o2;
      }
      function au(n) {
        return typeof n == "number" ? n : pn(n) ? _e2 : +n;
      }
      function ln(n) {
        if (typeof n == "string") return n;
        if (O3(n)) return G(n, ln) + "";
        if (pn(n)) return Fs ? Fs.call(n) : "";
        var t = n + "";
        return t == "0" && 1 / n == -ht ? "-0" : t;
      }
      function it(n, t, e) {
        var r = -1, s = Ee2, o2 = n.length, f2 = true, c2 = [], l2 = c2;
        if (e) f2 = false, s = Dr;
        else if (o2 >= w3) {
          var v4 = t ? null : jc(n);
          if (v4) return Se2(v4);
          f2 = false, s = jt, l2 = new gt();
        } else l2 = t ? [] : c2;
        n: for (; ++r < o2; ) {
          var _2 = n[r], m4 = t ? t(_2) : _2;
          if (_2 = e || _2 !== 0 ? _2 : 0, f2 && m4 === m4) {
            for (var P2 = l2.length; P2--; ) if (l2[P2] === m4) continue n;
            t && l2.push(m4), c2.push(_2);
          } else s(l2, m4, e) || (l2 !== c2 && l2.push(m4), c2.push(_2));
        }
        return c2;
      }
      function si(n, t) {
        return t = st(t, n), n = Hu(n, t), n == null || delete n[Wn(In(t))];
      }
      function ou2(n, t, e, r) {
        return fe(n, t, e(_t(n, t)), r);
      }
      function Ze(n, t, e, r) {
        for (var s = n.length, o2 = r ? s : -1; (r ? o2-- : ++o2 < s) && t(n[o2], o2, n); ) ;
        return e ? Cn(n, r ? 0 : o2, r ? o2 + 1 : s) : Cn(n, r ? o2 + 1 : 0, r ? s : o2);
      }
      function fu2(n, t) {
        var e = n;
        return e instanceof H && (e = e.value()), Nr(t, function(r, s) {
          return s.func.apply(s.thisArg, nt([r], s.args));
        }, e);
      }
      function ui(n, t, e) {
        var r = n.length;
        if (r < 2) return r ? it(n[0]) : [];
        for (var s = -1, o2 = d2(r); ++s < r; ) for (var f2 = n[s], c2 = -1; ++c2 < r; ) c2 != s && (o2[s] = ue(o2[s] || f2, n[c2], t, e));
        return it(j3(o2, 1), t, e);
      }
      function cu2(n, t, e) {
        for (var r = -1, s = n.length, o2 = t.length, f2 = {}; ++r < s; ) {
          var c2 = r < o2 ? t[r] : i;
          e(f2, n[r], c2);
        }
        return f2;
      }
      function ai(n) {
        return Z(n) ? n : [];
      }
      function oi(n) {
        return typeof n == "function" ? n : fn;
      }
      function st(n, t) {
        return O3(n) ? n : _i(n, t) ? [n] : Fu(W(n));
      }
      var Gc = L4;
      function ut(n, t, e) {
        var r = n.length;
        return e = e === i ? r : e, !t && e >= r ? n : Cn(n, t, e);
      }
      var hu = bf || function(n) {
        return k3.clearTimeout(n);
      };
      function lu2(n, t) {
        if (t) return n.slice();
        var e = n.length, r = Ds ? Ds(e) : new n.constructor(e);
        return n.copy(r), r;
      }
      function fi(n) {
        var t = new n.constructor(n.byteLength);
        return new De(t).set(new De(n)), t;
      }
      function zc(n, t) {
        var e = t ? fi(n.buffer) : n.buffer;
        return new n.constructor(e, n.byteOffset, n.byteLength);
      }
      function Kc(n) {
        var t = new n.constructor(n.source, Xi.exec(n));
        return t.lastIndex = n.lastIndex, t;
      }
      function Yc(n) {
        return ie2 ? M2(ie2.call(n)) : {};
      }
      function pu2(n, t) {
        var e = t ? fi(n.buffer) : n.buffer;
        return new n.constructor(e, n.byteOffset, n.length);
      }
      function du2(n, t) {
        if (n !== t) {
          var e = n !== i, r = n === null, s = n === n, o2 = pn(n), f2 = t !== i, c2 = t === null, l2 = t === t, v4 = pn(t);
          if (!c2 && !v4 && !o2 && n > t || o2 && f2 && l2 && !c2 && !v4 || r && f2 && l2 || !e && l2 || !s) return 1;
          if (!r && !o2 && !v4 && n < t || v4 && e && s && !r && !o2 || c2 && e && s || !f2 && s || !l2) return -1;
        }
        return 0;
      }
      function Zc(n, t, e) {
        for (var r = -1, s = n.criteria, o2 = t.criteria, f2 = s.length, c2 = e.length; ++r < f2; ) {
          var l2 = du2(s[r], o2[r]);
          if (l2) {
            if (r >= c2) return l2;
            var v4 = e[r];
            return l2 * (v4 == "desc" ? -1 : 1);
          }
        }
        return n.index - t.index;
      }
      function gu(n, t, e, r) {
        for (var s = -1, o2 = n.length, f2 = e.length, c2 = -1, l2 = t.length, v4 = Q2(o2 - f2, 0), _2 = d2(l2 + v4), m4 = !r; ++c2 < l2; ) _2[c2] = t[c2];
        for (; ++s < f2; ) (m4 || s < o2) && (_2[e[s]] = n[s]);
        for (; v4--; ) _2[c2++] = n[s++];
        return _2;
      }
      function vu(n, t, e, r) {
        for (var s = -1, o2 = n.length, f2 = -1, c2 = e.length, l2 = -1, v4 = t.length, _2 = Q2(o2 - c2, 0), m4 = d2(_2 + v4), P2 = !r; ++s < _2; ) m4[s] = n[s];
        for (var I = s; ++l2 < v4; ) m4[I + l2] = t[l2];
        for (; ++f2 < c2; ) (P2 || s < o2) && (m4[I + e[f2]] = n[s++]);
        return m4;
      }
      function un(n, t) {
        var e = -1, r = n.length;
        for (t || (t = d2(r)); ++e < r; ) t[e] = n[e];
        return t;
      }
      function Un(n, t, e, r) {
        var s = !e;
        e || (e = {});
        for (var o2 = -1, f2 = t.length; ++o2 < f2; ) {
          var c2 = t[o2], l2 = r ? r(e[c2], n[c2], c2, e, n) : i;
          l2 === i && (l2 = n[c2]), s ? zn(e, c2, l2) : se2(e, c2, l2);
        }
        return e;
      }
      function Jc(n, t) {
        return Un(n, vi(n), t);
      }
      function Xc(n, t) {
        return Un(n, Ru(n), t);
      }
      function Je2(n, t) {
        return function(e, r) {
          var s = O3(e) ? jo : _c, o2 = t ? t() : {};
          return s(e, n, x2(r, 2), o2);
        };
      }
      function Ft(n) {
        return L4(function(t, e) {
          var r = -1, s = e.length, o2 = s > 1 ? e[s - 1] : i, f2 = s > 2 ? e[2] : i;
          for (o2 = n.length > 3 && typeof o2 == "function" ? (s--, o2) : i, f2 && rn(e[0], e[1], f2) && (o2 = s < 3 ? i : o2, s = 1), t = M2(t); ++r < s; ) {
            var c2 = e[r];
            c2 && n(t, c2, r, o2);
          }
          return t;
        });
      }
      function _u(n, t) {
        return function(e, r) {
          if (e == null) return e;
          if (!an(e)) return n(e, r);
          for (var s = e.length, o2 = t ? s : -1, f2 = M2(e); (t ? o2-- : ++o2 < s) && r(f2[o2], o2, f2) !== false; ) ;
          return e;
        };
      }
      function mu(n) {
        return function(t, e, r) {
          for (var s = -1, o2 = M2(t), f2 = r(t), c2 = f2.length; c2--; ) {
            var l2 = f2[n ? c2 : ++s];
            if (e(o2[l2], l2, o2) === false) break;
          }
          return t;
        };
      }
      function Qc(n, t, e) {
        var r = t & vn, s = ce(n);
        function o2() {
          var f2 = this && this !== k3 && this instanceof o2 ? s : n;
          return f2.apply(r ? e : this, arguments);
        }
        return o2;
      }
      function wu(n) {
        return function(t) {
          t = W(t);
          var e = Lt(t) ? On(t) : i, r = e ? e[0] : t.charAt(0), s = e ? ut(e, 1).join("") : t.slice(1);
          return r[n]() + s;
        };
      }
      function Mt(n) {
        return function(t) {
          return Nr(_a(va(t).replace(Fo, "")), n, "");
        };
      }
      function ce(n) {
        return function() {
          var t = arguments;
          switch (t.length) {
            case 0:
              return new n();
            case 1:
              return new n(t[0]);
            case 2:
              return new n(t[0], t[1]);
            case 3:
              return new n(t[0], t[1], t[2]);
            case 4:
              return new n(t[0], t[1], t[2], t[3]);
            case 5:
              return new n(t[0], t[1], t[2], t[3], t[4]);
            case 6:
              return new n(t[0], t[1], t[2], t[3], t[4], t[5]);
            case 7:
              return new n(t[0], t[1], t[2], t[3], t[4], t[5], t[6]);
          }
          var e = Wt2(n.prototype), r = n.apply(e, t);
          return K(r) ? r : e;
        };
      }
      function Vc(n, t, e) {
        var r = ce(n);
        function s() {
          for (var o2 = arguments.length, f2 = d2(o2), c2 = o2, l2 = qt(s); c2--; ) f2[c2] = arguments[c2];
          var v4 = o2 < 3 && f2[0] !== l2 && f2[o2 - 1] !== l2 ? [] : tt(f2, l2);
          if (o2 -= v4.length, o2 < e) return xu(n, t, Xe2, s.placeholder, i, f2, v4, i, i, e - o2);
          var _2 = this && this !== k3 && this instanceof s ? r : n;
          return cn(_2, this, f2);
        }
        return s;
      }
      function Pu(n) {
        return function(t, e, r) {
          var s = M2(t);
          if (!an(t)) {
            var o2 = x2(e, 3);
            t = V2(t), e = function(c2) {
              return o2(s[c2], c2, s);
            };
          }
          var f2 = n(t, e, r);
          return f2 > -1 ? s[o2 ? t[f2] : f2] : i;
        };
      }
      function Au(n) {
        return Yn(function(t) {
          var e = t.length, r = e, s = Pn.prototype.thru;
          for (n && t.reverse(); r--; ) {
            var o2 = t[r];
            if (typeof o2 != "function") throw new wn(D2);
            if (s && !f2 && je2(o2) == "wrapper") var f2 = new Pn([], true);
          }
          for (r = f2 ? r : e; ++r < e; ) {
            o2 = t[r];
            var c2 = je2(o2), l2 = c2 == "wrapper" ? di(o2) : i;
            l2 && mi(l2[0]) && l2[1] == (Mn | Dn | Nn | Kt) && !l2[4].length && l2[9] == 1 ? f2 = f2[je2(l2[0])].apply(f2, l2[3]) : f2 = o2.length == 1 && mi(o2) ? f2[c2]() : f2.thru(o2);
          }
          return function() {
            var v4 = arguments, _2 = v4[0];
            if (f2 && v4.length == 1 && O3(_2)) return f2.plant(_2).value();
            for (var m4 = 0, P2 = e ? t[m4].apply(this, v4) : _2; ++m4 < e; ) P2 = t[m4].call(this, P2);
            return P2;
          };
        });
      }
      function Xe2(n, t, e, r, s, o2, f2, c2, l2, v4) {
        var _2 = t & Mn, m4 = t & vn, P2 = t & ct, I = t & (Dn | yt), E4 = t & dr, T3 = P2 ? i : ce(n);
        function y2() {
          for (var N2 = arguments.length, $2 = d2(N2), dn2 = N2; dn2--; ) $2[dn2] = arguments[dn2];
          if (I) var sn = qt(y2), gn = ff($2, sn);
          if (r && ($2 = gu($2, r, s, I)), o2 && ($2 = vu($2, o2, f2, I)), N2 -= gn, I && N2 < v4) {
            var J2 = tt($2, sn);
            return xu(n, t, Xe2, y2.placeholder, e, $2, J2, c2, l2, v4 - N2);
          }
          var Tn = m4 ? e : this, Qn = P2 ? Tn[n] : n;
          return N2 = $2.length, c2 ? $2 = _h($2, c2) : E4 && N2 > 1 && $2.reverse(), _2 && l2 < N2 && ($2.length = l2), this && this !== k3 && this instanceof y2 && (Qn = T3 || ce(Qn)), Qn.apply(Tn, $2);
        }
        return y2;
      }
      function Cu(n, t) {
        return function(e, r) {
          return Ec(e, n, t(r), {});
        };
      }
      function Qe2(n, t) {
        return function(e, r) {
          var s;
          if (e === i && r === i) return t;
          if (e !== i && (s = e), r !== i) {
            if (s === i) return r;
            typeof e == "string" || typeof r == "string" ? (e = ln(e), r = ln(r)) : (e = au(e), r = au(r)), s = n(e, r);
          }
          return s;
        };
      }
      function ci(n) {
        return Yn(function(t) {
          return t = G(t, hn(x2())), L4(function(e) {
            var r = this;
            return n(t, function(s) {
              return cn(s, r, e);
            });
          });
        });
      }
      function Ve(n, t) {
        t = t === i ? " " : ln(t);
        var e = t.length;
        if (e < 2) return e ? ri(t, n) : t;
        var r = ri(t, Ue2(n / Dt(t)));
        return Lt(t) ? ut(On(r), 0, n).join("") : r.slice(0, n);
      }
      function kc(n, t, e, r) {
        var s = t & vn, o2 = ce(n);
        function f2() {
          for (var c2 = -1, l2 = arguments.length, v4 = -1, _2 = r.length, m4 = d2(_2 + l2), P2 = this && this !== k3 && this instanceof f2 ? o2 : n; ++v4 < _2; ) m4[v4] = r[v4];
          for (; l2--; ) m4[v4++] = arguments[++c2];
          return cn(P2, s ? e : this, m4);
        }
        return f2;
      }
      function Iu(n) {
        return function(t, e, r) {
          return r && typeof r != "number" && rn(t, e, r) && (e = r = i), t = Xn(t), e === i ? (e = t, t = 0) : e = Xn(e), r = r === i ? t < e ? 1 : -1 : Xn(r), Uc(t, e, r, n);
        };
      }
      function ke2(n) {
        return function(t, e) {
          return typeof t == "string" && typeof e == "string" || (t = xn(t), e = xn(e)), n(t, e);
        };
      }
      function xu(n, t, e, r, s, o2, f2, c2, l2, v4) {
        var _2 = t & Dn, m4 = _2 ? f2 : i, P2 = _2 ? i : f2, I = _2 ? o2 : i, E4 = _2 ? i : o2;
        t |= _2 ? Nn : St, t &= ~(_2 ? St : Nn), t & Bi || (t &= ~(vn | ct));
        var T3 = [n, t, s, I, m4, E4, P2, c2, l2, v4], y2 = e.apply(i, T3);
        return mi(n) && $u2(y2, T3), y2.placeholder = r, Uu(y2, n, t);
      }
      function hi(n) {
        var t = X2[n];
        return function(e, r) {
          if (e = xn(e), r = r == null ? 0 : nn(R(r), 292), r && Us(e)) {
            var s = (W(e) + "e").split("e"), o2 = t(s[0] + "e" + (+s[1] + r));
            return s = (W(o2) + "e").split("e"), +(s[0] + "e" + (+s[1] - r));
          }
          return t(e);
        };
      }
      var jc = $t && 1 / Se2(new $t([, -0]))[1] == ht ? function(n) {
        return new $t(n);
      } : Di;
      function Eu(n) {
        return function(t) {
          var e = tn(t);
          return e == yn ? qr(t) : e == Sn ? vf(t) : of(t, n(t));
        };
      }
      function Kn(n, t, e, r, s, o2, f2, c2) {
        var l2 = t & ct;
        if (!l2 && typeof n != "function") throw new wn(D2);
        var v4 = r ? r.length : 0;
        if (v4 || (t &= ~(Nn | St), r = s = i), f2 = f2 === i ? f2 : Q2(R(f2), 0), c2 = c2 === i ? c2 : R(c2), v4 -= s ? s.length : 0, t & St) {
          var _2 = r, m4 = s;
          r = s = i;
        }
        var P2 = l2 ? i : di(n), I = [n, t, e, r, s, _2, m4, o2, f2, c2];
        if (P2 && dh(I, P2), n = I[0], t = I[1], e = I[2], r = I[3], s = I[4], c2 = I[9] = I[9] === i ? l2 ? 0 : n.length : Q2(I[9] - v4, 0), !c2 && t & (Dn | yt) && (t &= ~(Dn | yt)), !t || t == vn) var E4 = Qc(n, t, e);
        else t == Dn || t == yt ? E4 = Vc(n, t, c2) : (t == Nn || t == (vn | Nn)) && !s.length ? E4 = kc(n, t, e, r) : E4 = Xe2.apply(i, I);
        var T3 = P2 ? su : $u2;
        return Uu(T3(E4, I), n, t);
      }
      function yu2(n, t, e, r) {
        return n === i || bn(n, Ht2[e]) && !F2.call(r, e) ? t : n;
      }
      function Su(n, t, e, r, s, o2) {
        return K(n) && K(t) && (o2.set(t, n), Ke2(n, t, i, Su, o2), o2.delete(t)), n;
      }
      function nh2(n) {
        return pe(n) ? i : n;
      }
      function Ou(n, t, e, r, s, o2) {
        var f2 = e & Et, c2 = n.length, l2 = t.length;
        if (c2 != l2 && !(f2 && l2 > c2)) return false;
        var v4 = o2.get(n), _2 = o2.get(t);
        if (v4 && _2) return v4 == t && _2 == n;
        var m4 = -1, P2 = true, I = e & ve ? new gt() : i;
        for (o2.set(n, t), o2.set(t, n); ++m4 < c2; ) {
          var E4 = n[m4], T3 = t[m4];
          if (r) var y2 = f2 ? r(T3, E4, m4, t, n, o2) : r(E4, T3, m4, n, t, o2);
          if (y2 !== i) {
            if (y2) continue;
            P2 = false;
            break;
          }
          if (I) {
            if (!Hr(t, function(N2, $2) {
              if (!jt(I, $2) && (E4 === N2 || s(E4, N2, e, r, o2))) return I.push($2);
            })) {
              P2 = false;
              break;
            }
          } else if (!(E4 === T3 || s(E4, T3, e, r, o2))) {
            P2 = false;
            break;
          }
        }
        return o2.delete(n), o2.delete(t), P2;
      }
      function th2(n, t, e, r, s, o2, f2) {
        switch (e) {
          case Rt:
            if (n.byteLength != t.byteLength || n.byteOffset != t.byteOffset) return false;
            n = n.buffer, t = t.buffer;
          case kt:
            return !(n.byteLength != t.byteLength || !o2(new De(n), new De(t)));
          case Yt2:
          case Zt2:
          case Jt2:
            return bn(+n, +t);
          case we:
            return n.name == t.name && n.message == t.message;
          case Xt2:
          case Qt:
            return n == t + "";
          case yn:
            var c2 = qr;
          case Sn:
            var l2 = r & Et;
            if (c2 || (c2 = Se2), n.size != t.size && !l2) return false;
            var v4 = f2.get(n);
            if (v4) return v4 == t;
            r |= ve, f2.set(n, t);
            var _2 = Ou(c2(n), c2(t), r, s, o2, f2);
            return f2.delete(n), _2;
          case Ae:
            if (ie2) return ie2.call(n) == ie2.call(t);
        }
        return false;
      }
      function eh2(n, t, e, r, s, o2) {
        var f2 = e & Et, c2 = li(n), l2 = c2.length, v4 = li(t), _2 = v4.length;
        if (l2 != _2 && !f2) return false;
        for (var m4 = l2; m4--; ) {
          var P2 = c2[m4];
          if (!(f2 ? P2 in t : F2.call(t, P2))) return false;
        }
        var I = o2.get(n), E4 = o2.get(t);
        if (I && E4) return I == t && E4 == n;
        var T3 = true;
        o2.set(n, t), o2.set(t, n);
        for (var y2 = f2; ++m4 < l2; ) {
          P2 = c2[m4];
          var N2 = n[P2], $2 = t[P2];
          if (r) var dn2 = f2 ? r($2, N2, P2, t, n, o2) : r(N2, $2, P2, n, t, o2);
          if (!(dn2 === i ? N2 === $2 || s(N2, $2, e, r, o2) : dn2)) {
            T3 = false;
            break;
          }
          y2 || (y2 = P2 == "constructor");
        }
        if (T3 && !y2) {
          var sn = n.constructor, gn = t.constructor;
          sn != gn && "constructor" in n && "constructor" in t && !(typeof sn == "function" && sn instanceof sn && typeof gn == "function" && gn instanceof gn) && (T3 = false);
        }
        return o2.delete(n), o2.delete(t), T3;
      }
      function Yn(n) {
        return Pi(Nu(n, i, Gu), n + "");
      }
      function li(n) {
        return Js(n, V2, vi);
      }
      function pi(n) {
        return Js(n, on, Ru);
      }
      var di = Fe2 ? function(n) {
        return Fe2.get(n);
      } : Di;
      function je2(n) {
        for (var t = n.name + "", e = Ut[t], r = F2.call(Ut, t) ? e.length : 0; r--; ) {
          var s = e[r], o2 = s.func;
          if (o2 == null || o2 == n) return s.name;
        }
        return t;
      }
      function qt(n) {
        var t = F2.call(a, "placeholder") ? a : n;
        return t.placeholder;
      }
      function x2() {
        var n = a.iteratee || Ti;
        return n = n === Ti ? Vs : n, arguments.length ? n(arguments[0], arguments[1]) : n;
      }
      function nr(n, t) {
        var e = n.__data__;
        return ch(t) ? e[typeof t == "string" ? "string" : "hash"] : e.map;
      }
      function gi(n) {
        for (var t = V2(n), e = t.length; e--; ) {
          var r = t[e], s = n[r];
          t[e] = [r, s, Lu(s)];
        }
        return t;
      }
      function mt(n, t) {
        var e = pf(n, t);
        return Qs(e) ? e : i;
      }
      function rh2(n) {
        var t = F2.call(n, pt), e = n[pt];
        try {
          n[pt] = i;
          var r = true;
        } catch {
        }
        var s = Te.call(n);
        return r && (t ? n[pt] = e : delete n[pt]), s;
      }
      var vi = Gr ? function(n) {
        return n == null ? [] : (n = M2(n), jn(Gr(n), function(t) {
          return Hs.call(n, t);
        }));
      } : Ni, Ru = Gr ? function(n) {
        for (var t = []; n; ) nt(t, vi(n)), n = Ne(n);
        return t;
      } : Ni, tn = en;
      (zr && tn(new zr(new ArrayBuffer(1))) != Rt || te && tn(new te()) != yn || Kr && tn(Kr.resolve()) != Ki || $t && tn(new $t()) != Sn || ee && tn(new ee()) != Vt3) && (tn = function(n) {
        var t = en(n), e = t == qn ? n.constructor : i, r = e ? wt(e) : "";
        if (r) switch (r) {
          case Ff:
            return Rt;
          case Mf:
            return yn;
          case qf:
            return Ki;
          case Bf:
            return Sn;
          case Gf:
            return Vt3;
        }
        return t;
      });
      function ih2(n, t, e) {
        for (var r = -1, s = e.length; ++r < s; ) {
          var o2 = e[r], f2 = o2.size;
          switch (o2.type) {
            case "drop":
              n += f2;
              break;
            case "dropRight":
              t -= f2;
              break;
            case "take":
              t = nn(t, n + f2);
              break;
            case "takeRight":
              n = Q2(n, t - f2);
              break;
          }
        }
        return { start: n, end: t };
      }
      function sh(n) {
        var t = n.match(fo);
        return t ? t[1].split(co) : [];
      }
      function bu2(n, t, e) {
        t = st(t, n);
        for (var r = -1, s = t.length, o2 = false; ++r < s; ) {
          var f2 = Wn(t[r]);
          if (!(o2 = n != null && e(n, f2))) break;
          n = n[f2];
        }
        return o2 || ++r != s ? o2 : (s = n == null ? 0 : n.length, !!s && ar(s) && Zn(f2, s) && (O3(n) || Pt(n)));
      }
      function uh2(n) {
        var t = n.length, e = new n.constructor(t);
        return t && typeof n[0] == "string" && F2.call(n, "index") && (e.index = n.index, e.input = n.input), e;
      }
      function Tu(n) {
        return typeof n.constructor == "function" && !he(n) ? Wt2(Ne(n)) : {};
      }
      function ah(n, t, e) {
        var r = n.constructor;
        switch (t) {
          case kt:
            return fi(n);
          case Yt2:
          case Zt2:
            return new r(+n);
          case Rt:
            return zc(n, e);
          case gr:
          case vr:
          case _r:
          case mr:
          case wr:
          case Pr:
          case Ar:
          case Cr:
          case Ir:
            return pu2(n, e);
          case yn:
            return new r();
          case Jt2:
          case Qt:
            return new r(n);
          case Xt2:
            return Kc(n);
          case Sn:
            return new r();
          case Ae:
            return Yc(n);
        }
      }
      function oh2(n, t) {
        var e = t.length;
        if (!e) return n;
        var r = e - 1;
        return t[r] = (e > 1 ? "& " : "") + t[r], t = t.join(e > 2 ? ", " : " "), n.replace(oo, `{
/* [wrapped with ` + t + `] */
`);
      }
      function fh2(n) {
        return O3(n) || Pt(n) || !!($s && n && n[$s]);
      }
      function Zn(n, t) {
        var e = typeof n;
        return t = t ?? kn, !!t && (e == "number" || e != "symbol" && Po.test(n)) && n > -1 && n % 1 == 0 && n < t;
      }
      function rn(n, t, e) {
        if (!K(e)) return false;
        var r = typeof t;
        return (r == "number" ? an(e) && Zn(t, e.length) : r == "string" && t in e) ? bn(e[t], n) : false;
      }
      function _i(n, t) {
        if (O3(n)) return false;
        var e = typeof n;
        return e == "number" || e == "symbol" || e == "boolean" || n == null || pn(n) ? true : io.test(n) || !ro.test(n) || t != null && n in M2(t);
      }
      function ch(n) {
        var t = typeof n;
        return t == "string" || t == "number" || t == "symbol" || t == "boolean" ? n !== "__proto__" : n === null;
      }
      function mi(n) {
        var t = je2(n), e = a[t];
        if (typeof e != "function" || !(t in H.prototype)) return false;
        if (n === e) return true;
        var r = di(e);
        return !!r && n === r[0];
      }
      function hh(n) {
        return !!Ls && Ls in n;
      }
      var lh2 = Re2 ? Jn : Hi;
      function he(n) {
        var t = n && n.constructor, e = typeof t == "function" && t.prototype || Ht2;
        return n === e;
      }
      function Lu(n) {
        return n === n && !K(n);
      }
      function Du(n, t) {
        return function(e) {
          return e == null ? false : e[n] === t && (t !== i || n in M2(e));
        };
      }
      function ph(n) {
        var t = sr(n, function(r) {
          return e.size === pr2 && e.clear(), r;
        }), e = t.cache;
        return t;
      }
      function dh(n, t) {
        var e = n[1], r = t[1], s = e | r, o2 = s < (vn | ct | Mn), f2 = r == Mn && e == Dn || r == Mn && e == Kt && n[7].length <= t[8] || r == (Mn | Kt) && t[7].length <= t[8] && e == Dn;
        if (!(o2 || f2)) return n;
        r & vn && (n[2] = t[2], s |= e & vn ? 0 : Bi);
        var c2 = t[3];
        if (c2) {
          var l2 = n[3];
          n[3] = l2 ? gu(l2, c2, t[4]) : c2, n[4] = l2 ? tt(n[3], It) : t[4];
        }
        return c2 = t[5], c2 && (l2 = n[5], n[5] = l2 ? vu(l2, c2, t[6]) : c2, n[6] = l2 ? tt(n[5], It) : t[6]), c2 = t[7], c2 && (n[7] = c2), r & Mn && (n[8] = n[8] == null ? t[8] : nn(n[8], t[8])), n[9] == null && (n[9] = t[9]), n[0] = t[0], n[1] = s, n;
      }
      function gh(n) {
        var t = [];
        if (n != null) for (var e in M2(n)) t.push(e);
        return t;
      }
      function vh(n) {
        return Te.call(n);
      }
      function Nu(n, t, e) {
        return t = Q2(t === i ? n.length - 1 : t, 0), function() {
          for (var r = arguments, s = -1, o2 = Q2(r.length - t, 0), f2 = d2(o2); ++s < o2; ) f2[s] = r[t + s];
          s = -1;
          for (var c2 = d2(t + 1); ++s < t; ) c2[s] = r[s];
          return c2[t] = e(f2), cn(n, this, c2);
        };
      }
      function Hu(n, t) {
        return t.length < 2 ? n : _t(n, Cn(t, 0, -1));
      }
      function _h(n, t) {
        for (var e = n.length, r = nn(t.length, e), s = un(n); r--; ) {
          var o2 = t[r];
          n[r] = Zn(o2, e) ? s[o2] : i;
        }
        return n;
      }
      function wi(n, t) {
        if (!(t === "constructor" && typeof n[t] == "function") && t != "__proto__") return n[t];
      }
      var $u2 = Wu2(su), le = Lf || function(n, t) {
        return k3.setTimeout(n, t);
      }, Pi = Wu2(Mc);
      function Uu(n, t, e) {
        var r = t + "";
        return Pi(n, oh2(r, mh(sh(r), e)));
      }
      function Wu2(n) {
        var t = 0, e = 0;
        return function() {
          var r = $f(), s = Ua - (r - e);
          if (e = r, s > 0) {
            if (++t >= $a) return arguments[0];
          } else t = 0;
          return n.apply(i, arguments);
        };
      }
      function tr2(n, t) {
        var e = -1, r = n.length, s = r - 1;
        for (t = t === i ? r : t; ++e < t; ) {
          var o2 = ei(e, s), f2 = n[o2];
          n[o2] = n[e], n[e] = f2;
        }
        return n.length = t, n;
      }
      var Fu = ph(function(n) {
        var t = [];
        return n.charCodeAt(0) === 46 && t.push(""), n.replace(so, function(e, r, s, o2) {
          t.push(s ? o2.replace(po, "$1") : r || e);
        }), t;
      });
      function Wn(n) {
        if (typeof n == "string" || pn(n)) return n;
        var t = n + "";
        return t == "0" && 1 / n == -ht ? "-0" : t;
      }
      function wt(n) {
        if (n != null) {
          try {
            return be.call(n);
          } catch {
          }
          try {
            return n + "";
          } catch {
          }
        }
        return "";
      }
      function mh(n, t) {
        return mn(Ga, function(e) {
          var r = "_." + e[0];
          t & e[1] && !Ee2(n, r) && n.push(r);
        }), n.sort();
      }
      function Mu(n) {
        if (n instanceof H) return n.clone();
        var t = new Pn(n.__wrapped__, n.__chain__);
        return t.__actions__ = un(n.__actions__), t.__index__ = n.__index__, t.__values__ = n.__values__, t;
      }
      function wh(n, t, e) {
        (e ? rn(n, t, e) : t === i) ? t = 1 : t = Q2(R(t), 0);
        var r = n == null ? 0 : n.length;
        if (!r || t < 1) return [];
        for (var s = 0, o2 = 0, f2 = d2(Ue2(r / t)); s < r; ) f2[o2++] = Cn(n, s, s += t);
        return f2;
      }
      function Ph(n) {
        for (var t = -1, e = n == null ? 0 : n.length, r = 0, s = []; ++t < e; ) {
          var o2 = n[t];
          o2 && (s[r++] = o2);
        }
        return s;
      }
      function Ah() {
        var n = arguments.length;
        if (!n) return [];
        for (var t = d2(n - 1), e = arguments[0], r = n; r--; ) t[r - 1] = arguments[r];
        return nt(O3(e) ? un(e) : [e], j3(t, 1));
      }
      var Ch = L4(function(n, t) {
        return Z(n) ? ue(n, j3(t, 1, Z, true)) : [];
      }), Ih = L4(function(n, t) {
        var e = In(t);
        return Z(e) && (e = i), Z(n) ? ue(n, j3(t, 1, Z, true), x2(e, 2)) : [];
      }), xh = L4(function(n, t) {
        var e = In(t);
        return Z(e) && (e = i), Z(n) ? ue(n, j3(t, 1, Z, true), i, e) : [];
      });
      function Eh(n, t, e) {
        var r = n == null ? 0 : n.length;
        return r ? (t = e || t === i ? 1 : R(t), Cn(n, t < 0 ? 0 : t, r)) : [];
      }
      function yh(n, t, e) {
        var r = n == null ? 0 : n.length;
        return r ? (t = e || t === i ? 1 : R(t), t = r - t, Cn(n, 0, t < 0 ? 0 : t)) : [];
      }
      function Sh(n, t) {
        return n && n.length ? Ze(n, x2(t, 3), true, true) : [];
      }
      function Oh(n, t) {
        return n && n.length ? Ze(n, x2(t, 3), true) : [];
      }
      function Rh(n, t, e, r) {
        var s = n == null ? 0 : n.length;
        return s ? (e && typeof e != "number" && rn(n, t, e) && (e = 0, r = s), Ac(n, t, e, r)) : [];
      }
      function qu(n, t, e) {
        var r = n == null ? 0 : n.length;
        if (!r) return -1;
        var s = e == null ? 0 : R(e);
        return s < 0 && (s = Q2(r + s, 0)), ye(n, x2(t, 3), s);
      }
      function Bu(n, t, e) {
        var r = n == null ? 0 : n.length;
        if (!r) return -1;
        var s = r - 1;
        return e !== i && (s = R(e), s = e < 0 ? Q2(r + s, 0) : nn(s, r - 1)), ye(n, x2(t, 3), s, true);
      }
      function Gu(n) {
        var t = n == null ? 0 : n.length;
        return t ? j3(n, 1) : [];
      }
      function bh(n) {
        var t = n == null ? 0 : n.length;
        return t ? j3(n, ht) : [];
      }
      function Th(n, t) {
        var e = n == null ? 0 : n.length;
        return e ? (t = t === i ? 1 : R(t), j3(n, t)) : [];
      }
      function Lh(n) {
        for (var t = -1, e = n == null ? 0 : n.length, r = {}; ++t < e; ) {
          var s = n[t];
          r[s[0]] = s[1];
        }
        return r;
      }
      function zu(n) {
        return n && n.length ? n[0] : i;
      }
      function Dh(n, t, e) {
        var r = n == null ? 0 : n.length;
        if (!r) return -1;
        var s = e == null ? 0 : R(e);
        return s < 0 && (s = Q2(r + s, 0)), Tt(n, t, s);
      }
      function Nh(n) {
        var t = n == null ? 0 : n.length;
        return t ? Cn(n, 0, -1) : [];
      }
      var Hh = L4(function(n) {
        var t = G(n, ai);
        return t.length && t[0] === n[0] ? Vr(t) : [];
      }), $h = L4(function(n) {
        var t = In(n), e = G(n, ai);
        return t === In(e) ? t = i : e.pop(), e.length && e[0] === n[0] ? Vr(e, x2(t, 2)) : [];
      }), Uh = L4(function(n) {
        var t = In(n), e = G(n, ai);
        return t = typeof t == "function" ? t : i, t && e.pop(), e.length && e[0] === n[0] ? Vr(e, i, t) : [];
      });
      function Wh(n, t) {
        return n == null ? "" : Nf.call(n, t);
      }
      function In(n) {
        var t = n == null ? 0 : n.length;
        return t ? n[t - 1] : i;
      }
      function Fh(n, t, e) {
        var r = n == null ? 0 : n.length;
        if (!r) return -1;
        var s = r;
        return e !== i && (s = R(e), s = s < 0 ? Q2(r + s, 0) : nn(s, r - 1)), t === t ? mf(n, t, s) : ye(n, xs, s, true);
      }
      function Mh(n, t) {
        return n && n.length ? tu(n, R(t)) : i;
      }
      var qh = L4(Ku);
      function Ku(n, t) {
        return n && n.length && t && t.length ? ti(n, t) : n;
      }
      function Bh(n, t, e) {
        return n && n.length && t && t.length ? ti(n, t, x2(e, 2)) : n;
      }
      function Gh(n, t, e) {
        return n && n.length && t && t.length ? ti(n, t, i, e) : n;
      }
      var zh = Yn(function(n, t) {
        var e = n == null ? 0 : n.length, r = Zr(n, t);
        return iu(n, G(t, function(s) {
          return Zn(s, e) ? +s : s;
        }).sort(du2)), r;
      });
      function Kh(n, t) {
        var e = [];
        if (!(n && n.length)) return e;
        var r = -1, s = [], o2 = n.length;
        for (t = x2(t, 3); ++r < o2; ) {
          var f2 = n[r];
          t(f2, r, n) && (e.push(f2), s.push(r));
        }
        return iu(n, s), e;
      }
      function Ai(n) {
        return n == null ? n : Wf.call(n);
      }
      function Yh(n, t, e) {
        var r = n == null ? 0 : n.length;
        return r ? (e && typeof e != "number" && rn(n, t, e) ? (t = 0, e = r) : (t = t == null ? 0 : R(t), e = e === i ? r : R(e)), Cn(n, t, e)) : [];
      }
      function Zh(n, t) {
        return Ye2(n, t);
      }
      function Jh(n, t, e) {
        return ii(n, t, x2(e, 2));
      }
      function Xh(n, t) {
        var e = n == null ? 0 : n.length;
        if (e) {
          var r = Ye2(n, t);
          if (r < e && bn(n[r], t)) return r;
        }
        return -1;
      }
      function Qh(n, t) {
        return Ye2(n, t, true);
      }
      function Vh(n, t, e) {
        return ii(n, t, x2(e, 2), true);
      }
      function kh(n, t) {
        var e = n == null ? 0 : n.length;
        if (e) {
          var r = Ye2(n, t, true) - 1;
          if (bn(n[r], t)) return r;
        }
        return -1;
      }
      function jh(n) {
        return n && n.length ? uu(n) : [];
      }
      function nl(n, t) {
        return n && n.length ? uu(n, x2(t, 2)) : [];
      }
      function tl(n) {
        var t = n == null ? 0 : n.length;
        return t ? Cn(n, 1, t) : [];
      }
      function el(n, t, e) {
        return n && n.length ? (t = e || t === i ? 1 : R(t), Cn(n, 0, t < 0 ? 0 : t)) : [];
      }
      function rl(n, t, e) {
        var r = n == null ? 0 : n.length;
        return r ? (t = e || t === i ? 1 : R(t), t = r - t, Cn(n, t < 0 ? 0 : t, r)) : [];
      }
      function il(n, t) {
        return n && n.length ? Ze(n, x2(t, 3), false, true) : [];
      }
      function sl(n, t) {
        return n && n.length ? Ze(n, x2(t, 3)) : [];
      }
      var ul = L4(function(n) {
        return it(j3(n, 1, Z, true));
      }), al = L4(function(n) {
        var t = In(n);
        return Z(t) && (t = i), it(j3(n, 1, Z, true), x2(t, 2));
      }), ol = L4(function(n) {
        var t = In(n);
        return t = typeof t == "function" ? t : i, it(j3(n, 1, Z, true), i, t);
      });
      function fl(n) {
        return n && n.length ? it(n) : [];
      }
      function cl(n, t) {
        return n && n.length ? it(n, x2(t, 2)) : [];
      }
      function hl(n, t) {
        return t = typeof t == "function" ? t : i, n && n.length ? it(n, i, t) : [];
      }
      function Ci(n) {
        if (!(n && n.length)) return [];
        var t = 0;
        return n = jn(n, function(e) {
          if (Z(e)) return t = Q2(e.length, t), true;
        }), Fr(t, function(e) {
          return G(n, $r(e));
        });
      }
      function Yu(n, t) {
        if (!(n && n.length)) return [];
        var e = Ci(n);
        return t == null ? e : G(e, function(r) {
          return cn(t, i, r);
        });
      }
      var ll = L4(function(n, t) {
        return Z(n) ? ue(n, t) : [];
      }), pl = L4(function(n) {
        return ui(jn(n, Z));
      }), dl = L4(function(n) {
        var t = In(n);
        return Z(t) && (t = i), ui(jn(n, Z), x2(t, 2));
      }), gl = L4(function(n) {
        var t = In(n);
        return t = typeof t == "function" ? t : i, ui(jn(n, Z), i, t);
      }), vl = L4(Ci);
      function _l(n, t) {
        return cu2(n || [], t || [], se2);
      }
      function ml(n, t) {
        return cu2(n || [], t || [], fe);
      }
      var wl = L4(function(n) {
        var t = n.length, e = t > 1 ? n[t - 1] : i;
        return e = typeof e == "function" ? (n.pop(), e) : i, Yu(n, e);
      });
      function Zu2(n) {
        var t = a(n);
        return t.__chain__ = true, t;
      }
      function Pl(n, t) {
        return t(n), n;
      }
      function er(n, t) {
        return t(n);
      }
      var Al = Yn(function(n) {
        var t = n.length, e = t ? n[0] : 0, r = this.__wrapped__, s = function(o2) {
          return Zr(o2, n);
        };
        return t > 1 || this.__actions__.length || !(r instanceof H) || !Zn(e) ? this.thru(s) : (r = r.slice(e, +e + (t ? 1 : 0)), r.__actions__.push({ func: er, args: [s], thisArg: i }), new Pn(r, this.__chain__).thru(function(o2) {
          return t && !o2.length && o2.push(i), o2;
        }));
      });
      function Cl() {
        return Zu2(this);
      }
      function Il() {
        return new Pn(this.value(), this.__chain__);
      }
      function xl() {
        this.__values__ === i && (this.__values__ = aa(this.value()));
        var n = this.__index__ >= this.__values__.length, t = n ? i : this.__values__[this.__index__++];
        return { done: n, value: t };
      }
      function El() {
        return this;
      }
      function yl(n) {
        for (var t, e = this; e instanceof qe; ) {
          var r = Mu(e);
          r.__index__ = 0, r.__values__ = i, t ? s.__wrapped__ = r : t = r;
          var s = r;
          e = e.__wrapped__;
        }
        return s.__wrapped__ = n, t;
      }
      function Sl() {
        var n = this.__wrapped__;
        if (n instanceof H) {
          var t = n;
          return this.__actions__.length && (t = new H(this)), t = t.reverse(), t.__actions__.push({ func: er, args: [Ai], thisArg: i }), new Pn(t, this.__chain__);
        }
        return this.thru(Ai);
      }
      function Ol() {
        return fu2(this.__wrapped__, this.__actions__);
      }
      var Rl = Je2(function(n, t, e) {
        F2.call(n, e) ? ++n[e] : zn(n, e, 1);
      });
      function bl(n, t, e) {
        var r = O3(n) ? Cs : Pc;
        return e && rn(n, t, e) && (t = i), r(n, x2(t, 3));
      }
      function Tl(n, t) {
        var e = O3(n) ? jn : Ys;
        return e(n, x2(t, 3));
      }
      var Ll = Pu(qu), Dl = Pu(Bu);
      function Nl(n, t) {
        return j3(rr(n, t), 1);
      }
      function Hl(n, t) {
        return j3(rr(n, t), ht);
      }
      function $l(n, t, e) {
        return e = e === i ? 1 : R(e), j3(rr(n, t), e);
      }
      function Ju(n, t) {
        var e = O3(n) ? mn : rt;
        return e(n, x2(t, 3));
      }
      function Xu2(n, t) {
        var e = O3(n) ? nf : Ks;
        return e(n, x2(t, 3));
      }
      var Ul = Je2(function(n, t, e) {
        F2.call(n, e) ? n[e].push(t) : zn(n, e, [t]);
      });
      function Wl(n, t, e, r) {
        n = an(n) ? n : Gt2(n), e = e && !r ? R(e) : 0;
        var s = n.length;
        return e < 0 && (e = Q2(s + e, 0)), or(n) ? e <= s && n.indexOf(t, e) > -1 : !!s && Tt(n, t, e) > -1;
      }
      var Fl = L4(function(n, t, e) {
        var r = -1, s = typeof t == "function", o2 = an(n) ? d2(n.length) : [];
        return rt(n, function(f2) {
          o2[++r] = s ? cn(t, f2, e) : ae(f2, t, e);
        }), o2;
      }), Ml = Je2(function(n, t, e) {
        zn(n, e, t);
      });
      function rr(n, t) {
        var e = O3(n) ? G : ks;
        return e(n, x2(t, 3));
      }
      function ql(n, t, e, r) {
        return n == null ? [] : (O3(t) || (t = t == null ? [] : [t]), e = r ? i : e, O3(e) || (e = e == null ? [] : [e]), eu(n, t, e));
      }
      var Bl = Je2(function(n, t, e) {
        n[e ? 0 : 1].push(t);
      }, function() {
        return [[], []];
      });
      function Gl(n, t, e) {
        var r = O3(n) ? Nr : ys, s = arguments.length < 3;
        return r(n, x2(t, 4), e, s, rt);
      }
      function zl(n, t, e) {
        var r = O3(n) ? tf : ys, s = arguments.length < 3;
        return r(n, x2(t, 4), e, s, Ks);
      }
      function Kl(n, t) {
        var e = O3(n) ? jn : Ys;
        return e(n, ur(x2(t, 3)));
      }
      function Yl(n) {
        var t = O3(n) ? qs : Wc;
        return t(n);
      }
      function Zl(n, t, e) {
        (e ? rn(n, t, e) : t === i) ? t = 1 : t = R(t);
        var r = O3(n) ? gc : Fc;
        return r(n, t);
      }
      function Jl(n) {
        var t = O3(n) ? vc : qc;
        return t(n);
      }
      function Xl(n) {
        if (n == null) return 0;
        if (an(n)) return or(n) ? Dt(n) : n.length;
        var t = tn(n);
        return t == yn || t == Sn ? n.size : jr(n).length;
      }
      function Ql(n, t, e) {
        var r = O3(n) ? Hr : Bc;
        return e && rn(n, t, e) && (t = i), r(n, x2(t, 3));
      }
      var Vl = L4(function(n, t) {
        if (n == null) return [];
        var e = t.length;
        return e > 1 && rn(n, t[0], t[1]) ? t = [] : e > 2 && rn(t[0], t[1], t[2]) && (t = [t[0]]), eu(n, j3(t, 1), []);
      }), ir = Tf || function() {
        return k3.Date.now();
      };
      function kl(n, t) {
        if (typeof t != "function") throw new wn(D2);
        return n = R(n), function() {
          if (--n < 1) return t.apply(this, arguments);
        };
      }
      function Qu2(n, t, e) {
        return t = e ? i : t, t = n && t == null ? n.length : t, Kn(n, Mn, i, i, i, i, t);
      }
      function Vu2(n, t) {
        var e;
        if (typeof t != "function") throw new wn(D2);
        return n = R(n), function() {
          return --n > 0 && (e = t.apply(this, arguments)), n <= 1 && (t = i), e;
        };
      }
      var Ii = L4(function(n, t, e) {
        var r = vn;
        if (e.length) {
          var s = tt(e, qt(Ii));
          r |= Nn;
        }
        return Kn(n, r, t, e, s);
      }), ku = L4(function(n, t, e) {
        var r = vn | ct;
        if (e.length) {
          var s = tt(e, qt(ku));
          r |= Nn;
        }
        return Kn(t, r, n, e, s);
      });
      function ju2(n, t, e) {
        t = e ? i : t;
        var r = Kn(n, Dn, i, i, i, i, i, t);
        return r.placeholder = ju2.placeholder, r;
      }
      function na(n, t, e) {
        t = e ? i : t;
        var r = Kn(n, yt, i, i, i, i, i, t);
        return r.placeholder = na.placeholder, r;
      }
      function ta(n, t, e) {
        var r, s, o2, f2, c2, l2, v4 = 0, _2 = false, m4 = false, P2 = true;
        if (typeof n != "function") throw new wn(D2);
        t = xn(t) || 0, K(e) && (_2 = !!e.leading, m4 = "maxWait" in e, o2 = m4 ? Q2(xn(e.maxWait) || 0, t) : o2, P2 = "trailing" in e ? !!e.trailing : P2);
        function I(J2) {
          var Tn = r, Qn = s;
          return r = s = i, v4 = J2, f2 = n.apply(Qn, Tn), f2;
        }
        function E4(J2) {
          return v4 = J2, c2 = le(N2, t), _2 ? I(J2) : f2;
        }
        function T3(J2) {
          var Tn = J2 - l2, Qn = J2 - v4, Pa = t - Tn;
          return m4 ? nn(Pa, o2 - Qn) : Pa;
        }
        function y2(J2) {
          var Tn = J2 - l2, Qn = J2 - v4;
          return l2 === i || Tn >= t || Tn < 0 || m4 && Qn >= o2;
        }
        function N2() {
          var J2 = ir();
          if (y2(J2)) return $2(J2);
          c2 = le(N2, T3(J2));
        }
        function $2(J2) {
          return c2 = i, P2 && r ? I(J2) : (r = s = i, f2);
        }
        function dn2() {
          c2 !== i && hu(c2), v4 = 0, r = l2 = s = c2 = i;
        }
        function sn() {
          return c2 === i ? f2 : $2(ir());
        }
        function gn() {
          var J2 = ir(), Tn = y2(J2);
          if (r = arguments, s = this, l2 = J2, Tn) {
            if (c2 === i) return E4(l2);
            if (m4) return hu(c2), c2 = le(N2, t), I(l2);
          }
          return c2 === i && (c2 = le(N2, t)), f2;
        }
        return gn.cancel = dn2, gn.flush = sn, gn;
      }
      var jl = L4(function(n, t) {
        return zs(n, 1, t);
      }), np = L4(function(n, t, e) {
        return zs(n, xn(t) || 0, e);
      });
      function tp(n) {
        return Kn(n, dr);
      }
      function sr(n, t) {
        if (typeof n != "function" || t != null && typeof t != "function") throw new wn(D2);
        var e = function() {
          var r = arguments, s = t ? t.apply(this, r) : r[0], o2 = e.cache;
          if (o2.has(s)) return o2.get(s);
          var f2 = n.apply(this, r);
          return e.cache = o2.set(s, f2) || o2, f2;
        };
        return e.cache = new (sr.Cache || Gn)(), e;
      }
      sr.Cache = Gn;
      function ur(n) {
        if (typeof n != "function") throw new wn(D2);
        return function() {
          var t = arguments;
          switch (t.length) {
            case 0:
              return !n.call(this);
            case 1:
              return !n.call(this, t[0]);
            case 2:
              return !n.call(this, t[0], t[1]);
            case 3:
              return !n.call(this, t[0], t[1], t[2]);
          }
          return !n.apply(this, t);
        };
      }
      function ep(n) {
        return Vu2(2, n);
      }
      var rp = Gc(function(n, t) {
        t = t.length == 1 && O3(t[0]) ? G(t[0], hn(x2())) : G(j3(t, 1), hn(x2()));
        var e = t.length;
        return L4(function(r) {
          for (var s = -1, o2 = nn(r.length, e); ++s < o2; ) r[s] = t[s].call(this, r[s]);
          return cn(n, this, r);
        });
      }), xi = L4(function(n, t) {
        var e = tt(t, qt(xi));
        return Kn(n, Nn, i, t, e);
      }), ea = L4(function(n, t) {
        var e = tt(t, qt(ea));
        return Kn(n, St, i, t, e);
      }), ip = Yn(function(n, t) {
        return Kn(n, Kt, i, i, i, t);
      });
      function sp(n, t) {
        if (typeof n != "function") throw new wn(D2);
        return t = t === i ? t : R(t), L4(n, t);
      }
      function up(n, t) {
        if (typeof n != "function") throw new wn(D2);
        return t = t == null ? 0 : Q2(R(t), 0), L4(function(e) {
          var r = e[t], s = ut(e, 0, t);
          return r && nt(s, r), cn(n, this, s);
        });
      }
      function ap(n, t, e) {
        var r = true, s = true;
        if (typeof n != "function") throw new wn(D2);
        return K(e) && (r = "leading" in e ? !!e.leading : r, s = "trailing" in e ? !!e.trailing : s), ta(n, t, { leading: r, maxWait: t, trailing: s });
      }
      function op(n) {
        return Qu2(n, 1);
      }
      function fp(n, t) {
        return xi(oi(t), n);
      }
      function cp() {
        if (!arguments.length) return [];
        var n = arguments[0];
        return O3(n) ? n : [n];
      }
      function hp(n) {
        return An(n, xt);
      }
      function lp(n, t) {
        return t = typeof t == "function" ? t : i, An(n, xt, t);
      }
      function pp(n) {
        return An(n, Ln | xt);
      }
      function dp(n, t) {
        return t = typeof t == "function" ? t : i, An(n, Ln | xt, t);
      }
      function gp(n, t) {
        return t == null || Gs(n, t, V2(t));
      }
      function bn(n, t) {
        return n === t || n !== n && t !== t;
      }
      var vp = ke2(Qr2), _p = ke2(function(n, t) {
        return n >= t;
      }), Pt = Xs(/* @__PURE__ */ function() {
        return arguments;
      }()) ? Xs : function(n) {
        return Y(n) && F2.call(n, "callee") && !Hs.call(n, "callee");
      }, O3 = d2.isArray, mp = vs ? hn(vs) : yc;
      function an(n) {
        return n != null && ar(n.length) && !Jn(n);
      }
      function Z(n) {
        return Y(n) && an(n);
      }
      function wp(n) {
        return n === true || n === false || Y(n) && en(n) == Yt2;
      }
      var at = Df || Hi, Pp = _s ? hn(_s) : Sc;
      function Ap(n) {
        return Y(n) && n.nodeType === 1 && !pe(n);
      }
      function Cp(n) {
        if (n == null) return true;
        if (an(n) && (O3(n) || typeof n == "string" || typeof n.splice == "function" || at(n) || Bt2(n) || Pt(n))) return !n.length;
        var t = tn(n);
        if (t == yn || t == Sn) return !n.size;
        if (he(n)) return !jr(n).length;
        for (var e in n) if (F2.call(n, e)) return false;
        return true;
      }
      function Ip(n, t) {
        return oe(n, t);
      }
      function xp(n, t, e) {
        e = typeof e == "function" ? e : i;
        var r = e ? e(n, t) : i;
        return r === i ? oe(n, t, i, e) : !!r;
      }
      function Ei(n) {
        if (!Y(n)) return false;
        var t = en(n);
        return t == we || t == Ka || typeof n.message == "string" && typeof n.name == "string" && !pe(n);
      }
      function Ep(n) {
        return typeof n == "number" && Us(n);
      }
      function Jn(n) {
        if (!K(n)) return false;
        var t = en(n);
        return t == Pe2 || t == zi || t == za || t == Za;
      }
      function ra(n) {
        return typeof n == "number" && n == R(n);
      }
      function ar(n) {
        return typeof n == "number" && n > -1 && n % 1 == 0 && n <= kn;
      }
      function K(n) {
        var t = typeof n;
        return n != null && (t == "object" || t == "function");
      }
      function Y(n) {
        return n != null && typeof n == "object";
      }
      var ia = ms ? hn(ms) : Rc;
      function yp(n, t) {
        return n === t || kr(n, t, gi(t));
      }
      function Sp(n, t, e) {
        return e = typeof e == "function" ? e : i, kr(n, t, gi(t), e);
      }
      function Op(n) {
        return sa(n) && n != +n;
      }
      function Rp(n) {
        if (lh2(n)) throw new S2(b3);
        return Qs(n);
      }
      function bp(n) {
        return n === null;
      }
      function Tp(n) {
        return n == null;
      }
      function sa(n) {
        return typeof n == "number" || Y(n) && en(n) == Jt2;
      }
      function pe(n) {
        if (!Y(n) || en(n) != qn) return false;
        var t = Ne(n);
        if (t === null) return true;
        var e = F2.call(t, "constructor") && t.constructor;
        return typeof e == "function" && e instanceof e && be.call(e) == Sf;
      }
      var yi = ws ? hn(ws) : bc;
      function Lp(n) {
        return ra(n) && n >= -kn && n <= kn;
      }
      var ua = Ps ? hn(Ps) : Tc;
      function or(n) {
        return typeof n == "string" || !O3(n) && Y(n) && en(n) == Qt;
      }
      function pn(n) {
        return typeof n == "symbol" || Y(n) && en(n) == Ae;
      }
      var Bt2 = As ? hn(As) : Lc;
      function Dp(n) {
        return n === i;
      }
      function Np(n) {
        return Y(n) && tn(n) == Vt3;
      }
      function Hp(n) {
        return Y(n) && en(n) == Xa;
      }
      var $p = ke2(ni), Up = ke2(function(n, t) {
        return n <= t;
      });
      function aa(n) {
        if (!n) return [];
        if (an(n)) return or(n) ? On(n) : un(n);
        if (ne2 && n[ne2]) return gf(n[ne2]());
        var t = tn(n), e = t == yn ? qr : t == Sn ? Se2 : Gt2;
        return e(n);
      }
      function Xn(n) {
        if (!n) return n === 0 ? n : 0;
        if (n = xn(n), n === ht || n === -ht) {
          var t = n < 0 ? -1 : 1;
          return t * Ma;
        }
        return n === n ? n : 0;
      }
      function R(n) {
        var t = Xn(n), e = t % 1;
        return t === t ? e ? t - e : t : 0;
      }
      function oa(n) {
        return n ? vt(R(n), 0, Hn) : 0;
      }
      function xn(n) {
        if (typeof n == "number") return n;
        if (pn(n)) return _e2;
        if (K(n)) {
          var t = typeof n.valueOf == "function" ? n.valueOf() : n;
          n = K(t) ? t + "" : t;
        }
        if (typeof n != "string") return n === 0 ? n : +n;
        n = Ss(n);
        var e = _o.test(n);
        return e || wo.test(n) ? Vo(n.slice(2), e ? 2 : 8) : vo2.test(n) ? _e2 : +n;
      }
      function fa(n) {
        return Un(n, on(n));
      }
      function Wp(n) {
        return n ? vt(R(n), -kn, kn) : n === 0 ? n : 0;
      }
      function W(n) {
        return n == null ? "" : ln(n);
      }
      var Fp = Ft(function(n, t) {
        if (he(t) || an(t)) {
          Un(t, V2(t), n);
          return;
        }
        for (var e in t) F2.call(t, e) && se2(n, e, t[e]);
      }), ca = Ft(function(n, t) {
        Un(t, on(t), n);
      }), fr = Ft(function(n, t, e, r) {
        Un(t, on(t), n, r);
      }), Mp = Ft(function(n, t, e, r) {
        Un(t, V2(t), n, r);
      }), qp = Yn(Zr);
      function Bp(n, t) {
        var e = Wt2(n);
        return t == null ? e : Bs(e, t);
      }
      var Gp = L4(function(n, t) {
        n = M2(n);
        var e = -1, r = t.length, s = r > 2 ? t[2] : i;
        for (s && rn(t[0], t[1], s) && (r = 1); ++e < r; ) for (var o2 = t[e], f2 = on(o2), c2 = -1, l2 = f2.length; ++c2 < l2; ) {
          var v4 = f2[c2], _2 = n[v4];
          (_2 === i || bn(_2, Ht2[v4]) && !F2.call(n, v4)) && (n[v4] = o2[v4]);
        }
        return n;
      }), zp = L4(function(n) {
        return n.push(i, Su), cn(ha, i, n);
      });
      function Kp(n, t) {
        return Is(n, x2(t, 3), $n);
      }
      function Yp(n, t) {
        return Is(n, x2(t, 3), Xr);
      }
      function Zp(n, t) {
        return n == null ? n : Jr(n, x2(t, 3), on);
      }
      function Jp(n, t) {
        return n == null ? n : Zs(n, x2(t, 3), on);
      }
      function Xp(n, t) {
        return n && $n(n, x2(t, 3));
      }
      function Qp(n, t) {
        return n && Xr(n, x2(t, 3));
      }
      function Vp(n) {
        return n == null ? [] : ze2(n, V2(n));
      }
      function kp(n) {
        return n == null ? [] : ze2(n, on(n));
      }
      function Si(n, t, e) {
        var r = n == null ? i : _t(n, t);
        return r === i ? e : r;
      }
      function jp(n, t) {
        return n != null && bu2(n, t, Cc);
      }
      function Oi(n, t) {
        return n != null && bu2(n, t, Ic);
      }
      var nd = Cu(function(n, t, e) {
        t != null && typeof t.toString != "function" && (t = Te.call(t)), n[t] = e;
      }, bi(fn)), td = Cu(function(n, t, e) {
        t != null && typeof t.toString != "function" && (t = Te.call(t)), F2.call(n, t) ? n[t].push(e) : n[t] = [e];
      }, x2), ed = L4(ae);
      function V2(n) {
        return an(n) ? Ms(n) : jr(n);
      }
      function on(n) {
        return an(n) ? Ms(n, true) : Dc(n);
      }
      function rd(n, t) {
        var e = {};
        return t = x2(t, 3), $n(n, function(r, s, o2) {
          zn(e, t(r, s, o2), r);
        }), e;
      }
      function id(n, t) {
        var e = {};
        return t = x2(t, 3), $n(n, function(r, s, o2) {
          zn(e, s, t(r, s, o2));
        }), e;
      }
      var sd = Ft(function(n, t, e) {
        Ke2(n, t, e);
      }), ha = Ft(function(n, t, e, r) {
        Ke2(n, t, e, r);
      }), ud = Yn(function(n, t) {
        var e = {};
        if (n == null) return e;
        var r = false;
        t = G(t, function(o2) {
          return o2 = st(o2, n), r || (r = o2.length > 1), o2;
        }), Un(n, pi(n), e), r && (e = An(e, Ln | Fn | xt, nh2));
        for (var s = t.length; s--; ) si(e, t[s]);
        return e;
      });
      function ad(n, t) {
        return la(n, ur(x2(t)));
      }
      var od = Yn(function(n, t) {
        return n == null ? {} : Hc(n, t);
      });
      function la(n, t) {
        if (n == null) return {};
        var e = G(pi(n), function(r) {
          return [r];
        });
        return t = x2(t), ru(n, e, function(r, s) {
          return t(r, s[0]);
        });
      }
      function fd(n, t, e) {
        t = st(t, n);
        var r = -1, s = t.length;
        for (s || (s = 1, n = i); ++r < s; ) {
          var o2 = n == null ? i : n[Wn(t[r])];
          o2 === i && (r = s, o2 = e), n = Jn(o2) ? o2.call(n) : o2;
        }
        return n;
      }
      function cd(n, t, e) {
        return n == null ? n : fe(n, t, e);
      }
      function hd(n, t, e, r) {
        return r = typeof r == "function" ? r : i, n == null ? n : fe(n, t, e, r);
      }
      var pa = Eu(V2), da = Eu(on);
      function ld(n, t, e) {
        var r = O3(n), s = r || at(n) || Bt2(n);
        if (t = x2(t, 4), e == null) {
          var o2 = n && n.constructor;
          s ? e = r ? new o2() : [] : K(n) ? e = Jn(o2) ? Wt2(Ne(n)) : {} : e = {};
        }
        return (s ? mn : $n)(n, function(f2, c2, l2) {
          return t(e, f2, c2, l2);
        }), e;
      }
      function pd(n, t) {
        return n == null ? true : si(n, t);
      }
      function dd(n, t, e) {
        return n == null ? n : ou2(n, t, oi(e));
      }
      function gd(n, t, e, r) {
        return r = typeof r == "function" ? r : i, n == null ? n : ou2(n, t, oi(e), r);
      }
      function Gt2(n) {
        return n == null ? [] : Mr(n, V2(n));
      }
      function vd(n) {
        return n == null ? [] : Mr(n, on(n));
      }
      function _d(n, t, e) {
        return e === i && (e = t, t = i), e !== i && (e = xn(e), e = e === e ? e : 0), t !== i && (t = xn(t), t = t === t ? t : 0), vt(xn(n), t, e);
      }
      function md(n, t, e) {
        return t = Xn(t), e === i ? (e = t, t = 0) : e = Xn(e), n = xn(n), xc(n, t, e);
      }
      function wd(n, t, e) {
        if (e && typeof e != "boolean" && rn(n, t, e) && (t = e = i), e === i && (typeof t == "boolean" ? (e = t, t = i) : typeof n == "boolean" && (e = n, n = i)), n === i && t === i ? (n = 0, t = 1) : (n = Xn(n), t === i ? (t = n, n = 0) : t = Xn(t)), n > t) {
          var r = n;
          n = t, t = r;
        }
        if (e || n % 1 || t % 1) {
          var s = Ws();
          return nn(n + s * (t - n + Qo("1e-" + ((s + "").length - 1))), t);
        }
        return ei(n, t);
      }
      var Pd = Mt(function(n, t, e) {
        return t = t.toLowerCase(), n + (e ? ga(t) : t);
      });
      function ga(n) {
        return Ri(W(n).toLowerCase());
      }
      function va(n) {
        return n = W(n), n && n.replace(Ao, cf).replace(Mo, "");
      }
      function Ad(n, t, e) {
        n = W(n), t = ln(t);
        var r = n.length;
        e = e === i ? r : vt(R(e), 0, r);
        var s = e;
        return e -= t.length, e >= 0 && n.slice(e, s) == t;
      }
      function Cd(n) {
        return n = W(n), n && no.test(n) ? n.replace(Zi2, hf) : n;
      }
      function Id(n) {
        return n = W(n), n && uo.test(n) ? n.replace(xr, "\\$&") : n;
      }
      var xd = Mt(function(n, t, e) {
        return n + (e ? "-" : "") + t.toLowerCase();
      }), Ed = Mt(function(n, t, e) {
        return n + (e ? " " : "") + t.toLowerCase();
      }), yd = wu("toLowerCase");
      function Sd(n, t, e) {
        n = W(n), t = R(t);
        var r = t ? Dt(n) : 0;
        if (!t || r >= t) return n;
        var s = (t - r) / 2;
        return Ve(We2(s), e) + n + Ve(Ue2(s), e);
      }
      function Od(n, t, e) {
        n = W(n), t = R(t);
        var r = t ? Dt(n) : 0;
        return t && r < t ? n + Ve(t - r, e) : n;
      }
      function Rd(n, t, e) {
        n = W(n), t = R(t);
        var r = t ? Dt(n) : 0;
        return t && r < t ? Ve(t - r, e) + n : n;
      }
      function bd(n, t, e) {
        return e || t == null ? t = 0 : t && (t = +t), Uf(W(n).replace(Er2, ""), t || 0);
      }
      function Td(n, t, e) {
        return (e ? rn(n, t, e) : t === i) ? t = 1 : t = R(t), ri(W(n), t);
      }
      function Ld() {
        var n = arguments, t = W(n[0]);
        return n.length < 3 ? t : t.replace(n[1], n[2]);
      }
      var Dd = Mt(function(n, t, e) {
        return n + (e ? "_" : "") + t.toLowerCase();
      });
      function Nd(n, t, e) {
        return e && typeof e != "number" && rn(n, t, e) && (t = e = i), e = e === i ? Hn : e >>> 0, e ? (n = W(n), n && (typeof t == "string" || t != null && !yi(t)) && (t = ln(t), !t && Lt(n)) ? ut(On(n), 0, e) : n.split(t, e)) : [];
      }
      var Hd = Mt(function(n, t, e) {
        return n + (e ? " " : "") + Ri(t);
      });
      function $d(n, t, e) {
        return n = W(n), e = e == null ? 0 : vt(R(e), 0, n.length), t = ln(t), n.slice(e, e + t.length) == t;
      }
      function Ud(n, t, e) {
        var r = a.templateSettings;
        e && rn(n, t, e) && (t = i), n = W(n), t = fr({}, t, r, yu2);
        var s = fr({}, t.imports, r.imports, yu2), o2 = V2(s), f2 = Mr(s, o2), c2, l2, v4 = 0, _2 = t.interpolate || Ce, m4 = "__p += '", P2 = Br2((t.escape || Ce).source + "|" + _2.source + "|" + (_2 === Ji ? go : Ce).source + "|" + (t.evaluate || Ce).source + "|$", "g"), I = "//# sourceURL=" + (F2.call(t, "sourceURL") ? (t.sourceURL + "").replace(/\s/g, " ") : "lodash.templateSources[" + ++Ko + "]") + `
`;
        n.replace(P2, function(y2, N2, $2, dn2, sn, gn) {
          return $2 || ($2 = dn2), m4 += n.slice(v4, gn).replace(Co, lf), N2 && (c2 = true, m4 += `' +
__e(` + N2 + `) +
'`), sn && (l2 = true, m4 += `';
` + sn + `;
__p += '`), $2 && (m4 += `' +
((__t = (` + $2 + `)) == null ? '' : __t) +
'`), v4 = gn + y2.length, y2;
        }), m4 += `';
`;
        var E4 = F2.call(t, "variable") && t.variable;
        if (!E4) m4 = `with (obj) {
` + m4 + `
}
`;
        else if (lo.test(E4)) throw new S2(En);
        m4 = (l2 ? m4.replace(Qa, "") : m4).replace(Va, "$1").replace(ka, "$1;"), m4 = "function(" + (E4 || "obj") + `) {
` + (E4 ? "" : `obj || (obj = {});
`) + "var __t, __p = ''" + (c2 ? ", __e = _.escape" : "") + (l2 ? `, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
` : `;
`) + m4 + `return __p
}`;
        var T3 = ma(function() {
          return U3(o2, I + "return " + m4).apply(i, f2);
        });
        if (T3.source = m4, Ei(T3)) throw T3;
        return T3;
      }
      function Wd(n) {
        return W(n).toLowerCase();
      }
      function Fd(n) {
        return W(n).toUpperCase();
      }
      function Md(n, t, e) {
        if (n = W(n), n && (e || t === i)) return Ss(n);
        if (!n || !(t = ln(t))) return n;
        var r = On(n), s = On(t), o2 = Os(r, s), f2 = Rs(r, s) + 1;
        return ut(r, o2, f2).join("");
      }
      function qd(n, t, e) {
        if (n = W(n), n && (e || t === i)) return n.slice(0, Ts(n) + 1);
        if (!n || !(t = ln(t))) return n;
        var r = On(n), s = Rs(r, On(t)) + 1;
        return ut(r, 0, s).join("");
      }
      function Bd(n, t, e) {
        if (n = W(n), n && (e || t === i)) return n.replace(Er2, "");
        if (!n || !(t = ln(t))) return n;
        var r = On(n), s = Os(r, On(t));
        return ut(r, s).join("");
      }
      function Gd(n, t) {
        var e = Na, r = Ha;
        if (K(t)) {
          var s = "separator" in t ? t.separator : s;
          e = "length" in t ? R(t.length) : e, r = "omission" in t ? ln(t.omission) : r;
        }
        n = W(n);
        var o2 = n.length;
        if (Lt(n)) {
          var f2 = On(n);
          o2 = f2.length;
        }
        if (e >= o2) return n;
        var c2 = e - Dt(r);
        if (c2 < 1) return r;
        var l2 = f2 ? ut(f2, 0, c2).join("") : n.slice(0, c2);
        if (s === i) return l2 + r;
        if (f2 && (c2 += l2.length - c2), yi(s)) {
          if (n.slice(c2).search(s)) {
            var v4, _2 = l2;
            for (s.global || (s = Br2(s.source, W(Xi.exec(s)) + "g")), s.lastIndex = 0; v4 = s.exec(_2); ) var m4 = v4.index;
            l2 = l2.slice(0, m4 === i ? c2 : m4);
          }
        } else if (n.indexOf(ln(s), c2) != c2) {
          var P2 = l2.lastIndexOf(s);
          P2 > -1 && (l2 = l2.slice(0, P2));
        }
        return l2 + r;
      }
      function zd(n) {
        return n = W(n), n && ja.test(n) ? n.replace(Yi, wf) : n;
      }
      var Kd = Mt(function(n, t, e) {
        return n + (e ? " " : "") + t.toUpperCase();
      }), Ri = wu("toUpperCase");
      function _a(n, t, e) {
        return n = W(n), t = e ? i : t, t === i ? df(n) ? Cf(n) : sf(n) : n.match(t) || [];
      }
      var ma = L4(function(n, t) {
        try {
          return cn(n, i, t);
        } catch (e) {
          return Ei(e) ? e : new S2(e);
        }
      }), Yd = Yn(function(n, t) {
        return mn(t, function(e) {
          e = Wn(e), zn(n, e, Ii(n[e], n));
        }), n;
      });
      function Zd(n) {
        var t = n == null ? 0 : n.length, e = x2();
        return n = t ? G(n, function(r) {
          if (typeof r[1] != "function") throw new wn(D2);
          return [e(r[0]), r[1]];
        }) : [], L4(function(r) {
          for (var s = -1; ++s < t; ) {
            var o2 = n[s];
            if (cn(o2[0], this, r)) return cn(o2[1], this, r);
          }
        });
      }
      function Jd(n) {
        return wc(An(n, Ln));
      }
      function bi(n) {
        return function() {
          return n;
        };
      }
      function Xd(n, t) {
        return n == null || n !== n ? t : n;
      }
      var Qd = Au(), Vd = Au(true);
      function fn(n) {
        return n;
      }
      function Ti(n) {
        return Vs(typeof n == "function" ? n : An(n, Ln));
      }
      function kd(n) {
        return js(An(n, Ln));
      }
      function jd(n, t) {
        return nu(n, An(t, Ln));
      }
      var ng = L4(function(n, t) {
        return function(e) {
          return ae(e, n, t);
        };
      }), tg = L4(function(n, t) {
        return function(e) {
          return ae(n, e, t);
        };
      });
      function Li2(n, t, e) {
        var r = V2(t), s = ze2(t, r);
        e == null && !(K(t) && (s.length || !r.length)) && (e = t, t = n, n = this, s = ze2(t, V2(t)));
        var o2 = !(K(e) && "chain" in e) || !!e.chain, f2 = Jn(n);
        return mn(s, function(c2) {
          var l2 = t[c2];
          n[c2] = l2, f2 && (n.prototype[c2] = function() {
            var v4 = this.__chain__;
            if (o2 || v4) {
              var _2 = n(this.__wrapped__), m4 = _2.__actions__ = un(this.__actions__);
              return m4.push({ func: l2, args: arguments, thisArg: n }), _2.__chain__ = v4, _2;
            }
            return l2.apply(n, nt([this.value()], arguments));
          });
        }), n;
      }
      function eg() {
        return k3._ === this && (k3._ = Of), this;
      }
      function Di() {
      }
      function rg(n) {
        return n = R(n), L4(function(t) {
          return tu(t, n);
        });
      }
      var ig = ci(G), sg = ci(Cs), ug = ci(Hr);
      function wa(n) {
        return _i(n) ? $r(Wn(n)) : $c(n);
      }
      function ag(n) {
        return function(t) {
          return n == null ? i : _t(n, t);
        };
      }
      var og = Iu(), fg = Iu(true);
      function Ni() {
        return [];
      }
      function Hi() {
        return false;
      }
      function cg() {
        return {};
      }
      function hg() {
        return "";
      }
      function lg() {
        return true;
      }
      function pg(n, t) {
        if (n = R(n), n < 1 || n > kn) return [];
        var e = Hn, r = nn(n, Hn);
        t = x2(t), n -= Hn;
        for (var s = Fr(r, t); ++e < n; ) t(e);
        return s;
      }
      function dg(n) {
        return O3(n) ? G(n, Wn) : pn(n) ? [n] : un(Fu(W(n)));
      }
      function gg(n) {
        var t = ++yf;
        return W(n) + t;
      }
      var vg = Qe2(function(n, t) {
        return n + t;
      }, 0), _g = hi("ceil"), mg = Qe2(function(n, t) {
        return n / t;
      }, 1), wg = hi("floor");
      function Pg(n) {
        return n && n.length ? Ge2(n, fn, Qr2) : i;
      }
      function Ag(n, t) {
        return n && n.length ? Ge2(n, x2(t, 2), Qr2) : i;
      }
      function Cg(n) {
        return Es(n, fn);
      }
      function Ig(n, t) {
        return Es(n, x2(t, 2));
      }
      function xg(n) {
        return n && n.length ? Ge2(n, fn, ni) : i;
      }
      function Eg(n, t) {
        return n && n.length ? Ge2(n, x2(t, 2), ni) : i;
      }
      var yg = Qe2(function(n, t) {
        return n * t;
      }, 1), Sg = hi("round"), Og = Qe2(function(n, t) {
        return n - t;
      }, 0);
      function Rg(n) {
        return n && n.length ? Wr(n, fn) : 0;
      }
      function bg(n, t) {
        return n && n.length ? Wr(n, x2(t, 2)) : 0;
      }
      return a.after = kl, a.ary = Qu2, a.assign = Fp, a.assignIn = ca, a.assignInWith = fr, a.assignWith = Mp, a.at = qp, a.before = Vu2, a.bind = Ii, a.bindAll = Yd, a.bindKey = ku, a.castArray = cp, a.chain = Zu2, a.chunk = wh, a.compact = Ph, a.concat = Ah, a.cond = Zd, a.conforms = Jd, a.constant = bi, a.countBy = Rl, a.create = Bp, a.curry = ju2, a.curryRight = na, a.debounce = ta, a.defaults = Gp, a.defaultsDeep = zp, a.defer = jl, a.delay = np, a.difference = Ch, a.differenceBy = Ih, a.differenceWith = xh, a.drop = Eh, a.dropRight = yh, a.dropRightWhile = Sh, a.dropWhile = Oh, a.fill = Rh, a.filter = Tl, a.flatMap = Nl, a.flatMapDeep = Hl, a.flatMapDepth = $l, a.flatten = Gu, a.flattenDeep = bh, a.flattenDepth = Th, a.flip = tp, a.flow = Qd, a.flowRight = Vd, a.fromPairs = Lh, a.functions = Vp, a.functionsIn = kp, a.groupBy = Ul, a.initial = Nh, a.intersection = Hh, a.intersectionBy = $h, a.intersectionWith = Uh, a.invert = nd, a.invertBy = td, a.invokeMap = Fl, a.iteratee = Ti, a.keyBy = Ml, a.keys = V2, a.keysIn = on, a.map = rr, a.mapKeys = rd, a.mapValues = id, a.matches = kd, a.matchesProperty = jd, a.memoize = sr, a.merge = sd, a.mergeWith = ha, a.method = ng, a.methodOf = tg, a.mixin = Li2, a.negate = ur, a.nthArg = rg, a.omit = ud, a.omitBy = ad, a.once = ep, a.orderBy = ql, a.over = ig, a.overArgs = rp, a.overEvery = sg, a.overSome = ug, a.partial = xi, a.partialRight = ea, a.partition = Bl, a.pick = od, a.pickBy = la, a.property = wa, a.propertyOf = ag, a.pull = qh, a.pullAll = Ku, a.pullAllBy = Bh, a.pullAllWith = Gh, a.pullAt = zh, a.range = og, a.rangeRight = fg, a.rearg = ip, a.reject = Kl, a.remove = Kh, a.rest = sp, a.reverse = Ai, a.sampleSize = Zl, a.set = cd, a.setWith = hd, a.shuffle = Jl, a.slice = Yh, a.sortBy = Vl, a.sortedUniq = jh, a.sortedUniqBy = nl, a.split = Nd, a.spread = up, a.tail = tl, a.take = el, a.takeRight = rl, a.takeRightWhile = il, a.takeWhile = sl, a.tap = Pl, a.throttle = ap, a.thru = er, a.toArray = aa, a.toPairs = pa, a.toPairsIn = da, a.toPath = dg, a.toPlainObject = fa, a.transform = ld, a.unary = op, a.union = ul, a.unionBy = al, a.unionWith = ol, a.uniq = fl, a.uniqBy = cl, a.uniqWith = hl, a.unset = pd, a.unzip = Ci, a.unzipWith = Yu, a.update = dd, a.updateWith = gd, a.values = Gt2, a.valuesIn = vd, a.without = ll, a.words = _a, a.wrap = fp, a.xor = pl, a.xorBy = dl, a.xorWith = gl, a.zip = vl, a.zipObject = _l, a.zipObjectDeep = ml, a.zipWith = wl, a.entries = pa, a.entriesIn = da, a.extend = ca, a.extendWith = fr, Li2(a, a), a.add = vg, a.attempt = ma, a.camelCase = Pd, a.capitalize = ga, a.ceil = _g, a.clamp = _d, a.clone = hp, a.cloneDeep = pp, a.cloneDeepWith = dp, a.cloneWith = lp, a.conformsTo = gp, a.deburr = va, a.defaultTo = Xd, a.divide = mg, a.endsWith = Ad, a.eq = bn, a.escape = Cd, a.escapeRegExp = Id, a.every = bl, a.find = Ll, a.findIndex = qu, a.findKey = Kp, a.findLast = Dl, a.findLastIndex = Bu, a.findLastKey = Yp, a.floor = wg, a.forEach = Ju, a.forEachRight = Xu2, a.forIn = Zp, a.forInRight = Jp, a.forOwn = Xp, a.forOwnRight = Qp, a.get = Si, a.gt = vp, a.gte = _p, a.has = jp, a.hasIn = Oi, a.head = zu, a.identity = fn, a.includes = Wl, a.indexOf = Dh, a.inRange = md, a.invoke = ed, a.isArguments = Pt, a.isArray = O3, a.isArrayBuffer = mp, a.isArrayLike = an, a.isArrayLikeObject = Z, a.isBoolean = wp, a.isBuffer = at, a.isDate = Pp, a.isElement = Ap, a.isEmpty = Cp, a.isEqual = Ip, a.isEqualWith = xp, a.isError = Ei, a.isFinite = Ep, a.isFunction = Jn, a.isInteger = ra, a.isLength = ar, a.isMap = ia, a.isMatch = yp, a.isMatchWith = Sp, a.isNaN = Op, a.isNative = Rp, a.isNil = Tp, a.isNull = bp, a.isNumber = sa, a.isObject = K, a.isObjectLike = Y, a.isPlainObject = pe, a.isRegExp = yi, a.isSafeInteger = Lp, a.isSet = ua, a.isString = or, a.isSymbol = pn, a.isTypedArray = Bt2, a.isUndefined = Dp, a.isWeakMap = Np, a.isWeakSet = Hp, a.join = Wh, a.kebabCase = xd, a.last = In, a.lastIndexOf = Fh, a.lowerCase = Ed, a.lowerFirst = yd, a.lt = $p, a.lte = Up, a.max = Pg, a.maxBy = Ag, a.mean = Cg, a.meanBy = Ig, a.min = xg, a.minBy = Eg, a.stubArray = Ni, a.stubFalse = Hi, a.stubObject = cg, a.stubString = hg, a.stubTrue = lg, a.multiply = yg, a.nth = Mh, a.noConflict = eg, a.noop = Di, a.now = ir, a.pad = Sd, a.padEnd = Od, a.padStart = Rd, a.parseInt = bd, a.random = wd, a.reduce = Gl, a.reduceRight = zl, a.repeat = Td, a.replace = Ld, a.result = fd, a.round = Sg, a.runInContext = h, a.sample = Yl, a.size = Xl, a.snakeCase = Dd, a.some = Ql, a.sortedIndex = Zh, a.sortedIndexBy = Jh, a.sortedIndexOf = Xh, a.sortedLastIndex = Qh, a.sortedLastIndexBy = Vh, a.sortedLastIndexOf = kh, a.startCase = Hd, a.startsWith = $d, a.subtract = Og, a.sum = Rg, a.sumBy = bg, a.template = Ud, a.times = pg, a.toFinite = Xn, a.toInteger = R, a.toLength = oa, a.toLower = Wd, a.toNumber = xn, a.toSafeInteger = Wp, a.toString = W, a.toUpper = Fd, a.trim = Md, a.trimEnd = qd, a.trimStart = Bd, a.truncate = Gd, a.unescape = zd, a.uniqueId = gg, a.upperCase = Kd, a.upperFirst = Ri, a.each = Ju, a.eachRight = Xu2, a.first = zu, Li2(a, function() {
        var n = {};
        return $n(a, function(t, e) {
          F2.call(a.prototype, e) || (n[e] = t);
        }), n;
      }(), { chain: false }), a.VERSION = p3, mn(["bind", "bindKey", "curry", "curryRight", "partial", "partialRight"], function(n) {
        a[n].placeholder = a;
      }), mn(["drop", "take"], function(n, t) {
        H.prototype[n] = function(e) {
          e = e === i ? 1 : Q2(R(e), 0);
          var r = this.__filtered__ && !t ? new H(this) : this.clone();
          return r.__filtered__ ? r.__takeCount__ = nn(e, r.__takeCount__) : r.__views__.push({ size: nn(e, Hn), type: n + (r.__dir__ < 0 ? "Right" : "") }), r;
        }, H.prototype[n + "Right"] = function(e) {
          return this.reverse()[n](e).reverse();
        };
      }), mn(["filter", "map", "takeWhile"], function(n, t) {
        var e = t + 1, r = e == Gi || e == Fa;
        H.prototype[n] = function(s) {
          var o2 = this.clone();
          return o2.__iteratees__.push({ iteratee: x2(s, 3), type: e }), o2.__filtered__ = o2.__filtered__ || r, o2;
        };
      }), mn(["head", "last"], function(n, t) {
        var e = "take" + (t ? "Right" : "");
        H.prototype[n] = function() {
          return this[e](1).value()[0];
        };
      }), mn(["initial", "tail"], function(n, t) {
        var e = "drop" + (t ? "" : "Right");
        H.prototype[n] = function() {
          return this.__filtered__ ? new H(this) : this[e](1);
        };
      }), H.prototype.compact = function() {
        return this.filter(fn);
      }, H.prototype.find = function(n) {
        return this.filter(n).head();
      }, H.prototype.findLast = function(n) {
        return this.reverse().find(n);
      }, H.prototype.invokeMap = L4(function(n, t) {
        return typeof n == "function" ? new H(this) : this.map(function(e) {
          return ae(e, n, t);
        });
      }), H.prototype.reject = function(n) {
        return this.filter(ur(x2(n)));
      }, H.prototype.slice = function(n, t) {
        n = R(n);
        var e = this;
        return e.__filtered__ && (n > 0 || t < 0) ? new H(e) : (n < 0 ? e = e.takeRight(-n) : n && (e = e.drop(n)), t !== i && (t = R(t), e = t < 0 ? e.dropRight(-t) : e.take(t - n)), e);
      }, H.prototype.takeRightWhile = function(n) {
        return this.reverse().takeWhile(n).reverse();
      }, H.prototype.toArray = function() {
        return this.take(Hn);
      }, $n(H.prototype, function(n, t) {
        var e = /^(?:filter|find|map|reject)|While$/.test(t), r = /^(?:head|last)$/.test(t), s = a[r ? "take" + (t == "last" ? "Right" : "") : t], o2 = r || /^find/.test(t);
        s && (a.prototype[t] = function() {
          var f2 = this.__wrapped__, c2 = r ? [1] : arguments, l2 = f2 instanceof H, v4 = c2[0], _2 = l2 || O3(f2), m4 = function(N2) {
            var $2 = s.apply(a, nt([N2], c2));
            return r && P2 ? $2[0] : $2;
          };
          _2 && e && typeof v4 == "function" && v4.length != 1 && (l2 = _2 = false);
          var P2 = this.__chain__, I = !!this.__actions__.length, E4 = o2 && !P2, T3 = l2 && !I;
          if (!o2 && _2) {
            f2 = T3 ? f2 : new H(this);
            var y2 = n.apply(f2, c2);
            return y2.__actions__.push({ func: er, args: [m4], thisArg: i }), new Pn(y2, P2);
          }
          return E4 && T3 ? n.apply(this, c2) : (y2 = this.thru(m4), E4 ? r ? y2.value()[0] : y2.value() : y2);
        });
      }), mn(["pop", "push", "shift", "sort", "splice", "unshift"], function(n) {
        var t = Oe[n], e = /^(?:push|sort|unshift)$/.test(n) ? "tap" : "thru", r = /^(?:pop|shift)$/.test(n);
        a.prototype[n] = function() {
          var s = arguments;
          if (r && !this.__chain__) {
            var o2 = this.value();
            return t.apply(O3(o2) ? o2 : [], s);
          }
          return this[e](function(f2) {
            return t.apply(O3(f2) ? f2 : [], s);
          });
        };
      }), $n(H.prototype, function(n, t) {
        var e = a[t];
        if (e) {
          var r = e.name + "";
          F2.call(Ut, r) || (Ut[r] = []), Ut[r].push({ name: t, func: e });
        }
      }), Ut[Xe2(i, ct).name] = [{ name: "wrapper", func: i }], H.prototype.clone = zf2, H.prototype.reverse = Kf, H.prototype.value = Yf, a.prototype.at = Al, a.prototype.chain = Cl, a.prototype.commit = Il, a.prototype.next = xl, a.prototype.plant = yl, a.prototype.reverse = Sl, a.prototype.toJSON = a.prototype.valueOf = a.prototype.value = Ol, a.prototype.first = a.prototype.head, ne2 && (a.prototype[ne2] = El), a;
    }, Nt = If();
    lt2 ? ((lt2.exports = Nt)._ = Nt, Tr._ = Nt) : k3._ = Nt;
  }).call(ge2);
})(Ui, Ui.exports);
var zg = Object.defineProperty;
var Kg = Object.defineProperties;
var Yg = Object.getOwnPropertyDescriptors;
var ya = Object.getOwnPropertySymbols;
var Zg = Object.prototype.hasOwnProperty;
var Jg = Object.prototype.propertyIsEnumerable;
var Sa = (A3, u2, i) => u2 in A3 ? zg(A3, u2, { enumerable: true, configurable: true, writable: true, value: i }) : A3[u2] = i;
var cr = (A3, u2) => {
  for (var i in u2 || (u2 = {})) Zg.call(u2, i) && Sa(A3, i, u2[i]);
  if (ya) for (var i of ya(u2)) Jg.call(u2, i) && Sa(A3, i, u2[i]);
  return A3;
};
var Xg = (A3, u2) => Kg(A3, Yg(u2));
function ft(A3, u2, i) {
  var p3;
  const w3 = dn(A3);
  return ((p3 = u2.rpcMap) == null ? void 0 : p3[w3.reference]) || `${Gg}?chainId=${w3.namespace}:${w3.reference}&projectId=${i}`;
}
function Ct2(A3) {
  return A3.includes(":") ? A3.split(":")[1] : A3;
}
function Oa(A3) {
  return A3.map((u2) => `${u2.split(":")[0]}:${u2.split(":")[1]}`);
}
function Qg(A3, u2) {
  const i = Object.keys(u2.namespaces).filter((w3) => w3.includes(A3));
  if (!i.length) return [];
  const p3 = [];
  return i.forEach((w3) => {
    const b3 = u2.namespaces[w3].accounts;
    p3.push(...b3);
  }), p3;
}
function Wi(A3 = {}, u2 = {}) {
  const i = Ra(A3), p3 = Ra(u2);
  return Ui.exports.merge(i, p3);
}
function Ra(A3) {
  var u2, i, p3, w3;
  const b3 = {};
  if (!Yr(A3)) return b3;
  for (const [D2, En] of Object.entries(A3)) {
    const zt = Zi(D2) ? [D2] : En.chains, pr2 = En.methods || [], It = En.events || [], Ln = En.rpcMap || {}, Fn = vo(D2);
    b3[Fn] = Xg(cr(cr({}, b3[Fn]), En), { chains: ge(zt, (u2 = b3[Fn]) == null ? void 0 : u2.chains), methods: ge(pr2, (i = b3[Fn]) == null ? void 0 : i.methods), events: ge(It, (p3 = b3[Fn]) == null ? void 0 : p3.events), rpcMap: cr(cr({}, Ln), (w3 = b3[Fn]) == null ? void 0 : w3.rpcMap) });
  }
  return b3;
}
function Vg(A3) {
  return A3.includes(":") ? A3.split(":")[2] : A3;
}
function ba(A3) {
  const u2 = {};
  for (const [i, p3] of Object.entries(A3)) {
    const w3 = p3.methods || [], b3 = p3.events || [], D2 = p3.accounts || [], En = Zi(i) ? [i] : p3.chains ? p3.chains : Oa(p3.accounts);
    u2[i] = { chains: En, methods: w3, events: b3, accounts: D2 };
  }
  return u2;
}
function Fi(A3) {
  return typeof A3 == "number" ? A3 : A3.includes("0x") ? parseInt(A3, 16) : (A3 = A3.includes(":") ? A3.split(":")[1] : A3, isNaN(Number(A3)) ? A3 : Number(A3));
}
var Ta = {};
var z = (A3) => Ta[A3];
var Mi = (A3, u2) => {
  Ta[A3] = u2;
};
var kg = class {
  constructor(u2) {
    this.name = "polkadot", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${u2}`);
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]) || [] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var jg = class {
  constructor(u2) {
    this.name = "eip155", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.httpProviders = this.createHttpProviders(), this.chainId = parseInt(this.getDefaultChain());
  }
  async request(u2) {
    switch (u2.request.method) {
      case "eth_requestAccounts":
        return this.getAccounts();
      case "eth_accounts":
        return this.getAccounts();
      case "wallet_switchEthereumChain":
        return await this.handleSwitchChain(u2);
      case "eth_chainId":
        return parseInt(this.getDefaultChain());
    }
    return this.namespace.methods.includes(u2.request.method) ? await this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(parseInt(u2), i), this.chainId = parseInt(u2), this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${u2}`);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId.toString();
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(`${this.name}:${u2}`, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = parseInt(Ct2(i));
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  getHttpProvider() {
    const u2 = this.chainId, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  async handleSwitchChain(u2) {
    var i, p3;
    let w3 = u2.request.params ? (i = u2.request.params[0]) == null ? void 0 : i.chainId : "0x0";
    w3 = w3.startsWith("0x") ? w3 : `0x${w3}`;
    const b3 = parseInt(w3, 16);
    if (this.isChainApproved(b3)) this.setDefaultChain(`${b3}`);
    else if (this.namespace.methods.includes("wallet_switchEthereumChain")) await this.client.request({ topic: u2.topic, request: { method: u2.request.method, params: [{ chainId: w3 }] }, chainId: (p3 = this.namespace.chains) == null ? void 0 : p3[0] }), this.setDefaultChain(`${b3}`);
    else throw new Error(`Failed to switch to chain 'eip155:${b3}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);
    return null;
  }
  isChainApproved(u2) {
    return this.namespace.chains.includes(`${this.name}:${u2}`);
  }
};
var nv = class {
  constructor(u2) {
    this.name = "solana", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${u2}`);
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var tv = class {
  constructor(u2) {
    this.name = "cosmos", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${this.chainId}`);
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var ev = class {
  constructor(u2) {
    this.name = "cip34", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${this.chainId}`);
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      const p3 = this.getCardanoRPCUrl(i), w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, p3);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  getCardanoRPCUrl(u2) {
    const i = this.namespace.rpcMap;
    if (i) return i[u2];
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || this.getCardanoRPCUrl(u2);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var rv = class {
  constructor(u2) {
    this.name = "elrond", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${u2}`);
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var iv = class {
  constructor(u2) {
    this.name = "multiversx", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    this.httpProviders[u2] || this.setHttpProvider(u2, i), this.chainId = u2, this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${u2}`);
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? [...new Set(u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]))] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      const w3 = Ct2(i);
      u2[w3] = this.createHttpProvider(w3, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace, this.client.core.projectId);
    if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
    return new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var sv = class {
  constructor(u2) {
    this.name = "near", this.namespace = u2.namespace, this.events = z("events"), this.client = z("client"), this.chainId = this.getDefaultChain(), this.httpProviders = this.createHttpProviders();
  }
  updateNamespace(u2) {
    this.namespace = Object.assign(this.namespace, u2);
  }
  requestAccounts() {
    return this.getAccounts();
  }
  getDefaultChain() {
    if (this.chainId) return this.chainId;
    if (this.namespace.defaultChain) return this.namespace.defaultChain;
    const u2 = this.namespace.chains[0];
    if (!u2) throw new Error("ChainId not found");
    return u2.split(":")[1];
  }
  request(u2) {
    return this.namespace.methods.includes(u2.request.method) ? this.client.request(u2) : this.getHttpProvider().request(u2.request);
  }
  setDefaultChain(u2, i) {
    if (this.chainId = u2, !this.httpProviders[u2]) {
      const p3 = i || ft(`${this.name}:${u2}`, this.namespace);
      if (!p3) throw new Error(`No RPC url provided for chainId: ${u2}`);
      this.setHttpProvider(u2, p3);
    }
    this.events.emit(Vn.DEFAULT_CHAIN_CHANGED, `${this.name}:${this.chainId}`);
  }
  getAccounts() {
    const u2 = this.namespace.accounts;
    return u2 ? u2.filter((i) => i.split(":")[1] === this.chainId.toString()).map((i) => i.split(":")[2]) || [] : [];
  }
  createHttpProviders() {
    const u2 = {};
    return this.namespace.chains.forEach((i) => {
      var p3;
      u2[i] = this.createHttpProvider(i, (p3 = this.namespace.rpcMap) == null ? void 0 : p3[i]);
    }), u2;
  }
  getHttpProvider() {
    const u2 = `${this.name}:${this.chainId}`, i = this.httpProviders[u2];
    if (typeof i > "u") throw new Error(`JSON-RPC provider for ${u2} not found`);
    return i;
  }
  setHttpProvider(u2, i) {
    const p3 = this.createHttpProvider(u2, i);
    p3 && (this.httpProviders[u2] = p3);
  }
  createHttpProvider(u2, i) {
    const p3 = i || ft(u2, this.namespace);
    return typeof p3 > "u" ? void 0 : new JsonRpcProvider(new f(p3, z("disableProviderPing")));
  }
};
var uv = Object.defineProperty;
var av = Object.defineProperties;
var ov = Object.getOwnPropertyDescriptors;
var La = Object.getOwnPropertySymbols;
var fv = Object.prototype.hasOwnProperty;
var cv = Object.prototype.propertyIsEnumerable;
var Da = (A3, u2, i) => u2 in A3 ? uv(A3, u2, { enumerable: true, configurable: true, writable: true, value: i }) : A3[u2] = i;
var hr = (A3, u2) => {
  for (var i in u2 || (u2 = {})) fv.call(u2, i) && Da(A3, i, u2[i]);
  if (La) for (var i of La(u2)) cv.call(u2, i) && Da(A3, i, u2[i]);
  return A3;
};
var qi = (A3, u2) => av(A3, ov(u2));
var lr2 = class _lr {
  constructor(u2) {
    this.events = new import_events3.default(), this.rpcProviders = {}, this.shouldAbortPairingAttempt = false, this.maxPairingAttempts = 10, this.disableProviderPing = false, this.providerOpts = u2, this.logger = typeof (u2 == null ? void 0 : u2.logger) < "u" && typeof (u2 == null ? void 0 : u2.logger) != "string" ? u2.logger : (0, import_pino.default)(k({ level: (u2 == null ? void 0 : u2.logger) || xa })), this.disableProviderPing = (u2 == null ? void 0 : u2.disableProviderPing) || false;
  }
  static async init(u2) {
    const i = new _lr(u2);
    return await i.initialize(), i;
  }
  async request(u2, i, p3) {
    const [w3, b3] = this.validateChain(i);
    if (!this.session) throw new Error("Please call connect() before request()");
    return await this.getProvider(w3).request({ request: hr({}, u2), chainId: `${w3}:${b3}`, topic: this.session.topic, expiry: p3 });
  }
  sendAsync(u2, i, p3, w3) {
    const b3 = (/* @__PURE__ */ new Date()).getTime();
    this.request(u2, p3, w3).then((D2) => i(null, formatJsonRpcResult(b3, D2))).catch((D2) => i(D2, void 0));
  }
  async enable() {
    if (!this.client) throw new Error("Sign Client not initialized");
    return this.session || await this.connect({ namespaces: this.namespaces, optionalNamespaces: this.optionalNamespaces, sessionProperties: this.sessionProperties }), await this.requestAccounts();
  }
  async disconnect() {
    var u2;
    if (!this.session) throw new Error("Please call connect() before enable()");
    await this.client.disconnect({ topic: (u2 = this.session) == null ? void 0 : u2.topic, reason: tr("USER_DISCONNECTED") }), await this.cleanup();
  }
  async connect(u2) {
    if (!this.client) throw new Error("Sign Client not initialized");
    if (this.setNamespaces(u2), await this.cleanupPendingPairings(), !u2.skipPairing) return await this.pair(u2.pairingTopic);
  }
  async authenticate(u2) {
    if (!this.client) throw new Error("Sign Client not initialized");
    this.setNamespaces(u2), await this.cleanupPendingPairings();
    const { uri: i, response: p3 } = await this.client.authenticate(u2);
    i && (this.uri = i, this.events.emit("display_uri", i));
    const w3 = await p3();
    if (this.session = w3.session, this.session) {
      const b3 = ba(this.session.namespaces);
      this.namespaces = Wi(this.namespaces, b3), this.persist("namespaces", this.namespaces), this.onConnect();
    }
    return w3;
  }
  on(u2, i) {
    this.events.on(u2, i);
  }
  once(u2, i) {
    this.events.once(u2, i);
  }
  removeListener(u2, i) {
    this.events.removeListener(u2, i);
  }
  off(u2, i) {
    this.events.off(u2, i);
  }
  get isWalletConnect() {
    return true;
  }
  async pair(u2) {
    this.shouldAbortPairingAttempt = false;
    let i = 0;
    do {
      if (this.shouldAbortPairingAttempt) throw new Error("Pairing aborted");
      if (i >= this.maxPairingAttempts) throw new Error("Max auto pairing attempts reached");
      const { uri: p3, approval: w3 } = await this.client.connect({ pairingTopic: u2, requiredNamespaces: this.namespaces, optionalNamespaces: this.optionalNamespaces, sessionProperties: this.sessionProperties });
      p3 && (this.uri = p3, this.events.emit("display_uri", p3)), await w3().then((b3) => {
        this.session = b3;
        const D2 = ba(b3.namespaces);
        this.namespaces = Wi(this.namespaces, D2), this.persist("namespaces", this.namespaces);
      }).catch((b3) => {
        if (b3.message !== Ue) throw b3;
        i++;
      });
    } while (!this.session);
    return this.onConnect(), this.session;
  }
  setDefaultChain(u2, i) {
    try {
      if (!this.session) return;
      const [p3, w3] = this.validateChain(u2);
      this.getProvider(p3).setDefaultChain(w3, i);
    } catch (p3) {
      if (!/Please call connect/.test(p3.message)) throw p3;
    }
  }
  async cleanupPendingPairings(u2 = {}) {
    this.logger.info("Cleaning up inactive pairings...");
    const i = this.client.pairing.getAll();
    if (Er(i)) {
      for (const p3 of i) u2.deletePairings ? this.client.core.expirer.set(p3.topic, 0) : await this.client.core.relayer.subscriber.unsubscribe(p3.topic);
      this.logger.info(`Inactive pairings cleared: ${i.length}`);
    }
  }
  abortPairingAttempt() {
    this.shouldAbortPairingAttempt = true;
  }
  async checkStorage() {
    if (this.namespaces = await this.getFromStore("namespaces"), this.optionalNamespaces = await this.getFromStore("optionalNamespaces") || {}, this.client.session.length) {
      const u2 = this.client.session.keys.length - 1;
      this.session = this.client.session.get(this.client.session.keys[u2]), this.createProviders();
    }
  }
  async initialize() {
    this.logger.trace("Initialized"), await this.createClient(), await this.checkStorage(), this.registerEventListeners();
  }
  async createClient() {
    this.client = this.providerOpts.client || await ne.init({ logger: this.providerOpts.logger || xa, relayUrl: this.providerOpts.relayUrl || Mg, projectId: this.providerOpts.projectId, metadata: this.providerOpts.metadata, storageOptions: this.providerOpts.storageOptions, storage: this.providerOpts.storage, name: this.providerOpts.name }), this.logger.trace("SignClient Initialized");
  }
  createProviders() {
    if (!this.client) throw new Error("Sign Client not initialized");
    if (!this.session) throw new Error("Session not initialized. Please call connect() before enable()");
    const u2 = [...new Set(Object.keys(this.session.namespaces).map((i) => vo(i)))];
    Mi("client", this.client), Mi("events", this.events), Mi("disableProviderPing", this.disableProviderPing), u2.forEach((i) => {
      if (!this.session) return;
      const p3 = Qg(i, this.session), w3 = Oa(p3), b3 = Wi(this.namespaces, this.optionalNamespaces), D2 = qi(hr({}, b3[i]), { accounts: p3, chains: w3 });
      switch (i) {
        case "eip155":
          this.rpcProviders[i] = new jg({ namespace: D2 });
          break;
        case "solana":
          this.rpcProviders[i] = new nv({ namespace: D2 });
          break;
        case "cosmos":
          this.rpcProviders[i] = new tv({ namespace: D2 });
          break;
        case "polkadot":
          this.rpcProviders[i] = new kg({ namespace: D2 });
          break;
        case "cip34":
          this.rpcProviders[i] = new ev({ namespace: D2 });
          break;
        case "elrond":
          this.rpcProviders[i] = new rv({ namespace: D2 });
          break;
        case "multiversx":
          this.rpcProviders[i] = new iv({ namespace: D2 });
          break;
        case "near":
          this.rpcProviders[i] = new sv({ namespace: D2 });
          break;
      }
    });
  }
  registerEventListeners() {
    if (typeof this.client > "u") throw new Error("Sign Client is not initialized");
    this.client.on("session_ping", (u2) => {
      this.events.emit("session_ping", u2);
    }), this.client.on("session_event", (u2) => {
      const { params: i } = u2, { event: p3 } = i;
      if (p3.name === "accountsChanged") {
        const w3 = p3.data;
        w3 && Er(w3) && this.events.emit("accountsChanged", w3.map(Vg));
      } else if (p3.name === "chainChanged") {
        const w3 = i.chainId, b3 = i.event.data, D2 = vo(w3), En = Fi(w3) !== Fi(b3) ? `${D2}:${Fi(b3)}` : w3;
        this.onChainChanged(En);
      } else this.events.emit(p3.name, p3.data);
      this.events.emit("session_event", u2);
    }), this.client.on("session_update", ({ topic: u2, params: i }) => {
      var p3;
      const { namespaces: w3 } = i, b3 = (p3 = this.client) == null ? void 0 : p3.session.get(u2);
      this.session = qi(hr({}, b3), { namespaces: w3 }), this.onSessionUpdate(), this.events.emit("session_update", { topic: u2, params: i });
    }), this.client.on("session_delete", async (u2) => {
      await this.cleanup(), this.events.emit("session_delete", u2), this.events.emit("disconnect", qi(hr({}, tr("USER_DISCONNECTED")), { data: u2.topic }));
    }), this.on(Vn.DEFAULT_CHAIN_CHANGED, (u2) => {
      this.onChainChanged(u2, true);
    });
  }
  getProvider(u2) {
    if (!this.rpcProviders[u2]) throw new Error(`Provider not found: ${u2}`);
    return this.rpcProviders[u2];
  }
  onSessionUpdate() {
    Object.keys(this.rpcProviders).forEach((u2) => {
      var i;
      this.getProvider(u2).updateNamespace((i = this.session) == null ? void 0 : i.namespaces[u2]);
    });
  }
  setNamespaces(u2) {
    const { namespaces: i, optionalNamespaces: p3, sessionProperties: w3 } = u2;
    i && Object.keys(i).length && (this.namespaces = i), p3 && Object.keys(p3).length && (this.optionalNamespaces = p3), this.sessionProperties = w3, this.persist("namespaces", i), this.persist("optionalNamespaces", p3);
  }
  validateChain(u2) {
    const [i, p3] = (u2 == null ? void 0 : u2.split(":")) || ["", ""];
    if (!this.namespaces || !Object.keys(this.namespaces).length) return [i, p3];
    if (i && !Object.keys(this.namespaces || {}).map((D2) => vo(D2)).includes(i)) throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);
    if (i && p3) return [i, p3];
    const w3 = vo(Object.keys(this.namespaces)[0]), b3 = this.rpcProviders[w3].getDefaultChain();
    return [w3, b3];
  }
  async requestAccounts() {
    const [u2] = this.validateChain();
    return await this.getProvider(u2).requestAccounts();
  }
  onChainChanged(u2, i = false) {
    if (!this.namespaces) return;
    const [p3, w3] = this.validateChain(u2);
    w3 && (i || this.getProvider(p3).setDefaultChain(w3), this.namespaces[p3] ? this.namespaces[p3].defaultChain = w3 : this.namespaces[`${p3}:${w3}`] ? this.namespaces[`${p3}:${w3}`].defaultChain = w3 : this.namespaces[`${p3}:${w3}`] = { defaultChain: w3 }, this.persist("namespaces", this.namespaces), this.events.emit("chainChanged", w3));
  }
  onConnect() {
    this.createProviders(), this.events.emit("connect", { session: this.session });
  }
  async cleanup() {
    this.session = void 0, this.namespaces = void 0, this.optionalNamespaces = void 0, this.sessionProperties = void 0, this.persist("namespaces", void 0), this.persist("optionalNamespaces", void 0), this.persist("sessionProperties", void 0), await this.cleanupPendingPairings({ deletePairings: true });
  }
  persist(u2, i) {
    this.client.core.storage.setItem(`${Ea}/${u2}`, i);
  }
  async getFromStore(u2) {
    return await this.client.core.storage.getItem(`${Ea}/${u2}`);
  }
};
var hv = lr2;

// node_modules/@thirdweb-dev/wallets/node_modules/@walletconnect/ethereum-provider/dist/index.es.js
var T2 = "wc";
var S = "ethereum_provider";
var $ = `${T2}@2:${S}:`;
var j2 = "https://rpc.walletconnect.com/v1/";
var u = ["eth_sendTransaction", "personal_sign"];
var _ = ["eth_accounts", "eth_requestAccounts", "eth_sendRawTransaction", "eth_sign", "eth_signTransaction", "eth_signTypedData", "eth_signTypedData_v3", "eth_signTypedData_v4", "eth_sendTransaction", "personal_sign", "wallet_switchEthereumChain", "wallet_addEthereumChain", "wallet_getPermissions", "wallet_requestPermissions", "wallet_registerOnboarding", "wallet_watchAsset", "wallet_scanQRCode"];
var g2 = ["chainChanged", "accountsChanged"];
var M = ["chainChanged", "accountsChanged", "message", "disconnect", "connect"];
var q2 = Object.defineProperty;
var N = Object.defineProperties;
var D = Object.getOwnPropertyDescriptors;
var O2 = Object.getOwnPropertySymbols;
var U2 = Object.prototype.hasOwnProperty;
var Q = Object.prototype.propertyIsEnumerable;
var b2 = (a, t, s) => t in a ? q2(a, t, { enumerable: true, configurable: true, writable: true, value: s }) : a[t] = s;
var p2 = (a, t) => {
  for (var s in t || (t = {})) U2.call(t, s) && b2(a, s, t[s]);
  if (O2) for (var s of O2(t)) Q.call(t, s) && b2(a, s, t[s]);
  return a;
};
var E3 = (a, t) => N(a, D(t));
function m3(a) {
  return Number(a[0].split(":")[1]);
}
function v3(a) {
  return `0x${a.toString(16)}`;
}
function L3(a) {
  const { chains: t, optionalChains: s, methods: i, optionalMethods: n, events: e, optionalEvents: o2, rpcMap: r } = a;
  if (!Er(t)) throw new Error("Invalid chains");
  const c2 = { chains: t, methods: i || u, events: e || g2, rpcMap: p2({}, t.length ? { [m3(t)]: r[m3(t)] } : {}) }, h = e == null ? void 0 : e.filter((l2) => !g2.includes(l2)), d2 = i == null ? void 0 : i.filter((l2) => !u.includes(l2));
  if (!s && !o2 && !n && !(h != null && h.length) && !(d2 != null && d2.length)) return { required: t.length ? c2 : void 0 };
  const I = (h == null ? void 0 : h.length) && (d2 == null ? void 0 : d2.length) || !s, w3 = { chains: [...new Set(I ? c2.chains.concat(s || []) : s)], methods: [...new Set(c2.methods.concat(n != null && n.length ? n : _))], events: [...new Set(c2.events.concat(o2 != null && o2.length ? o2 : M))], rpcMap: r };
  return { required: t.length ? c2 : void 0, optional: s.length ? w3 : void 0 };
}
var C3 = class _C {
  constructor() {
    this.events = new import_events4.EventEmitter(), this.namespace = "eip155", this.accounts = [], this.chainId = 1, this.STORAGE_KEY = $, this.on = (t, s) => (this.events.on(t, s), this), this.once = (t, s) => (this.events.once(t, s), this), this.removeListener = (t, s) => (this.events.removeListener(t, s), this), this.off = (t, s) => (this.events.off(t, s), this), this.parseAccount = (t) => this.isCompatibleChainId(t) ? this.parseAccountId(t).address : t, this.signer = {}, this.rpc = {};
  }
  static async init(t) {
    const s = new _C();
    return await s.initialize(t), s;
  }
  async request(t, s) {
    return await this.signer.request(t, this.formatChainId(this.chainId), s);
  }
  sendAsync(t, s, i) {
    this.signer.sendAsync(t, s, this.formatChainId(this.chainId), i);
  }
  get connected() {
    return this.signer.client ? this.signer.client.core.relayer.connected : false;
  }
  get connecting() {
    return this.signer.client ? this.signer.client.core.relayer.connecting : false;
  }
  async enable() {
    return this.session || await this.connect(), await this.request({ method: "eth_requestAccounts" });
  }
  async connect(t) {
    if (!this.signer.client) throw new Error("Provider not initialized. Call init() first");
    this.loadConnectOpts(t);
    const { required: s, optional: i } = L3(this.rpc);
    try {
      const n = await new Promise(async (o2, r) => {
        var c2;
        this.rpc.showQrModal && ((c2 = this.modal) == null || c2.subscribeModal((h) => {
          !h.open && !this.signer.session && (this.signer.abortPairingAttempt(), r(new Error("Connection request reset. Please try again.")));
        })), await this.signer.connect(E3(p2({ namespaces: p2({}, s && { [this.namespace]: s }) }, i && { optionalNamespaces: { [this.namespace]: i } }), { pairingTopic: t == null ? void 0 : t.pairingTopic })).then((h) => {
          o2(h);
        }).catch((h) => {
          r(new Error(h.message));
        });
      });
      if (!n) return;
      const e = zo(n.namespaces, [this.namespace]);
      this.setChainIds(this.rpc.chains.length ? this.rpc.chains : e), this.setAccounts(e), this.events.emit("connect", { chainId: v3(this.chainId) });
    } catch (n) {
      throw this.signer.logger.error(n), n;
    } finally {
      this.modal && this.modal.closeModal();
    }
  }
  async authenticate(t) {
    if (!this.signer.client) throw new Error("Provider not initialized. Call init() first");
    this.loadConnectOpts({ chains: t == null ? void 0 : t.chains });
    try {
      const s = await new Promise(async (n, e) => {
        var o2;
        this.rpc.showQrModal && ((o2 = this.modal) == null || o2.subscribeModal((r) => {
          !r.open && !this.signer.session && (this.signer.abortPairingAttempt(), e(new Error("Connection request reset. Please try again.")));
        })), await this.signer.authenticate(E3(p2({}, t), { chains: this.rpc.chains })).then((r) => {
          n(r);
        }).catch((r) => {
          e(new Error(r.message));
        });
      }), i = s.session;
      if (i) {
        const n = zo(i.namespaces, [this.namespace]);
        this.setChainIds(this.rpc.chains.length ? this.rpc.chains : n), this.setAccounts(n), this.events.emit("connect", { chainId: v3(this.chainId) });
      }
      return s;
    } catch (s) {
      throw this.signer.logger.error(s), s;
    } finally {
      this.modal && this.modal.closeModal();
    }
  }
  async disconnect() {
    this.session && await this.signer.disconnect(), this.reset();
  }
  get isWalletConnect() {
    return true;
  }
  get session() {
    return this.signer.session;
  }
  registerEventListeners() {
    this.signer.on("session_event", (t) => {
      const { params: s } = t, { event: i } = s;
      i.name === "accountsChanged" ? (this.accounts = this.parseAccounts(i.data), this.events.emit("accountsChanged", this.accounts)) : i.name === "chainChanged" ? this.setChainId(this.formatChainId(i.data)) : this.events.emit(i.name, i.data), this.events.emit("session_event", t);
    }), this.signer.on("chainChanged", (t) => {
      const s = parseInt(t);
      this.chainId = s, this.events.emit("chainChanged", v3(this.chainId)), this.persist();
    }), this.signer.on("session_update", (t) => {
      this.events.emit("session_update", t);
    }), this.signer.on("session_delete", (t) => {
      this.reset(), this.events.emit("session_delete", t), this.events.emit("disconnect", E3(p2({}, tr("USER_DISCONNECTED")), { data: t.topic, name: "USER_DISCONNECTED" }));
    }), this.signer.on("display_uri", (t) => {
      var s, i;
      this.rpc.showQrModal && ((s = this.modal) == null || s.closeModal(), (i = this.modal) == null || i.openModal({ uri: t })), this.events.emit("display_uri", t);
    });
  }
  switchEthereumChain(t) {
    this.request({ method: "wallet_switchEthereumChain", params: [{ chainId: t.toString(16) }] });
  }
  isCompatibleChainId(t) {
    return typeof t == "string" ? t.startsWith(`${this.namespace}:`) : false;
  }
  formatChainId(t) {
    return `${this.namespace}:${t}`;
  }
  parseChainId(t) {
    return Number(t.split(":")[1]);
  }
  setChainIds(t) {
    const s = t.filter((i) => this.isCompatibleChainId(i)).map((i) => this.parseChainId(i));
    s.length && (this.chainId = s[0], this.events.emit("chainChanged", v3(this.chainId)), this.persist());
  }
  setChainId(t) {
    if (this.isCompatibleChainId(t)) {
      const s = this.parseChainId(t);
      this.chainId = s, this.switchEthereumChain(s);
    }
  }
  parseAccountId(t) {
    const [s, i, n] = t.split(":");
    return { chainId: `${s}:${i}`, address: n };
  }
  setAccounts(t) {
    this.accounts = t.filter((s) => this.parseChainId(this.parseAccountId(s).chainId) === this.chainId).map((s) => this.parseAccountId(s).address), this.events.emit("accountsChanged", this.accounts);
  }
  getRpcConfig(t) {
    var s, i;
    const n = (s = t == null ? void 0 : t.chains) != null ? s : [], e = (i = t == null ? void 0 : t.optionalChains) != null ? i : [], o2 = n.concat(e);
    if (!o2.length) throw new Error("No chains specified in either `chains` or `optionalChains`");
    const r = n.length ? (t == null ? void 0 : t.methods) || u : [], c2 = n.length ? (t == null ? void 0 : t.events) || g2 : [], h = (t == null ? void 0 : t.optionalMethods) || [], d2 = (t == null ? void 0 : t.optionalEvents) || [], I = (t == null ? void 0 : t.rpcMap) || this.buildRpcMap(o2, t.projectId), w3 = (t == null ? void 0 : t.qrModalOptions) || void 0;
    return { chains: n == null ? void 0 : n.map((l2) => this.formatChainId(l2)), optionalChains: e.map((l2) => this.formatChainId(l2)), methods: r, events: c2, optionalMethods: h, optionalEvents: d2, rpcMap: I, showQrModal: !!(t != null && t.showQrModal), qrModalOptions: w3, projectId: t.projectId, metadata: t.metadata };
  }
  buildRpcMap(t, s) {
    const i = {};
    return t.forEach((n) => {
      i[n] = this.getRpcUrl(n, s);
    }), i;
  }
  async initialize(t) {
    if (this.rpc = this.getRpcConfig(t), this.chainId = this.rpc.chains.length ? m3(this.rpc.chains) : m3(this.rpc.optionalChains), this.signer = await hv.init({ projectId: this.rpc.projectId, metadata: this.rpc.metadata, disableProviderPing: t.disableProviderPing, relayUrl: t.relayUrl, storageOptions: t.storageOptions }), this.registerEventListeners(), await this.loadPersistedSession(), this.rpc.showQrModal) {
      let s;
      try {
        const { WalletConnectModal: i } = await import("./dist-UE7HFOLX.js");
        s = i;
      } catch {
        throw new Error("To use QR modal, please install @walletconnect/modal package");
      }
      if (s) try {
        this.modal = new s(p2({ projectId: this.rpc.projectId }, this.rpc.qrModalOptions));
      } catch (i) {
        throw this.signer.logger.error(i), new Error("Could not generate WalletConnectModal Instance");
      }
    }
  }
  loadConnectOpts(t) {
    if (!t) return;
    const { chains: s, optionalChains: i, rpcMap: n } = t;
    s && Er(s) && (this.rpc.chains = s.map((e) => this.formatChainId(e)), s.forEach((e) => {
      this.rpc.rpcMap[e] = (n == null ? void 0 : n[e]) || this.getRpcUrl(e);
    })), i && Er(i) && (this.rpc.optionalChains = [], this.rpc.optionalChains = i == null ? void 0 : i.map((e) => this.formatChainId(e)), i.forEach((e) => {
      this.rpc.rpcMap[e] = (n == null ? void 0 : n[e]) || this.getRpcUrl(e);
    }));
  }
  getRpcUrl(t, s) {
    var i;
    return ((i = this.rpc.rpcMap) == null ? void 0 : i[t]) || `${j2}?chainId=eip155:${t}&projectId=${s || this.rpc.projectId}`;
  }
  async loadPersistedSession() {
    if (this.session) try {
      const t = await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`), s = this.session.namespaces[`${this.namespace}:${t}`] ? this.session.namespaces[`${this.namespace}:${t}`] : this.session.namespaces[this.namespace];
      this.setChainIds(t ? [this.formatChainId(t)] : s == null ? void 0 : s.accounts), this.setAccounts(s == null ? void 0 : s.accounts);
    } catch (t) {
      this.signer.logger.error("Failed to load persisted session, clearing state..."), this.signer.logger.error(t), await this.disconnect().catch((s) => this.signer.logger.warn(s));
    }
  }
  reset() {
    this.chainId = 1, this.accounts = [];
  }
  persist() {
    this.session && this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`, this.chainId);
  }
  parseAccounts(t) {
    return typeof t == "string" || t instanceof String ? [this.parseAccount(t)] : t.map((s) => this.parseAccount(s));
  }
};
var z2 = C3;
export {
  z2 as EthereumProvider,
  M as OPTIONAL_EVENTS,
  _ as OPTIONAL_METHODS,
  g2 as REQUIRED_EVENTS,
  u as REQUIRED_METHODS,
  C3 as default
};
/*! Bundled license information:

@walletconnect/universal-provider/dist/index.es.js:
  (**
  * @license
  * Lodash <https://lodash.com/>
  * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
  * Released under MIT license <https://lodash.com/license>
  * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
  * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
  *)
*/
//# sourceMappingURL=index.es-Z2UKKGGT.js.map
